<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Poisson model for count data â€¢ silverblaze</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A Poisson model for count data">
<meta property="og:description" content="silverblaze">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">silverblaze</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basic tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Poisson-basic-implementation.html">Poisson model and count data</a>
    </li>
    <li>
      <a href="../articles/Binomial-basic-implementation.html">Binomial model and prevalence data</a>
    </li>
    <li>
      <a href="../articles/PointPattern-basic-implementation.html">Point pattern data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/model-validation.html">Model Validation</a>
    </li>
    <li>
      <a href="../articles/MHCoupling.html">Metropolis-Hastings Coupling</a>
    </li>
    <li>
      <a href="../articles/complex-spatial-priors.html">Complex Spatial Priors</a>
    </li>
    <li>
      <a href="../articles/Variable-sigma.html">Variable Sigma</a>
    </li>
    <li>
      <a href="../articles/Variable-population.html">Variable Expected Population</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Michael-Stevens-27/silverblaze">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="Poisson-basic-implementation_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="Poisson-basic-implementation_files/anchor-sections-1.0/anchor-sections.js"></script><script src="Poisson-basic-implementation_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="Poisson-basic-implementation_files/jquery-1.12.4/jquery.min.js"></script><link href="Poisson-basic-implementation_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="Poisson-basic-implementation_files/leaflet-1.3.1/leaflet.js"></script><link href="Poisson-basic-implementation_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="Poisson-basic-implementation_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="Poisson-basic-implementation_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="Poisson-basic-implementation_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="Poisson-basic-implementation_files/leaflet-binding-2.0.3/leaflet.js"></script><script src="Poisson-basic-implementation_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="Poisson-basic-implementation_files/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script><link href="Poisson-basic-implementation_files/minichart-0.2.2/minicharts.css" rel="stylesheet">
<script src="Poisson-basic-implementation_files/minichart-0.2.2/leaflet.minicharts.min.js"></script><link href="Poisson-basic-implementation_files/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A Poisson model for count data</h1>
                        <h4 class="author">Michael Stevens</h4>
            
            <h4 class="date">2021-02-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Michael-Stevens-27/silverblaze/blob/master/vignettes/Poisson-basic-implementation.Rmd"><code>vignettes/Poisson-basic-implementation.Rmd</code></a></small>
      <div class="hidden name"><code>Poisson-basic-implementation.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The following tutorial will introduce the user to the general structure required to run silverblaze when analysing count data. The protocol of silverblaze is to create one fundamental object, referred to in these tutorials as <code>p</code>, that describes the entire project. The structure of <code>p</code> consists of:</p>
<ol style="list-style-type: decimal">
<li>The data used to run the model</li>
<li>The parameter settings for the model</li>
<li>The output of running the model</li>
</ol>
<p>Following this, the user will learn how to plot and diagnose the output of the model.</p>
</div>
<div id="simulating-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-data" class="anchor"></a>Simulating data</h2>
<p>Before any data simulation happens, we must first define the sentinel site locations for the data.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sentinal_lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.0</span>, l <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">sentinal_lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">51.45</span>, <span class="fl">51.55</span>, l <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">sentinal_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">sentinal_lon</span>, <span class="va">sentinal_lat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sentinal_grid</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span></code></pre></div>
<p>Here we've chosen a lattice configuration but the user may define any list of longitude/latitude locations they would like. With these sentinel sites we can generate our data from a given model using <code><a href="../reference/sim_data.html">sim_data()</a></code>.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mysim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rgeoprofile_file.html">rgeoprofile_file</a></span><span class="op">(</span><span class="st">"tutorial1_mysim.rds"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mysim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_data.html">sim_data</a></span><span class="op">(</span><span class="va">sentinal_grid</span><span class="op">$</span><span class="va">longitude</span>,
                  <span class="va">sentinal_grid</span><span class="op">$</span><span class="va">latitude</span>,
                  sentinel_radius <span class="op">=</span> <span class="fl">0.25</span>,
                  K <span class="op">=</span> <span class="fl">2</span>,
                  sigma_model <span class="op">=</span> <span class="st">"single"</span>,
                  sigma_mean <span class="op">=</span> <span class="fl">2</span>,
                  sigma_var <span class="op">=</span> <span class="fl">0.5</span>,
                  expected_popsize <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></code></pre></div>
<p>These parameters describe the underlying behaviour of the data in question:</p>
<ul>
<li>
<code>sentinal_radius</code> describes the overall reach of our sentinel sites, in Km.</li>
<li>
<code>K</code> is the number of sources with which individuals are spatially distributed.</li>
<li>
<code>sigma_model</code> defines homogeneity or independence of dispersal across sources.</li>
<li>
<code>sigma_mean</code> and <code>sigma_var</code> govern the dispersal associated with each source. Set <code>sigma_var = 0</code> to set an explicit dispersal via <code>sigma_mean</code> (in Km).</li>
<li>
<code>expected_popsize</code> tells us how many individuals we expect to see over our search area. The true value is drawn from a Poisson distribution with this expectation.</li>
</ul>
<p>From the simulation we can extract two key objects: the true sources and a record of which individuals were captured and where.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">true_source</span> <span class="op">&lt;-</span> <span class="va">mysim</span><span class="op">$</span><span class="va">record</span><span class="op">$</span><span class="va">true_source</span>
<span class="va">data_all</span> <span class="op">&lt;-</span> <span class="va">mysim</span><span class="op">$</span><span class="va">record</span><span class="op">$</span><span class="va">data_all</span></code></pre></div>
<p>We will require these objects for plotting later on.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mysim</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<pre><code>##     longitude latitude counts
## 1 -0.20000000    51.45      0
## 2 -0.17777778    51.45      0
## 3 -0.15555556    51.45      0
## 4 -0.13333333    51.45      0
## 5 -0.11111111    51.45      0
## 6 -0.08888889    51.45      0</code></pre>
<p>Here we see the general structure of the data required to run this model. That is, a collection of sentinel sites and their respective number of counts. This <code>mysim$data</code> object is the only piece of information required for the user to run the model. All other outputs from <code>mysim$data</code> are merely a consequence of simulating the data in the first place.</p>
</div>
<div id="creating-a-project" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-project" class="anchor"></a>Creating a project</h2>
<p>We initialise a blank project <code>p</code> using the <code><a href="../reference/rgeoprofile_project.html">rgeoprofile_project()</a></code> function.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rgeoprofile_project.html">rgeoprofile_project</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>We then add in our simulated data using <code><a href="../reference/bind_data.html">bind_data()</a></code>.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind_data.html">bind_data</a></span><span class="op">(</span><span class="va">p</span>,
               df <span class="op">=</span> <span class="va">mysim</span><span class="op">$</span><span class="va">data</span>,
               data_type <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></code></pre></div>
</div>
<div id="simple-spatial-prior" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-spatial-prior" class="anchor"></a>Simple spatial prior</h2>
<p>There are a few priors we wish to impose on our model. Let's start with the prior on source locations. Here we implement a very simple one by instructing the model to restrict the area of interest to to that which contains our sentinel sites plus some <code>guardRail</code>. We can produce a uniform spatial prior with the <code><a href="../reference/raster_grid.html">raster_grid()</a></code> function.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uniform_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/raster_grid.html">raster_grid</a></span><span class="op">(</span>range_lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0</span><span class="op">)</span>, 
                             range_lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">51.45</span>, <span class="fl">51.55</span><span class="op">)</span>,
                             cells_lon <span class="op">=</span> <span class="fl">100</span>, 
                             cells_lat <span class="op">=</span> <span class="fl">100</span>, 
                             guard_rail <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-7a51b252973c848d36db" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-7a51b252973c848d36db">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAABAElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZOjNnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIzAXsTALGT7m3PwAAAABJRU5ErkJggg==",[[51.555,-0.210000000000012],[51.445,0.00999999999999939]],0.2,null,null,null]}],"limits":{"lat":[51.445,51.555],"lng":[-0.210000000000012,0.00999999999999939]}},"evals":[],"jsHooks":[]}</script><p>Here we can see our spatial prior mapped out.</p>
</div>
<div id="parameter-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#parameter-sets" class="anchor"></a>Parameter sets</h2>
<p>Next we explicitly tell the model which priors we will be using for source locations and the remaining variables we wish to estimate. We define these parameters via <code><a href="../reference/new_set.html">new_set()</a></code>. Notice the project <code>p</code> is one of the function's arguments. This is such that the parameter set we define is added into our project.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_set.html">new_set</a></span><span class="op">(</span>project <span class="op">=</span> <span class="va">p</span>,
             spatial_prior <span class="op">=</span> <span class="va">uniform_prior</span>,
             sentinel_radius <span class="op">=</span> <span class="fl">0.25</span>,
             sigma_model <span class="op">=</span> <span class="st">"single"</span>,              <span class="co"># sigma is the same for each source location</span>
             sigma_prior_mean <span class="op">=</span> <span class="fl">1</span>,                <span class="co"># set a prior mean of 1km for sigma</span>
             sigma_prior_sd <span class="op">=</span> <span class="fl">1</span>,                  <span class="co"># set the standard devation for this sigma prior</span>
             expected_popsize_prior_mean <span class="op">=</span> <span class="fl">200</span>,   <span class="co"># set the mean of the prior on expected population size </span>
             expected_popsize_prior_sd <span class="op">=</span> <span class="fl">30</span>,      <span class="co"># set the standard deviation of this prior  </span>
             name <span class="op">=</span> <span class="st">"Tutorial Parameters"</span><span class="op">)</span>        <span class="co"># name the parameter set</span>
<span class="va">p</span></code></pre></div>
<pre><code>## DATA:
##    type: count
##    sentinel sites = 100 (19 positive, 81 negative)
##    total observations = 27
## 
## PARAMETER SETS:
##  * SET1: Tutorial Parameters
## 
## ACTIVE SET: SET1
##    sentinel radius = 0.25
##    dispersal/decay kernel = normal
##    spatial prior:
##       longitude range = [-0.21, 0.01]
##       latitude range = [51.445, 51.555]
##       area (km^2) = 185.816
##       cells = 100, 100 (lon, lat)
##    sigma prior:
##       model = single
##       prior mean = 1
##       prior SD = 1
##    expected population size prior:
##       model = single
##       prior mean = 200
##       prior SD = 30</code></pre>
<p>The project <code>p</code> is now taking shape as we have provided the data and parameters for the model. Each time the <code><a href="../reference/new_set.html">new_set()</a></code> function is run it will add a new set of parameters to <code>p$parameters_sets</code> and will regard this new set as the <code>active_set</code>. To delete an old parameter set, we use <code><a href="../reference/delete_set.html">delete_set()</a></code>. The <code>"output"</code> object within <code>p</code> is empty right now, but will be populated once the model has run.</p>
</div>
<div id="running-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#running-the-model" class="anchor"></a>Running the model</h2>
<p>We are now ready to run the MCMC algorithm on our data. The arguments in <code><a href="../reference/run_mcmc.html">run_mcmc()</a></code> are similar to many other MCMC implementations. The algorithm will start with the burn-in phase, checking for convergence in multiples of <code>convergence_test</code> iterations. The MCMC will then move into the sampling phase once the conditions for convergence have been met or the number of burn-in iterations has been reached. The argument <code>K</code> governs how many sources the model should search for. Although we simulated the data, and know the true underlying number of sources, this will rarely be the case with a real-world data set. Hence <code>K</code> can take a single value or a sequence of values. We choose <code>1:5</code> as our data was generated with three sources. The <code>pb_markdown = TRUE</code> argument ensures a neater version of the console output is printed below, this should be removed when run by you.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mcmc.html">run_mcmc</a></span><span class="op">(</span>project <span class="op">=</span> <span class="va">p</span>,
              K <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,
              burnin <span class="op">=</span> <span class="fl">1e4</span>,
              samples <span class="op">=</span> <span class="fl">5e4</span>,
              converge_test <span class="op">=</span> <span class="fl">5e3</span>,
              auto_converge <span class="op">=</span> <span class="cn">TRUE</span>,
              pb_markdown <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Before plotting any geoprofiles let's makes sure the MCMC is indeed mixing well.</p>
</div>
<div id="diagnosing-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#diagnosing-the-model" class="anchor"></a>Diagnosing the model</h2>
<p>Firstly we question the MCMC's ability by producing diagnostic plots of the log-likelihood. This can be done for each value of <code>K</code> to ensure the algorithm is behaving properly.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_loglike_diagnostic.html">plot_loglike_diagnostic</a></span><span class="op">(</span><span class="va">p</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="Poisson-basic-implementation_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>Another useful metric for assessing the MCMC is its effective sampling size (ESS). If we have 10,000 sampling iterations but an ESS of 80 then we really only have 80 samples from the posterior, and so we should run it out for longer.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_output.html">get_output</a></span><span class="op">(</span><span class="va">p</span>, name <span class="op">=</span> <span class="st">"ESS"</span>, K <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"summary"</span><span class="op">)</span></code></pre></div>
<pre><code>##    rung1 
## 3187.753</code></pre>
</div>
<div id="results" class="section level2">
<h2 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h2>
<div id="mapping" class="section level3">
<h3 class="hasAnchor">
<a href="#mapping" class="anchor"></a>Mapping</h3>
<p>Now the model has run, we can start to visualise different aspects of the project. Plotting objects in silverblaze follow a similar structure to <a href="https://rstudio.github.io/leaflet/">Leaflet</a> and <a href="https://ggplot2.tidyverse.org/">ggplot2</a>. We start with a base layer</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_map.html">plot_map</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>and overlay different parts of our project using the set of overlay functions. Lets start with the underlying locations of individuals and their sources.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/overlay_points.html">overlay_points</a></span><span class="op">(</span><span class="va">plot1</span>, <span class="va">data_all</span><span class="op">$</span><span class="va">longitude</span>, <span class="va">data_all</span><span class="op">$</span><span class="va">latitude</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/overlay_sources.html">overlay_sources</a></span><span class="op">(</span><span class="va">plot2</span>, <span class="va">true_source</span><span class="op">$</span><span class="va">longitude</span>, <span class="va">true_source</span><span class="op">$</span><span class="va">latitude</span><span class="op">)</span>
<span class="va">plot2</span></code></pre></div>
<div id="htmlwidget-8210743b381dd147475d" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-8210743b381dd147475d">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.5045648203327,51.4896115519973,51.4869151710936,51.4632950038049,51.4911825057226,51.4529307234618,51.4796277721635,51.4895990612928,51.4671438856953,51.5070661095325,51.4820202822313,51.4788718277718,51.4765319352643,51.4683497367445,51.4601754349783,51.4725059160424,51.4822001471968,51.4651267750418,51.4880657300444,51.5139549526864,51.4802159806385,51.4781367811875,51.4665648841157,51.4826498064803,51.4560594837128,51.4959014900233,51.4742400354833,51.507000767687,51.476109447995,51.4947783928317,51.5026614299395,51.4834433276655,51.4728637961213,51.4791714476775,51.4845288879628,51.4794096651119,51.4835883571178,51.4931618867639,51.4943745711011,51.513628418715,51.4814959071071,51.4902768145629,51.4802665639396,51.4769446188371,51.466962204228,51.4840413810275,51.4609762199572,51.5020042548081,51.5028695080757,51.4745245323618,51.466782665211,51.4621412635753,51.5112244731785,51.4817831123553,51.4867788785953,51.4904072286547,51.479953556862,51.4616629236267,51.4635932834785,51.4550128092732,51.4726554837038,51.5000672601414,51.4510839066738,51.4763142508114,51.4827261117988,51.4597687128607,51.4974200911334,51.4833260235281,51.4851577949788,51.4595878874254,51.4899955855947,51.5104491616519,51.4984347581907,51.4736402679597,51.5036753092995,51.4855856598706,51.4808824269436,51.4591274528773,51.5116427329639,51.4635744597507,51.481162868513,51.4964097363212,51.4748475172614,51.4980381107231,51.4863918469601,51.4570620260752,51.4747187110173,51.4691974077805,51.4803426608787,51.4744702532808,51.4704755069656,51.4966863151239,51.5038297860908,51.4882298856521,51.4949706267857,51.4860670697117,51.487719082651,51.4722230489253,51.4889839125076,51.4835268657153,51.4675329254011,51.4890928940315,51.5010916198555,51.4793697573349,51.4660709536375,51.4809430217734,51.4796375227703,51.4463369814723,51.4944532614367,51.4731662745829,51.4936043529407,51.5012239154624,51.4520997686027,51.4920723941246,51.4980757022422,51.4681388168659,51.4710947839208,51.4765813752864,51.4759753420779,51.4783652317669,51.5084772396074,51.487415770092,51.5093817982037,51.5106777603547,51.4680048115114,51.4673044171183,51.4529942318553,51.4989504340593,51.5147883893545,51.4773844144247,51.5072883607851,51.4900649913261,51.4972933765999,51.5076980506404,51.5021622268502,51.4841841006698,51.4703000528797,51.4568998204627,51.5027453431488,51.4722281276724,51.4855248242893,51.4892025104784,51.4957269238836,51.4614683933749,51.4992649485033,51.486822588983,51.4942786327425,51.5022159341208,51.4974690927387,51.4974455388491,51.4703076843676,51.4978819412093,51.4610113077722,51.4916899040506,51.4692585174499,51.4775071761803,51.504810990985,51.4854929495414,51.4900907178666,51.4884559961881,51.4919063736567,51.4786499671452,51.487670605401,51.4939199103877,51.4746011570014,51.4983533048901,51.4656929082475,51.4705325527705,51.4807243442797,51.4971200865808,51.5015513053217,51.4694846900766,51.4857130587262,51.5091058610644,51.4894676786411,51.4917999019503,51.4755917878406,51.4939217022197,51.4717640471095,51.471969843653,51.465795875552,51.4509681944509,51.4463038307549,51.4569151847363,51.4489525179329,51.464593773479,51.4533796510289,51.476330049826,51.4340004847601,51.4464836813252,51.4520757729686,51.4739378609063,51.4474923231053,51.4568347769742,51.449601054297,51.4587178187322,51.4584373241081,51.445756163685,51.4444675356644,51.4357369904114,51.4617914813407,51.4299271205682,51.4850752563697,51.4377986183545,51.4578501754617,51.4410438143375,51.4765696866393,51.4446972475684,51.4437256712088,51.4220782079862,51.4468349839288,51.4383219160523,51.4452155266885,51.4514752687447,51.4379773472667,51.4518532357461,51.4368415566366,51.453724104277,51.4624976614929,51.4717873134601,51.4610637211689,51.4780298278622,51.4452447283523,51.4503541096982,51.4408121816865,51.473525650226,51.4754197534666,51.4663799757924,51.4580549601102,51.4448633763316,51.4581027286771,51.4462304871692,51.4668882899527,51.4652257272246,51.4541821049789,51.456188380977,51.4638082209496,51.4407254673264,51.4333296444107,51.4564105049586,51.4470878996209,51.4698543744526,51.4464787935573,51.4500053894906,51.4546977964304,51.4421255849325,51.4382876016004,51.4454037292127,51.4714502608005,51.4430762796092,51.412679308001,51.4295674577924,51.4561704075955,51.4485354364072,51.4738664745259,51.4599032979977,51.4485781291036,51.4448996956486,51.461320449078,51.4456775221906,51.4486923470943,51.4535270436152,51.4449539329071,51.4795943085579,51.4497280549665,51.4528433237672,51.4087726167919,51.4446457519671,51.4645163519548,51.4380564987253,51.4379397122597,51.4486551506072,51.4542339604493,51.4391852632716,51.464489124217,51.4132930138673,51.4471692265526,51.4617073732826,51.4365083867528,51.4527432795173,51.4633876995843,51.443807179327,51.475256437175,51.4398446775813,51.4732726340447,51.4368942820169,51.4381577750769,51.4462510047602,51.4581912112448,51.4494735562172,51.4498533670662,51.4730438392935,51.4723365671113,51.4505833558799,51.4321426685551,51.4700138179266,51.4597173213995,51.4494192616283,51.4500621004752,51.4340136651251,51.4640603150382,51.4702328059644,51.4492922950074,51.4417840331141,51.4673549896967,51.478704844648,51.4818282405673,51.4670873166775,51.4707886700619,51.4658175685578,51.4682114053031,51.4253370466243,51.4362640283081,51.4469635890223,51.4488202669052,51.4185936125494,51.4333490155135,51.4388314755019,51.4602844372618,51.4398680152196,51.4591147199816,51.4496825075394],[-0.150855563580461,-0.188383162925262,-0.159071952941136,-0.188933466003822,-0.219924792031418,-0.189227902470024,-0.199822802749953,-0.187253238095479,-0.156546126112034,-0.172388786646856,-0.16663353613754,-0.162240801881617,-0.147626905495379,-0.181935826623363,-0.190952765812339,-0.161210837819281,-0.161195727011214,-0.163238068585661,-0.207068715083452,-0.165311469589619,-0.16976904923693,-0.155853902005356,-0.167295937142216,-0.184775076325193,-0.177458796314829,-0.177363037114451,-0.157068154405306,-0.179490066521061,-0.193150280483689,-0.155002038963017,-0.14631485305268,-0.187144359633869,-0.194954517431931,-0.177750971425563,-0.168221205757975,-0.161998227534969,-0.189291040190509,-0.14223917177445,-0.174272652591823,-0.128598699096318,-0.176456041005241,-0.164476731843977,-0.150562568571274,-0.198772054214393,-0.142382499368385,-0.19965115063597,-0.154761009611492,-0.17055150286466,-0.214406693399659,-0.190521819324948,-0.136112173849952,-0.206663809492849,-0.153620954759776,-0.202889280087582,-0.157527158235126,-0.140058886511216,-0.145974113272197,-0.183227703828043,-0.224274767086714,-0.187449228618464,-0.13516318358443,-0.15246668836971,-0.165971804256166,-0.198710307480201,-0.191345457144613,-0.159812614770282,-0.166311913773744,-0.183800131663819,-0.161096674520138,-0.194802930600241,-0.158319182733662,-0.18092932523416,-0.189777656226,-0.160656520978293,-0.155982294171431,-0.156916363443543,-0.194081399211317,-0.175726844421524,-0.166047525320039,-0.166046653299436,-0.201892560912603,-0.152483574150638,-0.212694997299064,-0.158872086497552,-0.197475053362021,-0.126155521599338,-0.173574038738541,-0.194950942827075,-0.117700418114192,-0.17936465036415,-0.181622944324981,-0.193682980277384,-0.149329734439316,-0.144898855181338,-0.190972027190898,-0.139660373377033,-0.123108385610734,-0.176145832454198,-0.139713446850182,-0.17685997452642,-0.205261073714908,-0.175404008306924,-0.154868705473096,-0.173826401627889,-0.189587799159534,-0.183623941061316,-0.192511237399212,-0.157395228872543,-0.137437961815788,-0.188830209726648,-0.164252974767999,-0.175075110027911,-0.191949971163896,-0.174934315066442,-0.189606554862089,-0.170063977670814,-0.149101141115323,-0.168837249027082,-0.178133287767943,-0.162798829703115,-0.13228153818653,-0.171418951211555,-0.16006041182772,-0.1884700078969,-0.170817977102677,-0.157372953161398,-0.163795318526741,-0.161645284868403,-0.164352805340088,-0.135852209136522,-0.134775405546203,-0.154304956129618,-0.17114499346382,-0.11846762472936,-0.191478051363543,-0.1465531247786,-0.172023654288247,-0.163447009924176,-0.177756155911842,-0.146120038397663,-0.130140750936277,-0.16719648440678,-0.150391267879034,-0.130469616615199,-0.159669030928548,-0.178043417748638,-0.130327284827791,-0.179465451024783,-0.150832342391126,-0.183004409403061,-0.155693883632952,-0.175389939692436,-0.151875165691017,-0.201651214859989,-0.141292698089301,-0.1493957933816,-0.160634269863875,-0.153606507221729,-0.15698823779479,-0.192141560014385,-0.166832613727563,-0.210421240541203,-0.173677467851541,-0.185788579393248,-0.168367759239936,-0.165818752606969,-0.129294522057717,-0.170172687050319,-0.123479709104653,-0.127586768349745,-0.154037540205511,-0.206463655064118,-0.181727403746326,-0.177182746306671,-0.151341011134,-0.183217318711205,-0.148615338011269,-0.183541306280096,-0.183857233186498,-0.0338350852070062,-0.087837963002422,0.00289779245192764,-0.0455770894876202,-0.0132196957221007,-0.0184181407879538,0.0097490476292516,0.0228689700051499,0.0336932009567548,-0.0159399018672485,0.0158514384307388,-0.0110209062120733,0.00241374301499401,-0.0301725306503507,0.0278222878568603,-0.0176985195427547,0.0224631262784764,-0.0237026006986679,-0.0288916952069812,-0.0247061629725647,0.0254554732446242,0.0186325197593488,-0.0556724807117963,-0.00782903497805638,0.00500828683162098,-0.0428590127106948,4.44036136538754e-06,-0.00451801945477921,-0.00588802357844579,-0.0179854324270984,-0.0170845142404177,-0.00188229156321262,0.00304541173653978,0.00828537338844072,-0.0459448391016947,-0.0345857120225141,-0.0374405979871479,-0.0373460437293599,0.0258054588322009,0.0330142899282707,-0.00897295946573307,-0.00249286395544709,0.0260685547638611,-0.00240916115057436,-0.0134590853153325,0.0189892476145761,-0.0449694589043003,-0.02617309650669,0.00523520968238503,0.0196117668722098,-0.0139171598510372,-0.0419027376498802,-0.00872621963434782,0.00269242968794223,-0.0197954797325495,0.00165882683321751,-0.0200980781566062,0.00173199583908698,-0.0450218027204713,-0.0176300419740892,-0.0134969503873569,-0.000934407826755327,0.000108243331493008,-0.0192116268350998,0.0185849322931001,0.0231954076883412,0.00855665155777721,-0.0214994674720784,-0.0193291086614984,-0.0488196119250311,-0.0164969687960058,-0.0380957205891433,0.0309330866601598,-0.0104340804060836,-0.0279037755040062,0.0269012202185408,-0.024937679475141,0.00879176165246634,-0.0807186296653895,-0.0232194880659507,-0.0255078059039789,-0.0207992684947333,0.00742282019353544,0.00169799216862489,-0.0133706666496826,-0.0103465345467458,0.0239014670193333,-0.00979577421266445,-0.00280562849410022,-0.00294442094805969,-0.00207025728805995,0.0146694891634896,-0.0218972527963709,-0.00199143997903957,-0.0166565703126042,-0.0274215000204936,0.0243927295819348,-0.0367237115905016,0.00912016986493446,-0.0162973932421755,-0.00710228360701375,-0.0553920824304559,0.00831533883714388,-0.0262574910582505,-0.00495161934141743,0.0187662266581122,0.0452957455164903,-0.0461022007456824,-0.0154856563870425,0.0282997867643309,-0.0350180132702868,-0.0169120922058996,-0.0144301699508357,0.0262340849219053,0.00297849441583101,-0.0146234661032689,-0.0275569600414006,-0.0196225411688789,0.0170981661381446,-0.0122118292786781,-0.0541592608683055,-0.0403815521500308,-0.0244934187320409,-0.0294440007861447,-0.013303472227164,-0.0436552924246835,-0.043742743524903,-0.00595488806379786,0.0303817973194932,-0.00812200262701987,0.0148185454705204,-0.00695402475806973,-0.00279442908929412,-0.00868010863395064,-0.0309607676427706,-0.0020390880772803,0.0162470866126876,0.00591006060511272,-0.026285890727909,-0.00765650558889473,-0.00961796012882613,-0.015895904516671,0.00633168852989067],2,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.4846474873833,51.4520789653761],[-0.167596056684852,-0.00600149971432984],{"iconUrl":{"data":"https://github.com/Michael-Stevens-27/silverblaze/raw/master/R_ignore/icons/black_cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[51.4087726167919,51.5147883893545],"lng":[-0.224274767086714,0.0452957455164903]}},"evals":[],"jsHooks":[]}</script><p>This isn't too interesting yet, so let's add to this the spatial prior and the sentinel site locations. The <code><a href="../reference/overlay_sentinels.html">overlay_sentinels()</a></code> function comes with multiple arguments, much like the base functions in R, in order to customise your plot.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/overlay_spatial_prior.html">overlay_spatial_prior</a></span><span class="op">(</span><span class="va">plot2</span>, <span class="va">p</span>, col <span class="op">=</span> <span class="st">"red"</span>, opacity <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/overlay_sentinels.html">overlay_sentinels</a></span><span class="op">(</span><span class="va">plot2</span>, 
                           <span class="va">p</span>, 
                           fill_opacity <span class="op">=</span> <span class="fl">0.9</span>,
                           fill <span class="op">=</span> <span class="cn">TRUE</span>, 
                           fill_colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">grey</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span>, <span class="st">"red"</span><span class="op">)</span>,
                           border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, 
                           border_colour <span class="op">=</span> <span class="st">"black"</span>, 
                           border_weight <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<pre><code>## getting sentinel radius from active parameter set:</code></pre>
<pre><code>##   sentinal radius = 0.25km</code></pre>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot2</span></code></pre></div>
<p></p>
<div id="htmlwidget-36db3a1c8db6fd77b4ac" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-36db3a1c8db6fd77b4ac">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.5045648203327,51.4896115519973,51.4869151710936,51.4632950038049,51.4911825057226,51.4529307234618,51.4796277721635,51.4895990612928,51.4671438856953,51.5070661095325,51.4820202822313,51.4788718277718,51.4765319352643,51.4683497367445,51.4601754349783,51.4725059160424,51.4822001471968,51.4651267750418,51.4880657300444,51.5139549526864,51.4802159806385,51.4781367811875,51.4665648841157,51.4826498064803,51.4560594837128,51.4959014900233,51.4742400354833,51.507000767687,51.476109447995,51.4947783928317,51.5026614299395,51.4834433276655,51.4728637961213,51.4791714476775,51.4845288879628,51.4794096651119,51.4835883571178,51.4931618867639,51.4943745711011,51.513628418715,51.4814959071071,51.4902768145629,51.4802665639396,51.4769446188371,51.466962204228,51.4840413810275,51.4609762199572,51.5020042548081,51.5028695080757,51.4745245323618,51.466782665211,51.4621412635753,51.5112244731785,51.4817831123553,51.4867788785953,51.4904072286547,51.479953556862,51.4616629236267,51.4635932834785,51.4550128092732,51.4726554837038,51.5000672601414,51.4510839066738,51.4763142508114,51.4827261117988,51.4597687128607,51.4974200911334,51.4833260235281,51.4851577949788,51.4595878874254,51.4899955855947,51.5104491616519,51.4984347581907,51.4736402679597,51.5036753092995,51.4855856598706,51.4808824269436,51.4591274528773,51.5116427329639,51.4635744597507,51.481162868513,51.4964097363212,51.4748475172614,51.4980381107231,51.4863918469601,51.4570620260752,51.4747187110173,51.4691974077805,51.4803426608787,51.4744702532808,51.4704755069656,51.4966863151239,51.5038297860908,51.4882298856521,51.4949706267857,51.4860670697117,51.487719082651,51.4722230489253,51.4889839125076,51.4835268657153,51.4675329254011,51.4890928940315,51.5010916198555,51.4793697573349,51.4660709536375,51.4809430217734,51.4796375227703,51.4463369814723,51.4944532614367,51.4731662745829,51.4936043529407,51.5012239154624,51.4520997686027,51.4920723941246,51.4980757022422,51.4681388168659,51.4710947839208,51.4765813752864,51.4759753420779,51.4783652317669,51.5084772396074,51.487415770092,51.5093817982037,51.5106777603547,51.4680048115114,51.4673044171183,51.4529942318553,51.4989504340593,51.5147883893545,51.4773844144247,51.5072883607851,51.4900649913261,51.4972933765999,51.5076980506404,51.5021622268502,51.4841841006698,51.4703000528797,51.4568998204627,51.5027453431488,51.4722281276724,51.4855248242893,51.4892025104784,51.4957269238836,51.4614683933749,51.4992649485033,51.486822588983,51.4942786327425,51.5022159341208,51.4974690927387,51.4974455388491,51.4703076843676,51.4978819412093,51.4610113077722,51.4916899040506,51.4692585174499,51.4775071761803,51.504810990985,51.4854929495414,51.4900907178666,51.4884559961881,51.4919063736567,51.4786499671452,51.487670605401,51.4939199103877,51.4746011570014,51.4983533048901,51.4656929082475,51.4705325527705,51.4807243442797,51.4971200865808,51.5015513053217,51.4694846900766,51.4857130587262,51.5091058610644,51.4894676786411,51.4917999019503,51.4755917878406,51.4939217022197,51.4717640471095,51.471969843653,51.465795875552,51.4509681944509,51.4463038307549,51.4569151847363,51.4489525179329,51.464593773479,51.4533796510289,51.476330049826,51.4340004847601,51.4464836813252,51.4520757729686,51.4739378609063,51.4474923231053,51.4568347769742,51.449601054297,51.4587178187322,51.4584373241081,51.445756163685,51.4444675356644,51.4357369904114,51.4617914813407,51.4299271205682,51.4850752563697,51.4377986183545,51.4578501754617,51.4410438143375,51.4765696866393,51.4446972475684,51.4437256712088,51.4220782079862,51.4468349839288,51.4383219160523,51.4452155266885,51.4514752687447,51.4379773472667,51.4518532357461,51.4368415566366,51.453724104277,51.4624976614929,51.4717873134601,51.4610637211689,51.4780298278622,51.4452447283523,51.4503541096982,51.4408121816865,51.473525650226,51.4754197534666,51.4663799757924,51.4580549601102,51.4448633763316,51.4581027286771,51.4462304871692,51.4668882899527,51.4652257272246,51.4541821049789,51.456188380977,51.4638082209496,51.4407254673264,51.4333296444107,51.4564105049586,51.4470878996209,51.4698543744526,51.4464787935573,51.4500053894906,51.4546977964304,51.4421255849325,51.4382876016004,51.4454037292127,51.4714502608005,51.4430762796092,51.412679308001,51.4295674577924,51.4561704075955,51.4485354364072,51.4738664745259,51.4599032979977,51.4485781291036,51.4448996956486,51.461320449078,51.4456775221906,51.4486923470943,51.4535270436152,51.4449539329071,51.4795943085579,51.4497280549665,51.4528433237672,51.4087726167919,51.4446457519671,51.4645163519548,51.4380564987253,51.4379397122597,51.4486551506072,51.4542339604493,51.4391852632716,51.464489124217,51.4132930138673,51.4471692265526,51.4617073732826,51.4365083867528,51.4527432795173,51.4633876995843,51.443807179327,51.475256437175,51.4398446775813,51.4732726340447,51.4368942820169,51.4381577750769,51.4462510047602,51.4581912112448,51.4494735562172,51.4498533670662,51.4730438392935,51.4723365671113,51.4505833558799,51.4321426685551,51.4700138179266,51.4597173213995,51.4494192616283,51.4500621004752,51.4340136651251,51.4640603150382,51.4702328059644,51.4492922950074,51.4417840331141,51.4673549896967,51.478704844648,51.4818282405673,51.4670873166775,51.4707886700619,51.4658175685578,51.4682114053031,51.4253370466243,51.4362640283081,51.4469635890223,51.4488202669052,51.4185936125494,51.4333490155135,51.4388314755019,51.4602844372618,51.4398680152196,51.4591147199816,51.4496825075394],[-0.150855563580461,-0.188383162925262,-0.159071952941136,-0.188933466003822,-0.219924792031418,-0.189227902470024,-0.199822802749953,-0.187253238095479,-0.156546126112034,-0.172388786646856,-0.16663353613754,-0.162240801881617,-0.147626905495379,-0.181935826623363,-0.190952765812339,-0.161210837819281,-0.161195727011214,-0.163238068585661,-0.207068715083452,-0.165311469589619,-0.16976904923693,-0.155853902005356,-0.167295937142216,-0.184775076325193,-0.177458796314829,-0.177363037114451,-0.157068154405306,-0.179490066521061,-0.193150280483689,-0.155002038963017,-0.14631485305268,-0.187144359633869,-0.194954517431931,-0.177750971425563,-0.168221205757975,-0.161998227534969,-0.189291040190509,-0.14223917177445,-0.174272652591823,-0.128598699096318,-0.176456041005241,-0.164476731843977,-0.150562568571274,-0.198772054214393,-0.142382499368385,-0.19965115063597,-0.154761009611492,-0.17055150286466,-0.214406693399659,-0.190521819324948,-0.136112173849952,-0.206663809492849,-0.153620954759776,-0.202889280087582,-0.157527158235126,-0.140058886511216,-0.145974113272197,-0.183227703828043,-0.224274767086714,-0.187449228618464,-0.13516318358443,-0.15246668836971,-0.165971804256166,-0.198710307480201,-0.191345457144613,-0.159812614770282,-0.166311913773744,-0.183800131663819,-0.161096674520138,-0.194802930600241,-0.158319182733662,-0.18092932523416,-0.189777656226,-0.160656520978293,-0.155982294171431,-0.156916363443543,-0.194081399211317,-0.175726844421524,-0.166047525320039,-0.166046653299436,-0.201892560912603,-0.152483574150638,-0.212694997299064,-0.158872086497552,-0.197475053362021,-0.126155521599338,-0.173574038738541,-0.194950942827075,-0.117700418114192,-0.17936465036415,-0.181622944324981,-0.193682980277384,-0.149329734439316,-0.144898855181338,-0.190972027190898,-0.139660373377033,-0.123108385610734,-0.176145832454198,-0.139713446850182,-0.17685997452642,-0.205261073714908,-0.175404008306924,-0.154868705473096,-0.173826401627889,-0.189587799159534,-0.183623941061316,-0.192511237399212,-0.157395228872543,-0.137437961815788,-0.188830209726648,-0.164252974767999,-0.175075110027911,-0.191949971163896,-0.174934315066442,-0.189606554862089,-0.170063977670814,-0.149101141115323,-0.168837249027082,-0.178133287767943,-0.162798829703115,-0.13228153818653,-0.171418951211555,-0.16006041182772,-0.1884700078969,-0.170817977102677,-0.157372953161398,-0.163795318526741,-0.161645284868403,-0.164352805340088,-0.135852209136522,-0.134775405546203,-0.154304956129618,-0.17114499346382,-0.11846762472936,-0.191478051363543,-0.1465531247786,-0.172023654288247,-0.163447009924176,-0.177756155911842,-0.146120038397663,-0.130140750936277,-0.16719648440678,-0.150391267879034,-0.130469616615199,-0.159669030928548,-0.178043417748638,-0.130327284827791,-0.179465451024783,-0.150832342391126,-0.183004409403061,-0.155693883632952,-0.175389939692436,-0.151875165691017,-0.201651214859989,-0.141292698089301,-0.1493957933816,-0.160634269863875,-0.153606507221729,-0.15698823779479,-0.192141560014385,-0.166832613727563,-0.210421240541203,-0.173677467851541,-0.185788579393248,-0.168367759239936,-0.165818752606969,-0.129294522057717,-0.170172687050319,-0.123479709104653,-0.127586768349745,-0.154037540205511,-0.206463655064118,-0.181727403746326,-0.177182746306671,-0.151341011134,-0.183217318711205,-0.148615338011269,-0.183541306280096,-0.183857233186498,-0.0338350852070062,-0.087837963002422,0.00289779245192764,-0.0455770894876202,-0.0132196957221007,-0.0184181407879538,0.0097490476292516,0.0228689700051499,0.0336932009567548,-0.0159399018672485,0.0158514384307388,-0.0110209062120733,0.00241374301499401,-0.0301725306503507,0.0278222878568603,-0.0176985195427547,0.0224631262784764,-0.0237026006986679,-0.0288916952069812,-0.0247061629725647,0.0254554732446242,0.0186325197593488,-0.0556724807117963,-0.00782903497805638,0.00500828683162098,-0.0428590127106948,4.44036136538754e-06,-0.00451801945477921,-0.00588802357844579,-0.0179854324270984,-0.0170845142404177,-0.00188229156321262,0.00304541173653978,0.00828537338844072,-0.0459448391016947,-0.0345857120225141,-0.0374405979871479,-0.0373460437293599,0.0258054588322009,0.0330142899282707,-0.00897295946573307,-0.00249286395544709,0.0260685547638611,-0.00240916115057436,-0.0134590853153325,0.0189892476145761,-0.0449694589043003,-0.02617309650669,0.00523520968238503,0.0196117668722098,-0.0139171598510372,-0.0419027376498802,-0.00872621963434782,0.00269242968794223,-0.0197954797325495,0.00165882683321751,-0.0200980781566062,0.00173199583908698,-0.0450218027204713,-0.0176300419740892,-0.0134969503873569,-0.000934407826755327,0.000108243331493008,-0.0192116268350998,0.0185849322931001,0.0231954076883412,0.00855665155777721,-0.0214994674720784,-0.0193291086614984,-0.0488196119250311,-0.0164969687960058,-0.0380957205891433,0.0309330866601598,-0.0104340804060836,-0.0279037755040062,0.0269012202185408,-0.024937679475141,0.00879176165246634,-0.0807186296653895,-0.0232194880659507,-0.0255078059039789,-0.0207992684947333,0.00742282019353544,0.00169799216862489,-0.0133706666496826,-0.0103465345467458,0.0239014670193333,-0.00979577421266445,-0.00280562849410022,-0.00294442094805969,-0.00207025728805995,0.0146694891634896,-0.0218972527963709,-0.00199143997903957,-0.0166565703126042,-0.0274215000204936,0.0243927295819348,-0.0367237115905016,0.00912016986493446,-0.0162973932421755,-0.00710228360701375,-0.0553920824304559,0.00831533883714388,-0.0262574910582505,-0.00495161934141743,0.0187662266581122,0.0452957455164903,-0.0461022007456824,-0.0154856563870425,0.0282997867643309,-0.0350180132702868,-0.0169120922058996,-0.0144301699508357,0.0262340849219053,0.00297849441583101,-0.0146234661032689,-0.0275569600414006,-0.0196225411688789,0.0170981661381446,-0.0122118292786781,-0.0541592608683055,-0.0403815521500308,-0.0244934187320409,-0.0294440007861447,-0.013303472227164,-0.0436552924246835,-0.043742743524903,-0.00595488806379786,0.0303817973194932,-0.00812200262701987,0.0148185454705204,-0.00695402475806973,-0.00279442908929412,-0.00868010863395064,-0.0309607676427706,-0.0020390880772803,0.0162470866126876,0.00591006060511272,-0.026285890727909,-0.00765650558889473,-0.00961796012882613,-0.015895904516671,0.00633168852989067],2,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.4846474873833,51.4520789653761],[-0.167596056684852,-0.00600149971432984],{"iconUrl":{"data":"https://github.com/Michael-Stevens-27/silverblaze/raw/master/R_ignore/icons/black_cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAABAElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZOjNnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIzAXsTALGT7m3PwAAAABJRU5ErkJggg==",[[51.555,-0.210000000000012],[51.445,0.00999999999999939]],0.2,null,null,null]},{"method":"addCircles","args":[[51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55],[-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0],250,null,null,{"interactive":true,"className":"","stroke":[false,false,false,false,false,false,false,true,true,true,false,false,true,true,false,false,false,false,true,true,false,true,true,true,false,false,false,true,false,false,true,true,false,false,false,false,false,false,false,false,false,true,true,true,false,false,false,false,false,false,false,true,true,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"color":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"weight":0.5,"opacity":1,"fill":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"fillColor":["#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3"],"fillOpacity":0.9},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"limits":{"lat":[51.4087726167919,51.555],"lng":[-0.224274767086714,0.0452957455164903]}},"evals":[],"jsHooks":[]}</script> Finally, we add in the geoprofile produced by running the MCMC.
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/overlay_geoprofile.html">overlay_geoprofile</a></span><span class="op">(</span><span class="va">plot2</span>, 
                            project <span class="op">=</span> <span class="va">p</span>, 
                            threshold <span class="op">=</span> <span class="fl">0.1</span>, 
                            opacity <span class="op">=</span> <span class="fl">0.8</span>, 
                            K <span class="op">=</span> <span class="fl">2</span>, 
                            col <span class="op">=</span> <span class="va">plasma</span>, 
                            legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">plot2</span></code></pre></div>
<div id="htmlwidget-c324a66196004ecbadf0" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-c324a66196004ecbadf0">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.5045648203327,51.4896115519973,51.4869151710936,51.4632950038049,51.4911825057226,51.4529307234618,51.4796277721635,51.4895990612928,51.4671438856953,51.5070661095325,51.4820202822313,51.4788718277718,51.4765319352643,51.4683497367445,51.4601754349783,51.4725059160424,51.4822001471968,51.4651267750418,51.4880657300444,51.5139549526864,51.4802159806385,51.4781367811875,51.4665648841157,51.4826498064803,51.4560594837128,51.4959014900233,51.4742400354833,51.507000767687,51.476109447995,51.4947783928317,51.5026614299395,51.4834433276655,51.4728637961213,51.4791714476775,51.4845288879628,51.4794096651119,51.4835883571178,51.4931618867639,51.4943745711011,51.513628418715,51.4814959071071,51.4902768145629,51.4802665639396,51.4769446188371,51.466962204228,51.4840413810275,51.4609762199572,51.5020042548081,51.5028695080757,51.4745245323618,51.466782665211,51.4621412635753,51.5112244731785,51.4817831123553,51.4867788785953,51.4904072286547,51.479953556862,51.4616629236267,51.4635932834785,51.4550128092732,51.4726554837038,51.5000672601414,51.4510839066738,51.4763142508114,51.4827261117988,51.4597687128607,51.4974200911334,51.4833260235281,51.4851577949788,51.4595878874254,51.4899955855947,51.5104491616519,51.4984347581907,51.4736402679597,51.5036753092995,51.4855856598706,51.4808824269436,51.4591274528773,51.5116427329639,51.4635744597507,51.481162868513,51.4964097363212,51.4748475172614,51.4980381107231,51.4863918469601,51.4570620260752,51.4747187110173,51.4691974077805,51.4803426608787,51.4744702532808,51.4704755069656,51.4966863151239,51.5038297860908,51.4882298856521,51.4949706267857,51.4860670697117,51.487719082651,51.4722230489253,51.4889839125076,51.4835268657153,51.4675329254011,51.4890928940315,51.5010916198555,51.4793697573349,51.4660709536375,51.4809430217734,51.4796375227703,51.4463369814723,51.4944532614367,51.4731662745829,51.4936043529407,51.5012239154624,51.4520997686027,51.4920723941246,51.4980757022422,51.4681388168659,51.4710947839208,51.4765813752864,51.4759753420779,51.4783652317669,51.5084772396074,51.487415770092,51.5093817982037,51.5106777603547,51.4680048115114,51.4673044171183,51.4529942318553,51.4989504340593,51.5147883893545,51.4773844144247,51.5072883607851,51.4900649913261,51.4972933765999,51.5076980506404,51.5021622268502,51.4841841006698,51.4703000528797,51.4568998204627,51.5027453431488,51.4722281276724,51.4855248242893,51.4892025104784,51.4957269238836,51.4614683933749,51.4992649485033,51.486822588983,51.4942786327425,51.5022159341208,51.4974690927387,51.4974455388491,51.4703076843676,51.4978819412093,51.4610113077722,51.4916899040506,51.4692585174499,51.4775071761803,51.504810990985,51.4854929495414,51.4900907178666,51.4884559961881,51.4919063736567,51.4786499671452,51.487670605401,51.4939199103877,51.4746011570014,51.4983533048901,51.4656929082475,51.4705325527705,51.4807243442797,51.4971200865808,51.5015513053217,51.4694846900766,51.4857130587262,51.5091058610644,51.4894676786411,51.4917999019503,51.4755917878406,51.4939217022197,51.4717640471095,51.471969843653,51.465795875552,51.4509681944509,51.4463038307549,51.4569151847363,51.4489525179329,51.464593773479,51.4533796510289,51.476330049826,51.4340004847601,51.4464836813252,51.4520757729686,51.4739378609063,51.4474923231053,51.4568347769742,51.449601054297,51.4587178187322,51.4584373241081,51.445756163685,51.4444675356644,51.4357369904114,51.4617914813407,51.4299271205682,51.4850752563697,51.4377986183545,51.4578501754617,51.4410438143375,51.4765696866393,51.4446972475684,51.4437256712088,51.4220782079862,51.4468349839288,51.4383219160523,51.4452155266885,51.4514752687447,51.4379773472667,51.4518532357461,51.4368415566366,51.453724104277,51.4624976614929,51.4717873134601,51.4610637211689,51.4780298278622,51.4452447283523,51.4503541096982,51.4408121816865,51.473525650226,51.4754197534666,51.4663799757924,51.4580549601102,51.4448633763316,51.4581027286771,51.4462304871692,51.4668882899527,51.4652257272246,51.4541821049789,51.456188380977,51.4638082209496,51.4407254673264,51.4333296444107,51.4564105049586,51.4470878996209,51.4698543744526,51.4464787935573,51.4500053894906,51.4546977964304,51.4421255849325,51.4382876016004,51.4454037292127,51.4714502608005,51.4430762796092,51.412679308001,51.4295674577924,51.4561704075955,51.4485354364072,51.4738664745259,51.4599032979977,51.4485781291036,51.4448996956486,51.461320449078,51.4456775221906,51.4486923470943,51.4535270436152,51.4449539329071,51.4795943085579,51.4497280549665,51.4528433237672,51.4087726167919,51.4446457519671,51.4645163519548,51.4380564987253,51.4379397122597,51.4486551506072,51.4542339604493,51.4391852632716,51.464489124217,51.4132930138673,51.4471692265526,51.4617073732826,51.4365083867528,51.4527432795173,51.4633876995843,51.443807179327,51.475256437175,51.4398446775813,51.4732726340447,51.4368942820169,51.4381577750769,51.4462510047602,51.4581912112448,51.4494735562172,51.4498533670662,51.4730438392935,51.4723365671113,51.4505833558799,51.4321426685551,51.4700138179266,51.4597173213995,51.4494192616283,51.4500621004752,51.4340136651251,51.4640603150382,51.4702328059644,51.4492922950074,51.4417840331141,51.4673549896967,51.478704844648,51.4818282405673,51.4670873166775,51.4707886700619,51.4658175685578,51.4682114053031,51.4253370466243,51.4362640283081,51.4469635890223,51.4488202669052,51.4185936125494,51.4333490155135,51.4388314755019,51.4602844372618,51.4398680152196,51.4591147199816,51.4496825075394],[-0.150855563580461,-0.188383162925262,-0.159071952941136,-0.188933466003822,-0.219924792031418,-0.189227902470024,-0.199822802749953,-0.187253238095479,-0.156546126112034,-0.172388786646856,-0.16663353613754,-0.162240801881617,-0.147626905495379,-0.181935826623363,-0.190952765812339,-0.161210837819281,-0.161195727011214,-0.163238068585661,-0.207068715083452,-0.165311469589619,-0.16976904923693,-0.155853902005356,-0.167295937142216,-0.184775076325193,-0.177458796314829,-0.177363037114451,-0.157068154405306,-0.179490066521061,-0.193150280483689,-0.155002038963017,-0.14631485305268,-0.187144359633869,-0.194954517431931,-0.177750971425563,-0.168221205757975,-0.161998227534969,-0.189291040190509,-0.14223917177445,-0.174272652591823,-0.128598699096318,-0.176456041005241,-0.164476731843977,-0.150562568571274,-0.198772054214393,-0.142382499368385,-0.19965115063597,-0.154761009611492,-0.17055150286466,-0.214406693399659,-0.190521819324948,-0.136112173849952,-0.206663809492849,-0.153620954759776,-0.202889280087582,-0.157527158235126,-0.140058886511216,-0.145974113272197,-0.183227703828043,-0.224274767086714,-0.187449228618464,-0.13516318358443,-0.15246668836971,-0.165971804256166,-0.198710307480201,-0.191345457144613,-0.159812614770282,-0.166311913773744,-0.183800131663819,-0.161096674520138,-0.194802930600241,-0.158319182733662,-0.18092932523416,-0.189777656226,-0.160656520978293,-0.155982294171431,-0.156916363443543,-0.194081399211317,-0.175726844421524,-0.166047525320039,-0.166046653299436,-0.201892560912603,-0.152483574150638,-0.212694997299064,-0.158872086497552,-0.197475053362021,-0.126155521599338,-0.173574038738541,-0.194950942827075,-0.117700418114192,-0.17936465036415,-0.181622944324981,-0.193682980277384,-0.149329734439316,-0.144898855181338,-0.190972027190898,-0.139660373377033,-0.123108385610734,-0.176145832454198,-0.139713446850182,-0.17685997452642,-0.205261073714908,-0.175404008306924,-0.154868705473096,-0.173826401627889,-0.189587799159534,-0.183623941061316,-0.192511237399212,-0.157395228872543,-0.137437961815788,-0.188830209726648,-0.164252974767999,-0.175075110027911,-0.191949971163896,-0.174934315066442,-0.189606554862089,-0.170063977670814,-0.149101141115323,-0.168837249027082,-0.178133287767943,-0.162798829703115,-0.13228153818653,-0.171418951211555,-0.16006041182772,-0.1884700078969,-0.170817977102677,-0.157372953161398,-0.163795318526741,-0.161645284868403,-0.164352805340088,-0.135852209136522,-0.134775405546203,-0.154304956129618,-0.17114499346382,-0.11846762472936,-0.191478051363543,-0.1465531247786,-0.172023654288247,-0.163447009924176,-0.177756155911842,-0.146120038397663,-0.130140750936277,-0.16719648440678,-0.150391267879034,-0.130469616615199,-0.159669030928548,-0.178043417748638,-0.130327284827791,-0.179465451024783,-0.150832342391126,-0.183004409403061,-0.155693883632952,-0.175389939692436,-0.151875165691017,-0.201651214859989,-0.141292698089301,-0.1493957933816,-0.160634269863875,-0.153606507221729,-0.15698823779479,-0.192141560014385,-0.166832613727563,-0.210421240541203,-0.173677467851541,-0.185788579393248,-0.168367759239936,-0.165818752606969,-0.129294522057717,-0.170172687050319,-0.123479709104653,-0.127586768349745,-0.154037540205511,-0.206463655064118,-0.181727403746326,-0.177182746306671,-0.151341011134,-0.183217318711205,-0.148615338011269,-0.183541306280096,-0.183857233186498,-0.0338350852070062,-0.087837963002422,0.00289779245192764,-0.0455770894876202,-0.0132196957221007,-0.0184181407879538,0.0097490476292516,0.0228689700051499,0.0336932009567548,-0.0159399018672485,0.0158514384307388,-0.0110209062120733,0.00241374301499401,-0.0301725306503507,0.0278222878568603,-0.0176985195427547,0.0224631262784764,-0.0237026006986679,-0.0288916952069812,-0.0247061629725647,0.0254554732446242,0.0186325197593488,-0.0556724807117963,-0.00782903497805638,0.00500828683162098,-0.0428590127106948,4.44036136538754e-06,-0.00451801945477921,-0.00588802357844579,-0.0179854324270984,-0.0170845142404177,-0.00188229156321262,0.00304541173653978,0.00828537338844072,-0.0459448391016947,-0.0345857120225141,-0.0374405979871479,-0.0373460437293599,0.0258054588322009,0.0330142899282707,-0.00897295946573307,-0.00249286395544709,0.0260685547638611,-0.00240916115057436,-0.0134590853153325,0.0189892476145761,-0.0449694589043003,-0.02617309650669,0.00523520968238503,0.0196117668722098,-0.0139171598510372,-0.0419027376498802,-0.00872621963434782,0.00269242968794223,-0.0197954797325495,0.00165882683321751,-0.0200980781566062,0.00173199583908698,-0.0450218027204713,-0.0176300419740892,-0.0134969503873569,-0.000934407826755327,0.000108243331493008,-0.0192116268350998,0.0185849322931001,0.0231954076883412,0.00855665155777721,-0.0214994674720784,-0.0193291086614984,-0.0488196119250311,-0.0164969687960058,-0.0380957205891433,0.0309330866601598,-0.0104340804060836,-0.0279037755040062,0.0269012202185408,-0.024937679475141,0.00879176165246634,-0.0807186296653895,-0.0232194880659507,-0.0255078059039789,-0.0207992684947333,0.00742282019353544,0.00169799216862489,-0.0133706666496826,-0.0103465345467458,0.0239014670193333,-0.00979577421266445,-0.00280562849410022,-0.00294442094805969,-0.00207025728805995,0.0146694891634896,-0.0218972527963709,-0.00199143997903957,-0.0166565703126042,-0.0274215000204936,0.0243927295819348,-0.0367237115905016,0.00912016986493446,-0.0162973932421755,-0.00710228360701375,-0.0553920824304559,0.00831533883714388,-0.0262574910582505,-0.00495161934141743,0.0187662266581122,0.0452957455164903,-0.0461022007456824,-0.0154856563870425,0.0282997867643309,-0.0350180132702868,-0.0169120922058996,-0.0144301699508357,0.0262340849219053,0.00297849441583101,-0.0146234661032689,-0.0275569600414006,-0.0196225411688789,0.0170981661381446,-0.0122118292786781,-0.0541592608683055,-0.0403815521500308,-0.0244934187320409,-0.0294440007861447,-0.013303472227164,-0.0436552924246835,-0.043742743524903,-0.00595488806379786,0.0303817973194932,-0.00812200262701987,0.0148185454705204,-0.00695402475806973,-0.00279442908929412,-0.00868010863395064,-0.0309607676427706,-0.0020390880772803,0.0162470866126876,0.00591006060511272,-0.026285890727909,-0.00765650558889473,-0.00961796012882613,-0.015895904516671,0.00633168852989067],2,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.4846474873833,51.4520789653761],[-0.167596056684852,-0.00600149971432984],{"iconUrl":{"data":"https://github.com/Michael-Stevens-27/silverblaze/raw/master/R_ignore/icons/black_cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAABAElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZOjNnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIzAXsTALGT7m3PwAAAABJRU5ErkJggg==",[[51.555,-0.210000000000012],[51.445,0.00999999999999939]],0.2,null,null,null]},{"method":"addCircles","args":[[51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4611111111111,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4722222222222,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4833333333333,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.4944444444444,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5055555555556,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5166666666667,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5277777777778,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.5388888888889,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55],[-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0,-0.2,-0.177777777777778,-0.155555555555556,-0.133333333333333,-0.111111111111111,-0.0888888888888889,-0.0666666666666667,-0.0444444444444445,-0.0222222222222222,0],250,null,null,{"interactive":true,"className":"","stroke":[false,false,false,false,false,false,false,true,true,true,false,false,true,true,false,false,false,false,true,true,false,true,true,true,false,false,false,true,false,false,true,true,false,false,false,false,false,false,false,false,false,true,true,true,false,false,false,false,false,false,false,true,true,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"color":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"weight":0.5,"opacity":1,"fill":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"fillColor":["#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3"],"fillOpacity":0.9},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[51.555,-0.210000000000012],[51.445,0.00999999999999939]],0.8,null,null,null]},{"method":"addRectangles","args":[51.445,-0.21,51.555,0.00999999999999998,null,null,{"interactive":true,"className":"","stroke":true,"color":"#333333","weight":2,"opacity":0.5,"fill":false,"fillColor":"#333333","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#F0F921 , #F0F921 0%, #FBA738 20%, #E16562 40%, #B12B90 60%, #6B01A6 80%, #0D0887 100%, #0D0887 "],"labels":["0.00","0.02","0.04","0.06","0.08","0.10"],"na_color":null,"na_label":"NA","opacity":1,"position":"bottomright","type":"numeric","title":"Hit score","extra":{"p_1":0,"p_n":1},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[51.4087726167919,51.555],"lng":[-0.224274767086714,0.0452957455164903]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="other-parameter-estimation" class="section level3">
<h3 class="hasAnchor">
<a href="#other-parameter-estimation" class="anchor"></a>Other Parameter Estimation</h3>
<p>We can also plot the posterior 95% credible intervals of each sigma. The <code>"single"</code> sigma model will only produce a single interval given sigma is assumed the same across each source.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_sigma.html">plot_sigma</a></span><span class="op">(</span><span class="va">p</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="Poisson-basic-implementation_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>Similarly the same can be done for the expected population size.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_expected_popsize.html">plot_expected_popsize</a></span><span class="op">(</span><span class="va">p</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="Poisson-basic-implementation_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>With <code><a href="../reference/plot_structure.html">plot_structure()</a></code> we are able to visualise the model's allocation of positive sentinel sites to sources. Each vertical bar represents a sentinel site that captured at least one individual. The proportion of each colour on that bar translates to the probability that sentinel site is associated with a specific source.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_structure.html">plot_structure</a></span><span class="op">(</span><span class="va">p</span>, divide_ind_on <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="Poisson-basic-implementation_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>When <code>K = 1</code> the allocation is trivial, there is only a single source for our observations to be allocated to. Shift to <code>K = 2</code> and we see a clear 40-60 split between sources. On to <code>K = 3</code> and the model starts to get a little confused as to if it should allocate points to group 1 or group 3. If a sentinel site is right in the centre of two overlapping clusters there will be some uncertainty in which source individuals at that sentinel site came from.</p>
<p>It is also possible to map these structural plots using the <code><a href="../reference/overlay_piecharts.html">overlay_piecharts()</a></code> function. Pie charts ore overlain on the positive sentinel sites. The size of the chart represents the number of individuals caught at that location. The fill of the chart then represents the probability this site has been allocated to a particular source synonymously to the structural plots.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">piePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/overlay_spatial_prior.html">overlay_spatial_prior</a></span><span class="op">(</span><span class="va">plot1</span>, 
                                 <span class="va">p</span>, 
                                 col <span class="op">=</span> <span class="st">"red"</span>, 
                                 opacity <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>

<span class="va">piePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/overlay_geoprofile.html">overlay_geoprofile</a></span><span class="op">(</span><span class="va">piePlot</span>, 
                              project <span class="op">=</span> <span class="va">p</span>, 
                              threshold <span class="op">=</span> <span class="fl">0.1</span>, 
                              opacity <span class="op">=</span> <span class="fl">0.8</span>, 
                              K <span class="op">=</span> <span class="fl">2</span>, 
                              col <span class="op">=</span> <span class="va">plasma</span>, 
                              legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">piePlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/overlay_piecharts.html">overlay_piecharts</a></span><span class="op">(</span><span class="va">piePlot</span>, project <span class="op">=</span> <span class="va">p</span>, K <span class="op">=</span> <span class="fl">2</span>, min_size <span class="op">=</span> <span class="fl">10</span>, max_size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">piePlot</span></code></pre></div>
<div id="htmlwidget-6071c514b2ffd31263d5" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6071c514b2ffd31263d5">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAABAElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZOjNnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIzAXsTALGT7m3PwAAAABJRU5ErkJggg==",[[51.555,-0.210000000000012],[51.445,0.00999999999999939]],0.2,null,null,null]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[51.555,-0.210000000000012],[51.445,0.00999999999999939]],0.8,null,null,null]},{"method":"addRectangles","args":[51.445,-0.21,51.555,0.00999999999999998,null,null,{"interactive":true,"className":"","stroke":true,"color":"#333333","weight":2,"opacity":0.5,"fill":false,"fillColor":"#333333","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#F0F921 , #F0F921 0%, #FBA738 20%, #E16562 40%, #B12B90 60%, #6B01A6 80%, #0D0887 100%, #0D0887 "],"labels":["0.00","0.02","0.04","0.06","0.08","0.10"],"na_color":null,"na_label":"NA","opacity":1,"position":"bottomright","type":"numeric","title":"Hit score","extra":{"p_1":0,"p_n":1},"layerId":null,"className":"info legend","group":null}]},{"method":"addMinicharts","args":[[{"dyn":{"width":[23.3333333333333]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0222222222222222,51.45)","lat":51.45,"lng":-0.0222222222222222},"timeSteps":1},{"dyn":{"width":[30]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0222222222222222,51.4611111111111)","lat":51.4611111111111,"lng":-0.0222222222222222},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0444444444444445,51.45)","lat":51.45,"lng":-0.0444444444444445},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0444444444444445,51.4722222222222)","lat":51.4722222222222,"lng":-0.0444444444444445},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.133333333333333,51.4611111111111)","lat":51.4611111111111,"lng":-0.133333333333333},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.133333333333333,51.4722222222222)","lat":51.4722222222222,"lng":-0.133333333333333},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.133333333333333,51.4944444444444)","lat":51.4944444444444,"lng":-0.133333333333333},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.133333333333333,51.5055555555556)","lat":51.5055555555556,"lng":-0.133333333333333},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.155555555555556,51.4611111111111)","lat":51.4611111111111,"lng":-0.155555555555556},"timeSteps":1},{"dyn":{"width":[23.3333333333333]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.155555555555556,51.4722222222222)","lat":51.4722222222222,"lng":-0.155555555555556},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.155555555555556,51.4944444444444)","lat":51.4944444444444,"lng":-0.155555555555556},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.155555555555556,51.5055555555556)","lat":51.5055555555556,"lng":-0.155555555555556},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.177777777777778,51.4722222222222)","lat":51.4722222222222,"lng":-0.177777777777778},"timeSteps":1},{"dyn":{"width":[23.3333333333333]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.177777777777778,51.4833333333333)","lat":51.4833333333333,"lng":-0.177777777777778},"timeSteps":1},{"dyn":{"width":[23.3333333333333]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.177777777777778,51.4944444444444)","lat":51.4944444444444,"lng":-0.177777777777778},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.177777777777778,51.5055555555556)","lat":51.5055555555556,"lng":-0.177777777777778},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.2,51.4833333333333)","lat":51.4833333333333,"lng":-0.2},"timeSteps":1},{"dyn":{"width":[30]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (0,51.45)","lat":51.45,"lng":0},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (0,51.4611111111111)","lat":51.4611111111111,"lng":0},"timeSteps":1}],[[[0,1]],[[0,1]],[[0,1]],[[0,1]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[0,1]],[[0,1]]],1,["#A6CEE3","#1F78B4"],["1"],null,{"showTitle":true,"showValues":true,"labels":["group1","group2"],"supValues":null,"supLabels":[],"html":null,"noPopup":false,"digits":null},null]},{"method":"addLegend","args":[{"colors":["#A6CEE3","#1F78B4"],"labels":["group1","group2"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":null,"extra":null,"layerId":"minichartsLegend","className":"info legend","group":null}]}],"limits":{"lat":[51.445,51.555],"lng":[-0.210000000000012,0.00999999999999998]}},"evals":[],"jsHooks":[]}</script><p>The model-testing metric used consistently through the geographic profiling literature is the hit score. This is calculated by computing the area searched before finding a source divided by the total search area (where a search is defined by starting at the top of the geoprofile and working your way down). Hence a lower hitscore indicates a better performing model. We use <code>get_hitscores</code> to produce these.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_hitscores.html">get_hitscores</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">true_source</span><span class="op">$</span><span class="va">longitude</span>, <span class="va">true_source</span><span class="op">$</span><span class="va">latitude</span><span class="op">)</span>
<span class="va">hs</span></code></pre></div>
<pre><code>##    longitude latitude hs_ringsearch hs_geoprofile_K1 hs_geoprofile_K2
## 1 -0.1675961 51.48465         17.65            32.53             0.39
## 2 -0.0060015 51.45208          8.40            52.81             1.19
##   hs_geoprofile_K3 hs_geoprofile_K4 hs_geoprofile_K5
## 1             1.08             2.91             5.33
## 2             2.34             0.36             0.12</code></pre>
<p>Another common metric to use for this analysis is a gini coefficent from a Lorenz plot.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_lorenz.html">plot_lorenz</a></span><span class="op">(</span><span class="va">hs</span><span class="op">)</span>
<span class="va">plot3</span></code></pre></div>
<p><img src="Poisson-basic-implementation_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>This <code><a href="../reference/plot_lorenz.html">plot_lorenz()</a></code> function returns a graph that describes the number of sources found as a function of area searched. The Gini co-efficent is then calculated as the area under these piecewise curves.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gini.html">gini</a></span><span class="op">(</span><span class="va">hs</span><span class="op">)</span></code></pre></div>
<pre><code>##    hs_ringsearch hs_geoprofile_K1 hs_geoprofile_K2 hs_geoprofile_K3 
##          0.82775          0.41065          0.99015          0.97750 
## hs_geoprofile_K4 hs_geoprofile_K5 
##          0.98185          0.97215</code></pre>
<p>Both the <code><a href="../reference/gini.html">gini()</a></code> and <code><a href="../reference/get_hitscores.html">get_hitscores()</a></code> functions refer to a "ringsearch" strategy. This is used to compare the model to a naive search strategy that requires you to search radially outwards from each positive sentinel site until sources are found. This gives us a bottom line non-trivial search strategy to compare hitscores to.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bob Verity, Michael Stevens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
