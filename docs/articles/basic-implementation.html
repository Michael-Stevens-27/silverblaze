<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial 1: Basic Implementation • silverblaze</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial 1: Basic Implementation">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">silverblaze</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/basic-implementation.html">Tutorial 1: Basic Implementation</a>
    </li>
    <li>
      <a href="../articles/complex-spatial-priors.html">Tutorial 2: Complex Spatial Priors</a>
    </li>
    <li>
      <a href="../articles/model-validation.html">Tutorial 3: Model Validation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Michael-Stevens-27/silverblaze">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="basic-implementation_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="basic-implementation_files/jquery-1.12.4/jquery.min.js"></script><link href="basic-implementation_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="basic-implementation_files/leaflet-1.3.1/leaflet.js"></script><link href="basic-implementation_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="basic-implementation_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="basic-implementation_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="basic-implementation_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="basic-implementation_files/leaflet-binding-2.0.2/leaflet.js"></script><script src="basic-implementation_files/leaflet-providers-1.1.17/leaflet-providers.js"></script><script src="basic-implementation_files/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script><link href="basic-implementation_files/minichart-0.2.2/minicharts.css" rel="stylesheet">
<script src="basic-implementation_files/minichart-0.2.2/leaflet.minicharts.min.js"></script><link href="basic-implementation_files/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial 1: Basic Implementation</h1>
                        <h4 class="author">Michael Stevens</h4>
            
            <h4 class="date">2018-11-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Michael-Stevens-27/silverblaze/blob/master/vignettes/basic-implementation.Rmd"><code>vignettes/basic-implementation.Rmd</code></a></small>
      <div class="hidden name"><code>basic-implementation.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The following tutorial will introduce the user to the general structure required to run silverblaze. The protocol of silverblaze is to create one fundamental object, referred to in these tutorials as <code>p</code>, that describes the entire project. The structure of <code>p</code> consists of:</p>
<ol style="list-style-type: decimal">
<li>The data used to run the model<br>
</li>
<li>The parameter settings for the model<br>
</li>
<li>The output of running the model</li>
</ol>
<p>Following this, the user will learn how to plot and diagnose the output of the model.</p>
</div>
<div id="simulating-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-data" class="anchor"></a>Simulating data</h2>
<p>Before any data simulation happens, we must first define the sentinel site locations for the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sentinal_lon &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.0</span>, <span class="dt">l =</span> <span class="dv">12</span>)
sentinal_lat &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">51.45</span>, <span class="fl">51.55</span>, <span class="dt">l =</span> <span class="dv">12</span>)
sentinal_grid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(sentinal_lon, sentinal_lat)
<span class="kw">names</span>(sentinal_grid) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>)</code></pre></div>
<p>Here we’ve chosen a lattice configuration but the user may define any list of longitude/latitude locations they would like. With these sentinel sites we can generate our data from a given model using <code><a href="../reference/sim_data.html">sim_data()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mysim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_data.html">sim_data</a></span>(sentinal_grid<span class="op">$</span>longitude,
                 sentinal_grid<span class="op">$</span>latitude,
                 <span class="dt">sentinel_radius =</span> <span class="fl">0.25</span>,
                 <span class="dt">K =</span> <span class="dv">2</span>,
                 <span class="dt">sigma_model =</span> <span class="st">"single"</span>,
                 <span class="dt">sigma_mean =</span> <span class="dv">1</span>,
                 <span class="dt">sigma_var =</span> <span class="fl">0.5</span>,
                 <span class="dt">expected_popsize =</span> <span class="dv">300</span>)</code></pre></div>
<p>These parameters describe the underlying behaviour of the data in question:</p>
<ul>
<li>
<code>sentinal_radius</code> describes the overall reach of our sentinel sites.<br>
</li>
<li>
<code>K</code> is the number of sources with which individuals are spatially based.<br>
</li>
<li>
<code>sigma_model</code> defines homogeneity or independence of dispersal across sources.<br>
</li>
<li>
<code>sigma_mean</code> and <code>sigma_var</code> govern the dispersal associated with each source. Set <code>sigma_var = 0</code> to set an explicit dispersal via <code>sigma_mean</code>.<br>
</li>
<li>
<code>expected_popsize</code> tells us how many individuals we expect to see over our search area. The true value is drawn from a Poisson distribution with this expectation.</li>
</ul>
<p>From the simulation we can extract two key objects: the true sources and a record of which individuals were captured and where.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">true_source &lt;-<span class="st"> </span>mysim<span class="op">$</span>record<span class="op">$</span>true_source
data_all &lt;-<span class="st"> </span>mysim<span class="op">$</span>record<span class="op">$</span>data_all</code></pre></div>
<p>We will require these objects for plotting later on.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mysim<span class="op">$</span>data)</code></pre></div>
<pre><code>##    longitude latitude counts
## 1 -0.2000000    51.45      0
## 2 -0.1818182    51.45      0
## 3 -0.1636364    51.45      0
## 4 -0.1454545    51.45      0
## 5 -0.1272727    51.45      0
## 6 -0.1090909    51.45      0</code></pre>
<p>Here we see the general structure of the data required to run the model. That is, a collection of sentinel sites and their respective number of counts. This <code>mysim$data</code> object is the only piece of information required for the user to run the model. All other output from <code>mysim$data</code> is merely a consequence of simulating the data in the first place.</p>
</div>
<div id="creating-a-project" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-project" class="anchor"></a>Creating a project</h2>
<p>We initialise a blank project <code>p</code> using the <code><a href="../reference/rgeoprofile_project.html">rgeoprofile_project()</a></code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rgeoprofile_project.html">rgeoprofile_project</a></span>()</code></pre></div>
<p>We then add in our simulated data using <code><a href="../reference/bind_data.html">bind_data()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_data.html">bind_data</a></span>(p, mysim<span class="op">$</span>data)</code></pre></div>
</div>
<div id="simple-spatial-priors" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-spatial-priors" class="anchor"></a>Simple spatial priors</h2>
<p>We wish to impose a spatial prior on our model. Here we implement some very simple priors, for example instructing the model to restrict the area of interest to to that which contains our sentinel sites. We can produce a uniform spatial prior with <code><a href="../reference/raster_grid.html">raster_grid()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">uniform_prior &lt;-<span class="st"> </span><span class="kw"><a href="../reference/raster_grid.html">raster_grid</a></span>(<span class="dt">range_lon =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.2</span>, <span class="dv">0</span>), <span class="dt">range_lat =</span> <span class="kw">c</span>(<span class="fl">51.45</span>, <span class="fl">51.55</span>),
                             <span class="dt">cells_lon =</span> <span class="dv">100</span>, <span class="dt">cells_lat =</span> <span class="dv">100</span>)</code></pre></div>
<div id="htmlwidget-439443613fb2a2eff22c" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-439443613fb2a2eff22c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAABAElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZOjNnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIzAXsTALGT7m3PwAAAABJRU5ErkJggg==",[[51.55,-0.199999999999988],[51.45,5.10633119642717e-19]],0.2,null,null,null]}],"limits":{"lat":[51.45,51.55],"lng":[-0.199999999999988,5.10633119642717e-19]}},"evals":[],"jsHooks":[]}</script><p>It is also possible to import a shapefile that restricts our search area. The example here relates to a particular London borough.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rgeoprofile_shapefile.html">rgeoprofile_shapefile</a></span>(<span class="st">"London_north"</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: "/home/mstevens/R/x86_64-pc-linux-gnu-library/3.4/silverblaze/extdata/London_north", layer: "boroughs"
## with 8 features
## It has 7 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spatial_prior &lt;-<span class="st"> </span><span class="kw"><a href="../reference/raster_from_shapefile.html">raster_from_shapefile</a></span>(s, <span class="dt">cells_lon =</span> <span class="dv">100</span>, <span class="dt">cells_lat =</span> <span class="dv">100</span>)</code></pre></div>
<div id="htmlwidget-9a271ce4f0c1d2b02630" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-9a271ce4f0c1d2b02630">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHAAAAB+CAYAAAD86pU7AAAC80lEQVR4nO3d3XKrMAxGUdE57//K9CrTHA8G/0iWZPa67KQB/EUiYAIiAAAAAAAAAAAACOYUOU+R03s9REQO7xWI7BPSIXLUAjucx3DLAMvB7hnkkcryDHG7AEcrZaYlEmDhbjDvBusphNr/zu7PCPBLz2B+D1zr/10NNgEqWPWtziLA2vuu8OOx0FKUr+QzvLbBPcDVG14uL/uHx7WFeg/e3fHdzHtqvl/D8nx4h2dpZYjuLRRzCNDAyu7i0kJ3bp9XLFvq8gDfFl5JO8ylAb49vA/NENkHJresAqm+/2lVoVmABPZMI0STFkp467APdKQ0C2KDKmw300rNKtD7Yp+3oIUmZxogVWiPCkzOPECq0BYVmNySAKlCO1RgADPHzMsCpAptUIEBhDwTc4Uq1EcFJsdFTc5muxIVmBwBJkeAyZnuA79vElD+DX9m9oP/Wl50Neg9P3U+RU4OIWw8ttBaxdTulXL3+v7Vw5PHquj9zTpBjRntUGa33kC/kRCHb9kBG70hchiRHAEmR4DJEWByBJhcNUDOnORABSZHgMH0Hn8TYEA9IRJgUK0hEmBgLSESYHANt5GeewOsUTusowKTqBUSASbXdE3MDqxudu6t6XTZJhu6bFvLZWmN39U2vCLA0fO6mo/hsXo2xSu+hWqcmG8ZB83H+7Su8+2XmB3C03KIHKtmaHqWUw2Q8K7dtLL3Prklm7IaPedOX3MYYSHCpDcz8snRQpMjwORuA6SNxvdYgYQY2/YtdPcP4PYBRmJxQp0AkyPAoLgqTWLu/1rXqfV1TafSPr9933VWO7Ml82QeIlbft7txU5lOyix6eCJ601IqGxqpCjOEV7q6o1WrlAHWLhrKGN6sNAG+MZwWoSd0Ce1ZyAAJrl24b6GE1ydUgITXL1SA6KcSIJXjJ1QFRjohkIVagFShj1AVyIegX6gA0U81QCpovTAVSPhj1AMkiLWWPLmlYSUIfZB7CyW8OeaDp3XtBwAAAAAAAAAASOoXY/KkyvIGqyIAAAAASUVORK5CYII=",[[51.5934340910359,-0.269761048903247],[51.4485340910359,0.0259189510967518]],0.2,null,null,null]}],"limits":{"lat":[51.4485340910359,51.5934340910359],"lng":[-0.269761048903247,0.0259189510967518]}},"evals":[],"jsHooks":[]}</script><p>This shapefile is built into the package, any other shapefile should be loaded using the <code>readOGR</code> function from <a href="https://cran.r-project.org/web/packages/rgdal/index.html">rgdal</a>.</p>
</div>
<div id="parameter-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#parameter-sets" class="anchor"></a>Parameter sets</h2>
<p>Next we define the various priors on the vairables we wish to estimate when running the model. We define these parameters via <code><a href="../reference/new_set.html">new_set()</a></code>. Notice the project <code>p</code> is one of the functions arguments. This is such that the parameter set we define is added into our project.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/new_set.html">new_set</a></span>(<span class="dt">project =</span> p,
             <span class="dt">spatial_prior =</span> spatial_prior,
             <span class="dt">sentinel_radius =</span> <span class="fl">0.25</span>,
             <span class="dt">sigma_model =</span> <span class="st">"single"</span>,
             <span class="dt">sigma_prior_mean =</span> <span class="dv">1</span>,
             <span class="dt">sigma_prior_sd =</span> <span class="dv">1</span>,
             <span class="dt">expected_popsize_prior_mean =</span> <span class="dv">200</span>,
             <span class="dt">expected_popsize_prior_sd =</span> <span class="dv">30</span>,
             <span class="dt">name =</span> <span class="st">"Tutorial Parameters"</span>)
p</code></pre></div>
<pre><code>## DATA:
##    sentinel sites = 144 (8 positive, 136 negative)
##    total observations = 39
## 
## PARAMETER SETS:
##  * SET1: Tutorial Parameters
## 
## ACTIVE SET: SET1
##    sentinel radius = 0.25
##    spatial prior:
##       longitude range = [-0.27, 0.026]
##       latitude range = [51.449, 51.593]
##       cells = 112, 126 (lon, lat)
##    sigma prior:
##       model = single
##       prior mean = 1
##       prior SD = 1
##    expected population size prior:
##       prior mean = 200
##       prior SD = 30</code></pre>
<p>The project <code>p</code> is now taking shape as we have defined the data and parameters for the model. Each time the <code><a href="../reference/new_set.html">new_set()</a></code> function is run it will add a new set of parameters to <code>p$parameters_sets</code> and will regard this new set as the <code>active_set</code>. To delete an old parameter set, we use <code><a href="../reference/delete_set.html">delete_set()</a></code>. The <code>"output"</code> object within <code>p</code> is empty right now, but will be populated once the model has run.</p>
</div>
<div id="running-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#running-the-model" class="anchor"></a>Running the model</h2>
<p>We are now ready to run the MCMC algorithm on our data. The arguments in <code><a href="../reference/run_mcmc.html">run_mcmc()</a></code> are similar to many other MCMC implementations. The algorithm will start in the burn-in phase, checking for convergence at each <code>convergence_test</code> iterations and move into the sample phase once the conditions for convergence have been met or the number of burn-in iterations has been reached. The argument <code>K</code> governs how many sources the model should search for. Although we simulated the data, and know the true underlying number of sources, this will rarely be the case with a real-world data set. Hence <code>K</code> can take a single value or a sequence of values. We choose <code>1:4</code> as our data was generated with two sources. The <code>pb_markdown = TRUE</code> argument ensures a neater version of the console output is printed below, this should be removed when run by you.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_mcmc.html">run_mcmc</a></span>(<span class="dt">project =</span> p,
              <span class="dt">K =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,
              <span class="dt">burnin =</span> <span class="fl">1e4</span>,
              <span class="dt">samples =</span> <span class="fl">1e4</span>,
              <span class="dt">converge_test =</span> <span class="fl">1e2</span>,
              <span class="dt">auto_converge =</span> <span class="ot">TRUE</span>,
              <span class="dt">pb_markdown =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Running MCMC for K = 1
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 300 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 0.952109 seconds
## 
## Running MCMC for K = 2
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 1100 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 1.60203 seconds
## 
## Running MCMC for K = 3
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 100 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 2.31707 seconds
## 
## Running MCMC for K = 4
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 1000 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 3.20721 seconds
## 
## Processing results</code></pre>
<pre><code>## Total run-time: 18.78 seconds</code></pre>
<p>An immediate indication that the MCMC is acting sensibly is that the model <code>converged within X iterations</code> for every <code>K</code> value, so the choice of burn-in sufficed. Before plotting any geoprofiles let’s makes sure the MCMC is indeed mixing well.</p>
</div>
<div id="diagnosing-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#diagnosing-the-model" class="anchor"></a>Diagnosing the Model</h2>
<p>Firstly we question the MCMC’s ability by producing diagnostic plots of the log-likelihood. This can be done for each value of <code>K</code> to ensure the algorithm is behaving properly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_loglike_dignostic.html">plot_loglike_dignostic</a></span>(p, <span class="dt">K =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Another useful metric for assessing the MCMC is its effective sampling size (ESS). If we have 10,000 sampling iterations but an ESS of 80 then we really only have 80 samples from the posterior, and so we should run it out for longer.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_ESS.html">get_ESS</a></span>(p, <span class="dt">K =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>##    rung1 
## 947.8542</code></pre>
</div>
<div id="results" class="section level2">
<h2 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h2>
<div id="mapping" class="section level3">
<h3 class="hasAnchor">
<a href="#mapping" class="anchor"></a>Mapping</h3>
<p>Now the model has run, we can start to visualise different aspects of the project. Plotting objects in silverblaze follow a similar structure to <a href="https://rstudio.github.io/leaflet/">Leaflet</a> and <a href="https://ggplot2.tidyverse.org/">ggplot2</a>. We start with a base layer</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_map.html">plot_map</a></span>()</code></pre></div>
<p>and overlay different parts of our project using the set of overlay functions. Lets start with the underlying locations of individuals and their sources.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_points.html">overlay_points</a></span>(plot1, data_all<span class="op">$</span>longitude, data_all<span class="op">$</span>latitude)
plot2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_sources.html">overlay_sources</a></span>(plot1, true_source<span class="op">$</span>longitude, true_source<span class="op">$</span>latitude)
plot2</code></pre></div>
<div id="htmlwidget-8c2fae0373df59a485d4" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-8c2fae0373df59a485d4">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.5156211249065,51.5138451316266,51.5187164291,51.5153321307779,51.5202799968935,51.5103787877307,51.5252524349357,51.5168121134841,51.5223233946736,51.5157125650859,51.5111647290378,51.5162236277258,51.5222716695808,51.5153668832059,51.5271893657842,51.5160408332312,51.5195817521623,51.5151527338868,51.5181437048756,51.5187813817059,51.5165329628457,51.5203212308108,51.5226907924937,51.5147574987848,51.5190671092273,51.5188225501797,51.5097705215272,51.5168042739205,51.5223021992039,51.5207449794004,51.5228267497905,51.5205962727457,51.5142416006765,51.519195973183,51.5137145971386,51.5175145928762,51.5152810045886,51.5165164902786,51.51352195701,51.5161067649318,51.5162897929537,51.5140671601156,51.5159165727414,51.519005268615,51.5193218360385,51.5173453335122,51.5156647787438,51.519881097311,51.5226230281003,51.515214134228,51.5179097407688,51.5165487367211,51.5175075219539,51.5231988689749,51.513149251163,51.5182445587536,51.5150479780041,51.5218427627421,51.5238973693262,51.506389051911,51.5115816948281,51.5102557648747,51.5143650955436,51.5138502835598,51.5168639087508,51.5182269345245,51.5125029558554,51.5062991874736,51.5140771603158,51.5178250772603,51.5164412528221,51.5143369537834,51.5153221914707,51.5203629043574,51.5235187195593,51.5234323667606,51.5165055536017,51.5119177376357,51.5177342012543,51.520448150882,51.5161878226009,51.5140333730173,51.5176228396909,51.5162340836237,51.5104720704174,51.5195204087403,51.520096894334,51.5190219796145,51.515290900217,51.5251638661443,51.5103913232822,51.519676977934,51.5209506384479,51.5158108972732,51.5126594139033,51.5188226350625,51.5120094690712,51.5160151029699,51.516918288555,51.5165361339343,51.5209014703398,51.5168204785461,51.512923309269,51.5195889659832,51.5164426634542,51.5174617672583,51.5227449454764,51.5235141192644,51.5157174937128,51.5140683706182,51.5131535533762,51.5125758635155,51.5175604522308,51.5181897363149,51.5133444943164,51.5159673020184,51.5185732961439,51.5159533170205,51.5175046526201,51.5179689251848,51.5162150075749,51.5165790154106,51.5144374107812,51.5210035840473,51.5148727174143,51.5155258008771,51.5140008783895,51.5205993062128,51.5181519754709,51.515568054615,51.5186017772203,51.5165563423875,51.5155079910515,51.5139614045366,51.5113780394483,51.5211405404603,51.5169763958259,51.5186050250027,51.5165674678831,51.5171884831147,51.5221046531217,51.5168018685953,51.5167134586413,51.5146708053549,51.5150600355543,51.5146524388992,51.5200694911641,51.513526392032,51.5085233683885,51.5196839735776,51.5168523434647,51.5148607040141,51.5180973112281,51.5081939228335,51.513563708812,51.5143940582822,51.5118429999457,51.5199909731596,51.5178553205707,51.5139727328993,51.5118578042223,51.5193099189876,51.5155523627775,51.5106923380396,51.5214080124271,51.5202950362448,51.523434289577,51.5203373258299,51.5206214143861,51.515693581608,51.5181759413343,51.5465432909072,51.5429915312123,51.5439772939628,51.5402497045233,51.5407578391808,51.5437653865909,51.5407222223507,51.5426897964005,51.5464723024811,51.5454547350061,51.5434705221268,51.5489333157669,51.5440977634403,51.5453956972553,51.5491273720873,51.5449484583867,51.5485618856901,51.5401506226302,51.5504093493462,51.5443863574835,51.5494361254243,51.544961757805,51.5430443598931,51.5405475918066,51.5420828918495,51.5443088534271,51.5436745809239,51.5456517707203,51.5435120986239,51.5450068442743,51.5403219207914,51.545361402456,51.5438882077158,51.5468460718053,51.5414005790959,51.5502526323234,51.5462084179718,51.5434830147288,51.5371321121779,51.5410076622533,51.542568995402,51.5444430338586,51.5408825014283,51.546437260123,51.5430321450072,51.5429240355407,51.5432977375122,51.5480889241507,51.5453589887749,51.5504562254761,51.5403960540861,51.5454578683686,51.5403869689951,51.5453828977762,51.5449348658445,51.5404542786506,51.5400858925264,51.5435738396597,51.5467827391658,51.5431401675124,51.5457362867675,51.5457464096396,51.5441652533984,51.5418285342883,51.5409551143823,51.540220330589,51.54225126236,51.5485446836256,51.5487929810536,51.5451326292499,51.5442371416437,51.5500092165453,51.5463724560145,51.5344853071211,51.5459901557791,51.5440018296203,51.5410774484368,51.5465530220511,51.5484539203003,51.5460063981814,51.5426906650633,51.5440007984931,51.5424571138146,51.5403495671911,51.5452474483746,51.5451302013505,51.5414275046297,51.5408415942409,51.5403497689723,51.5466461911585,51.5485316928003,51.5431630298666,51.5461800528919,51.5459372413026,51.5419185559427,51.5447851034905,51.5422741454833,51.5414718711438,51.5415415907798,51.5404314114306,51.5484030819801,51.5378410255849,51.5437322862852,51.5459521541481,51.5410250049082,51.5429841497855,51.5456324644585,51.5444309633892,51.5411958655656,51.5490465759253,51.5434544488315,51.5430538794027,51.5463607668988,51.5451931580743,51.5446596222007,51.5437462674506,51.5429079598066,51.5428932183305,51.5480880701089,51.5509524155829,51.5459343109456,51.5360560249942,51.5395053305943,51.5435030317833,51.5474598188666,51.5466765494508,51.5442608761013,51.541126708246,51.541221750833,51.5468502275728,51.5383657250924,51.5421553542538,51.5524389599361,51.5525010570725,51.5396171249197,51.544527936321,51.540122652201,51.5429492254013,51.5428798983821,51.5451021008736,51.5477710781947,51.5440028618737,51.5515922798854,51.5404863727569,51.5428847022165,51.5441860128499],[-0.139081083826373,-0.136126963193438,-0.130286781846215,-0.139566977395327,-0.141312451483403,-0.134391128960724,-0.134088918742553,-0.131227885843011,-0.134405835641323,-0.139571005447001,-0.133600475140641,-0.128575532284425,-0.144522957487076,-0.131679898907284,-0.136420956850316,-0.130535437508487,-0.129554421364175,-0.126256013002381,-0.1272445726961,-0.13933317533775,-0.139392408589241,-0.132024460033818,-0.127869036181454,-0.122771618671955,-0.139202401869921,-0.136403364039719,-0.131823889724155,-0.130852028755542,-0.138558067595755,-0.13242977261055,-0.13811057799588,-0.132547713554942,-0.134532867182566,-0.136304148129085,-0.13275090767858,-0.131481236073637,-0.137441788261696,-0.129232965684311,-0.137580387921489,-0.135959890283452,-0.13710706038494,-0.145358144836184,-0.128871303005601,-0.132951830262255,-0.136479761458155,-0.129425857785793,-0.12951028912254,-0.125003623592013,-0.133392466737288,-0.125177549031662,-0.145363803440125,-0.133008251937988,-0.13583982229238,-0.137313493613422,-0.147242029236016,-0.13412946934764,-0.13411450213878,-0.136272434450015,-0.142715218408136,-0.136874417938208,-0.133407199060901,-0.139201093325445,-0.122116091733827,-0.134050778839373,-0.137723772874846,-0.135469710856906,-0.130067486847654,-0.140646940068982,-0.129818822278042,-0.137770374531678,-0.135708110225444,-0.134348900580046,-0.138163836138233,-0.138500738578992,-0.136402834898603,-0.134386625722871,-0.146873721269598,-0.139021912743931,-0.127477308322466,-0.127146003726236,-0.136489512975943,-0.141402265787854,-0.139477328604769,-0.12784760035355,-0.131260356340779,-0.133279816381767,-0.131949897659659,-0.138057193741325,-0.140478855813221,-0.133685775573261,-0.135578639556653,-0.13900531199238,-0.126993303389538,-0.134622162846832,-0.131136960702949,-0.142955463673614,-0.136359251884636,-0.132535013391387,-0.139068219576024,-0.137669918329062,-0.136657158635096,-0.13429605519814,-0.147891546048316,-0.141355345984999,-0.130526912672365,-0.134739621215658,-0.143124548495085,-0.136078660529028,-0.138336733350171,-0.126737245478623,-0.132977136249691,-0.132516527850509,-0.131846033500242,-0.133527252183691,-0.133833926046918,-0.136343464557106,-0.147337211832256,-0.131200409166614,-0.133074139392294,-0.135701986233333,-0.128821759366059,-0.135831629269558,-0.141999602339129,-0.134161925308369,-0.133792616283142,-0.13573938555306,-0.13713202065113,-0.13662838898718,-0.134087782395526,-0.131341476416383,-0.141913515058649,-0.136923503406913,-0.131377112794404,-0.137903596119986,-0.132520032777059,-0.130498555040134,-0.132831040542943,-0.129525244791024,-0.125779581153851,-0.127143164810669,-0.147317207321477,-0.134001417609766,-0.136305930950947,-0.131740167882274,-0.132511684130646,-0.134961233073019,-0.127932237879281,-0.125054433293784,-0.130736614396974,-0.142088380201024,-0.128530782486649,-0.120281481912312,-0.144618203224261,-0.131528162279508,-0.141411823639978,-0.134116356219278,-0.135053384399874,-0.13429640485326,-0.139007857045432,-0.13967773739673,-0.122137333687464,-0.144465367539401,-0.129220581512462,-0.132271081889338,-0.137382646391181,-0.128583215861998,-0.132045145946297,-0.133302400758423,-0.136143040240969,-0.147354517314643,-0.134040961401106,-0.175886965663582,-0.180826907329306,-0.173494195600773,-0.16122982128772,-0.17285578015115,-0.164241651790232,-0.171978242922786,-0.165502636873365,-0.169995890129931,-0.172279389450316,-0.167461525343827,-0.180640383254591,-0.15885399204428,-0.165523941057492,-0.166339055284649,-0.16383204937279,-0.16296291036537,-0.165703198724854,-0.171122407079474,-0.177638850060069,-0.165916318403264,-0.177794098322886,-0.17203872477441,-0.173020734076182,-0.170570803535949,-0.172859412169384,-0.17451399174983,-0.160438798091706,-0.177896449027013,-0.157490617883258,-0.177079303757307,-0.163395333100964,-0.169754372704121,-0.171071313045721,-0.160476584293596,-0.159824433105613,-0.172178172151336,-0.17732453242295,-0.149844779406475,-0.173559842021028,-0.177823609656999,-0.161737173729799,-0.184782760685823,-0.170995990569632,-0.178261874449763,-0.17462513944902,-0.174915968182308,-0.167723986065232,-0.165779577325293,-0.164677328382809,-0.172467897341668,-0.177047601304355,-0.167554116998707,-0.165228458478636,-0.165147831289665,-0.166488457256932,-0.163390458684201,-0.174505139290414,-0.171857156504564,-0.170795490191327,-0.167363182307687,-0.178108616434796,-0.164317117826316,-0.18274793328583,-0.175465496289523,-0.182057733039719,-0.185507952509682,-0.174411773149329,-0.180528680320523,-0.181353038182521,-0.17378856558599,-0.171011712196304,-0.161392793953663,-0.172501441733636,-0.1643954424733,-0.176917792062272,-0.170307333891648,-0.167314358929121,-0.177595283184995,-0.171425299430105,-0.178895369057367,-0.171002970232968,-0.168843887448508,-0.17796447243155,-0.177170829540377,-0.166298735544713,-0.171494884328148,-0.169713829508811,-0.169150135492051,-0.164839403550757,-0.171126738639033,-0.167364195643104,-0.173150256378293,-0.17334689740744,-0.17614343063766,-0.171105424330513,-0.180152394194589,-0.166526733840405,-0.178503615637809,-0.177180562257046,-0.163465292992142,-0.171730627412277,-0.166102522537986,-0.168566679717106,-0.179785630441665,-0.172523607086478,-0.168415463512769,-0.167176940318391,-0.16149291503636,-0.160251101055156,-0.174955520590462,-0.171155992621528,-0.160131064548813,-0.168808795416125,-0.177239831682422,-0.161798805234825,-0.175237466879856,-0.177498804462907,-0.174521435728686,-0.174278478588452,-0.173256710718439,-0.164035747740902,-0.17136114842115,-0.179676706361813,-0.165222843730724,-0.169860996125595,-0.168505616771765,-0.184530538923143,-0.167529130894837,-0.175299064994896,-0.171280034689713,-0.167384404499004,-0.16698053913536,-0.173721254521537,-0.170734450270129,-0.178803517225735,-0.178694158093772,-0.169513967801433,-0.171412729621914,-0.17600808390219,-0.174138218843669,-0.176856111277356,-0.171527890281352,-0.168565183662355,-0.165697595729829,-0.168214772411755],1,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.516634912556,51.5442411372904],[-0.134709116630256,-0.171007974399254],{"iconUrl":{"data":"http://simpleicon.com/wp-content/uploads/cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[51.5062991874736,51.5525010570725],"lng":[-0.185507952509682,-0.120281481912312]}},"evals":[],"jsHooks":[]}</script><p>This isn’t too interesting yet, so let’s add to this the spatial prior and the sentinel site locations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_spatial_prior.html">overlay_spatial_prior</a></span>(plot2, p, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">opacity =</span> <span class="fl">0.2</span>)
plot4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_sentinels.html">overlay_sentinels</a></span>(plot3, p, <span class="dt">fill_opacity =</span> <span class="fl">0.9</span>,
                            <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">fill_colour =</span> <span class="kw">c</span>(<span class="kw">grey</span>(<span class="fl">0.7</span>), <span class="st">"red"</span>),
                            <span class="dt">border =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>), <span class="dt">border_colour =</span> <span class="st">"black"</span>, <span class="dt">border_weight =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## getting sentinel radius from active parameter set:</code></pre>
<pre><code>##   sentinal radius = 0.25km</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot4</code></pre></div>
<div id="htmlwidget-cce3e81e35e02543adef" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-cce3e81e35e02543adef">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.5156211249065,51.5138451316266,51.5187164291,51.5153321307779,51.5202799968935,51.5103787877307,51.5252524349357,51.5168121134841,51.5223233946736,51.5157125650859,51.5111647290378,51.5162236277258,51.5222716695808,51.5153668832059,51.5271893657842,51.5160408332312,51.5195817521623,51.5151527338868,51.5181437048756,51.5187813817059,51.5165329628457,51.5203212308108,51.5226907924937,51.5147574987848,51.5190671092273,51.5188225501797,51.5097705215272,51.5168042739205,51.5223021992039,51.5207449794004,51.5228267497905,51.5205962727457,51.5142416006765,51.519195973183,51.5137145971386,51.5175145928762,51.5152810045886,51.5165164902786,51.51352195701,51.5161067649318,51.5162897929537,51.5140671601156,51.5159165727414,51.519005268615,51.5193218360385,51.5173453335122,51.5156647787438,51.519881097311,51.5226230281003,51.515214134228,51.5179097407688,51.5165487367211,51.5175075219539,51.5231988689749,51.513149251163,51.5182445587536,51.5150479780041,51.5218427627421,51.5238973693262,51.506389051911,51.5115816948281,51.5102557648747,51.5143650955436,51.5138502835598,51.5168639087508,51.5182269345245,51.5125029558554,51.5062991874736,51.5140771603158,51.5178250772603,51.5164412528221,51.5143369537834,51.5153221914707,51.5203629043574,51.5235187195593,51.5234323667606,51.5165055536017,51.5119177376357,51.5177342012543,51.520448150882,51.5161878226009,51.5140333730173,51.5176228396909,51.5162340836237,51.5104720704174,51.5195204087403,51.520096894334,51.5190219796145,51.515290900217,51.5251638661443,51.5103913232822,51.519676977934,51.5209506384479,51.5158108972732,51.5126594139033,51.5188226350625,51.5120094690712,51.5160151029699,51.516918288555,51.5165361339343,51.5209014703398,51.5168204785461,51.512923309269,51.5195889659832,51.5164426634542,51.5174617672583,51.5227449454764,51.5235141192644,51.5157174937128,51.5140683706182,51.5131535533762,51.5125758635155,51.5175604522308,51.5181897363149,51.5133444943164,51.5159673020184,51.5185732961439,51.5159533170205,51.5175046526201,51.5179689251848,51.5162150075749,51.5165790154106,51.5144374107812,51.5210035840473,51.5148727174143,51.5155258008771,51.5140008783895,51.5205993062128,51.5181519754709,51.515568054615,51.5186017772203,51.5165563423875,51.5155079910515,51.5139614045366,51.5113780394483,51.5211405404603,51.5169763958259,51.5186050250027,51.5165674678831,51.5171884831147,51.5221046531217,51.5168018685953,51.5167134586413,51.5146708053549,51.5150600355543,51.5146524388992,51.5200694911641,51.513526392032,51.5085233683885,51.5196839735776,51.5168523434647,51.5148607040141,51.5180973112281,51.5081939228335,51.513563708812,51.5143940582822,51.5118429999457,51.5199909731596,51.5178553205707,51.5139727328993,51.5118578042223,51.5193099189876,51.5155523627775,51.5106923380396,51.5214080124271,51.5202950362448,51.523434289577,51.5203373258299,51.5206214143861,51.515693581608,51.5181759413343,51.5465432909072,51.5429915312123,51.5439772939628,51.5402497045233,51.5407578391808,51.5437653865909,51.5407222223507,51.5426897964005,51.5464723024811,51.5454547350061,51.5434705221268,51.5489333157669,51.5440977634403,51.5453956972553,51.5491273720873,51.5449484583867,51.5485618856901,51.5401506226302,51.5504093493462,51.5443863574835,51.5494361254243,51.544961757805,51.5430443598931,51.5405475918066,51.5420828918495,51.5443088534271,51.5436745809239,51.5456517707203,51.5435120986239,51.5450068442743,51.5403219207914,51.545361402456,51.5438882077158,51.5468460718053,51.5414005790959,51.5502526323234,51.5462084179718,51.5434830147288,51.5371321121779,51.5410076622533,51.542568995402,51.5444430338586,51.5408825014283,51.546437260123,51.5430321450072,51.5429240355407,51.5432977375122,51.5480889241507,51.5453589887749,51.5504562254761,51.5403960540861,51.5454578683686,51.5403869689951,51.5453828977762,51.5449348658445,51.5404542786506,51.5400858925264,51.5435738396597,51.5467827391658,51.5431401675124,51.5457362867675,51.5457464096396,51.5441652533984,51.5418285342883,51.5409551143823,51.540220330589,51.54225126236,51.5485446836256,51.5487929810536,51.5451326292499,51.5442371416437,51.5500092165453,51.5463724560145,51.5344853071211,51.5459901557791,51.5440018296203,51.5410774484368,51.5465530220511,51.5484539203003,51.5460063981814,51.5426906650633,51.5440007984931,51.5424571138146,51.5403495671911,51.5452474483746,51.5451302013505,51.5414275046297,51.5408415942409,51.5403497689723,51.5466461911585,51.5485316928003,51.5431630298666,51.5461800528919,51.5459372413026,51.5419185559427,51.5447851034905,51.5422741454833,51.5414718711438,51.5415415907798,51.5404314114306,51.5484030819801,51.5378410255849,51.5437322862852,51.5459521541481,51.5410250049082,51.5429841497855,51.5456324644585,51.5444309633892,51.5411958655656,51.5490465759253,51.5434544488315,51.5430538794027,51.5463607668988,51.5451931580743,51.5446596222007,51.5437462674506,51.5429079598066,51.5428932183305,51.5480880701089,51.5509524155829,51.5459343109456,51.5360560249942,51.5395053305943,51.5435030317833,51.5474598188666,51.5466765494508,51.5442608761013,51.541126708246,51.541221750833,51.5468502275728,51.5383657250924,51.5421553542538,51.5524389599361,51.5525010570725,51.5396171249197,51.544527936321,51.540122652201,51.5429492254013,51.5428798983821,51.5451021008736,51.5477710781947,51.5440028618737,51.5515922798854,51.5404863727569,51.5428847022165,51.5441860128499],[-0.139081083826373,-0.136126963193438,-0.130286781846215,-0.139566977395327,-0.141312451483403,-0.134391128960724,-0.134088918742553,-0.131227885843011,-0.134405835641323,-0.139571005447001,-0.133600475140641,-0.128575532284425,-0.144522957487076,-0.131679898907284,-0.136420956850316,-0.130535437508487,-0.129554421364175,-0.126256013002381,-0.1272445726961,-0.13933317533775,-0.139392408589241,-0.132024460033818,-0.127869036181454,-0.122771618671955,-0.139202401869921,-0.136403364039719,-0.131823889724155,-0.130852028755542,-0.138558067595755,-0.13242977261055,-0.13811057799588,-0.132547713554942,-0.134532867182566,-0.136304148129085,-0.13275090767858,-0.131481236073637,-0.137441788261696,-0.129232965684311,-0.137580387921489,-0.135959890283452,-0.13710706038494,-0.145358144836184,-0.128871303005601,-0.132951830262255,-0.136479761458155,-0.129425857785793,-0.12951028912254,-0.125003623592013,-0.133392466737288,-0.125177549031662,-0.145363803440125,-0.133008251937988,-0.13583982229238,-0.137313493613422,-0.147242029236016,-0.13412946934764,-0.13411450213878,-0.136272434450015,-0.142715218408136,-0.136874417938208,-0.133407199060901,-0.139201093325445,-0.122116091733827,-0.134050778839373,-0.137723772874846,-0.135469710856906,-0.130067486847654,-0.140646940068982,-0.129818822278042,-0.137770374531678,-0.135708110225444,-0.134348900580046,-0.138163836138233,-0.138500738578992,-0.136402834898603,-0.134386625722871,-0.146873721269598,-0.139021912743931,-0.127477308322466,-0.127146003726236,-0.136489512975943,-0.141402265787854,-0.139477328604769,-0.12784760035355,-0.131260356340779,-0.133279816381767,-0.131949897659659,-0.138057193741325,-0.140478855813221,-0.133685775573261,-0.135578639556653,-0.13900531199238,-0.126993303389538,-0.134622162846832,-0.131136960702949,-0.142955463673614,-0.136359251884636,-0.132535013391387,-0.139068219576024,-0.137669918329062,-0.136657158635096,-0.13429605519814,-0.147891546048316,-0.141355345984999,-0.130526912672365,-0.134739621215658,-0.143124548495085,-0.136078660529028,-0.138336733350171,-0.126737245478623,-0.132977136249691,-0.132516527850509,-0.131846033500242,-0.133527252183691,-0.133833926046918,-0.136343464557106,-0.147337211832256,-0.131200409166614,-0.133074139392294,-0.135701986233333,-0.128821759366059,-0.135831629269558,-0.141999602339129,-0.134161925308369,-0.133792616283142,-0.13573938555306,-0.13713202065113,-0.13662838898718,-0.134087782395526,-0.131341476416383,-0.141913515058649,-0.136923503406913,-0.131377112794404,-0.137903596119986,-0.132520032777059,-0.130498555040134,-0.132831040542943,-0.129525244791024,-0.125779581153851,-0.127143164810669,-0.147317207321477,-0.134001417609766,-0.136305930950947,-0.131740167882274,-0.132511684130646,-0.134961233073019,-0.127932237879281,-0.125054433293784,-0.130736614396974,-0.142088380201024,-0.128530782486649,-0.120281481912312,-0.144618203224261,-0.131528162279508,-0.141411823639978,-0.134116356219278,-0.135053384399874,-0.13429640485326,-0.139007857045432,-0.13967773739673,-0.122137333687464,-0.144465367539401,-0.129220581512462,-0.132271081889338,-0.137382646391181,-0.128583215861998,-0.132045145946297,-0.133302400758423,-0.136143040240969,-0.147354517314643,-0.134040961401106,-0.175886965663582,-0.180826907329306,-0.173494195600773,-0.16122982128772,-0.17285578015115,-0.164241651790232,-0.171978242922786,-0.165502636873365,-0.169995890129931,-0.172279389450316,-0.167461525343827,-0.180640383254591,-0.15885399204428,-0.165523941057492,-0.166339055284649,-0.16383204937279,-0.16296291036537,-0.165703198724854,-0.171122407079474,-0.177638850060069,-0.165916318403264,-0.177794098322886,-0.17203872477441,-0.173020734076182,-0.170570803535949,-0.172859412169384,-0.17451399174983,-0.160438798091706,-0.177896449027013,-0.157490617883258,-0.177079303757307,-0.163395333100964,-0.169754372704121,-0.171071313045721,-0.160476584293596,-0.159824433105613,-0.172178172151336,-0.17732453242295,-0.149844779406475,-0.173559842021028,-0.177823609656999,-0.161737173729799,-0.184782760685823,-0.170995990569632,-0.178261874449763,-0.17462513944902,-0.174915968182308,-0.167723986065232,-0.165779577325293,-0.164677328382809,-0.172467897341668,-0.177047601304355,-0.167554116998707,-0.165228458478636,-0.165147831289665,-0.166488457256932,-0.163390458684201,-0.174505139290414,-0.171857156504564,-0.170795490191327,-0.167363182307687,-0.178108616434796,-0.164317117826316,-0.18274793328583,-0.175465496289523,-0.182057733039719,-0.185507952509682,-0.174411773149329,-0.180528680320523,-0.181353038182521,-0.17378856558599,-0.171011712196304,-0.161392793953663,-0.172501441733636,-0.1643954424733,-0.176917792062272,-0.170307333891648,-0.167314358929121,-0.177595283184995,-0.171425299430105,-0.178895369057367,-0.171002970232968,-0.168843887448508,-0.17796447243155,-0.177170829540377,-0.166298735544713,-0.171494884328148,-0.169713829508811,-0.169150135492051,-0.164839403550757,-0.171126738639033,-0.167364195643104,-0.173150256378293,-0.17334689740744,-0.17614343063766,-0.171105424330513,-0.180152394194589,-0.166526733840405,-0.178503615637809,-0.177180562257046,-0.163465292992142,-0.171730627412277,-0.166102522537986,-0.168566679717106,-0.179785630441665,-0.172523607086478,-0.168415463512769,-0.167176940318391,-0.16149291503636,-0.160251101055156,-0.174955520590462,-0.171155992621528,-0.160131064548813,-0.168808795416125,-0.177239831682422,-0.161798805234825,-0.175237466879856,-0.177498804462907,-0.174521435728686,-0.174278478588452,-0.173256710718439,-0.164035747740902,-0.17136114842115,-0.179676706361813,-0.165222843730724,-0.169860996125595,-0.168505616771765,-0.184530538923143,-0.167529130894837,-0.175299064994896,-0.171280034689713,-0.167384404499004,-0.16698053913536,-0.173721254521537,-0.170734450270129,-0.178803517225735,-0.178694158093772,-0.169513967801433,-0.171412729621914,-0.17600808390219,-0.174138218843669,-0.176856111277356,-0.171527890281352,-0.168565183662355,-0.165697595729829,-0.168214772411755],1,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.516634912556,51.5442411372904],[-0.134709116630256,-0.171007974399254],{"iconUrl":{"data":"http://simpleicon.com/wp-content/uploads/cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHAAAAB+CAYAAAD86pU7AAAC80lEQVR4nO3d3XKrMAxGUdE57//K9CrTHA8G/0iWZPa67KQB/EUiYAIiAAAAAAAAAAAACOYUOU+R03s9REQO7xWI7BPSIXLUAjucx3DLAMvB7hnkkcryDHG7AEcrZaYlEmDhbjDvBusphNr/zu7PCPBLz2B+D1zr/10NNgEqWPWtziLA2vuu8OOx0FKUr+QzvLbBPcDVG14uL/uHx7WFeg/e3fHdzHtqvl/D8nx4h2dpZYjuLRRzCNDAyu7i0kJ3bp9XLFvq8gDfFl5JO8ylAb49vA/NENkHJresAqm+/2lVoVmABPZMI0STFkp467APdKQ0C2KDKmw300rNKtD7Yp+3oIUmZxogVWiPCkzOPECq0BYVmNySAKlCO1RgADPHzMsCpAptUIEBhDwTc4Uq1EcFJsdFTc5muxIVmBwBJkeAyZnuA79vElD+DX9m9oP/Wl50Neg9P3U+RU4OIWw8ttBaxdTulXL3+v7Vw5PHquj9zTpBjRntUGa33kC/kRCHb9kBG70hchiRHAEmR4DJEWByBJhcNUDOnORABSZHgMH0Hn8TYEA9IRJgUK0hEmBgLSESYHANt5GeewOsUTusowKTqBUSASbXdE3MDqxudu6t6XTZJhu6bFvLZWmN39U2vCLA0fO6mo/hsXo2xSu+hWqcmG8ZB83H+7Su8+2XmB3C03KIHKtmaHqWUw2Q8K7dtLL3Prklm7IaPedOX3MYYSHCpDcz8snRQpMjwORuA6SNxvdYgYQY2/YtdPcP4PYBRmJxQp0AkyPAoLgqTWLu/1rXqfV1TafSPr9933VWO7Ml82QeIlbft7txU5lOyix6eCJ601IqGxqpCjOEV7q6o1WrlAHWLhrKGN6sNAG+MZwWoSd0Ce1ZyAAJrl24b6GE1ydUgITXL1SA6KcSIJXjJ1QFRjohkIVagFShj1AVyIegX6gA0U81QCpovTAVSPhj1AMkiLWWPLmlYSUIfZB7CyW8OeaDp3XtBwAAAAAAAAAASOoXY/KkyvIGqyIAAAAASUVORK5CYII=",[[51.5934340910359,-0.269761048903247],[51.4485340910359,0.0259189510967518]],0.2,null,null,null]},{"method":"addCircles","args":[[51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55],[-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0],250,null,null,{"interactive":true,"className":"","stroke":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false],"color":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"weight":0.5,"opacity":1,"fill":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"fillColor":["#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3"],"fillOpacity":0.9},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"limits":{"lat":[51.4485340910359,51.5934340910359],"lng":[-0.269761048903247,0.0259189510967518]}},"evals":[],"jsHooks":[]}</script><p>Finally, we add in the geoprofile produced by running the MCMC.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot5 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_geoprofile.html">overlay_geoprofile</a></span>(plot4, p, <span class="dt">threshold =</span> <span class="fl">0.1</span>, <span class="dt">opacity =</span> <span class="fl">0.8</span>, <span class="dt">K =</span> <span class="dv">2</span>)
plot5</code></pre></div>
<div id="htmlwidget-94279cb99f5c51a9d1fa" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-94279cb99f5c51a9d1fa">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.5156211249065,51.5138451316266,51.5187164291,51.5153321307779,51.5202799968935,51.5103787877307,51.5252524349357,51.5168121134841,51.5223233946736,51.5157125650859,51.5111647290378,51.5162236277258,51.5222716695808,51.5153668832059,51.5271893657842,51.5160408332312,51.5195817521623,51.5151527338868,51.5181437048756,51.5187813817059,51.5165329628457,51.5203212308108,51.5226907924937,51.5147574987848,51.5190671092273,51.5188225501797,51.5097705215272,51.5168042739205,51.5223021992039,51.5207449794004,51.5228267497905,51.5205962727457,51.5142416006765,51.519195973183,51.5137145971386,51.5175145928762,51.5152810045886,51.5165164902786,51.51352195701,51.5161067649318,51.5162897929537,51.5140671601156,51.5159165727414,51.519005268615,51.5193218360385,51.5173453335122,51.5156647787438,51.519881097311,51.5226230281003,51.515214134228,51.5179097407688,51.5165487367211,51.5175075219539,51.5231988689749,51.513149251163,51.5182445587536,51.5150479780041,51.5218427627421,51.5238973693262,51.506389051911,51.5115816948281,51.5102557648747,51.5143650955436,51.5138502835598,51.5168639087508,51.5182269345245,51.5125029558554,51.5062991874736,51.5140771603158,51.5178250772603,51.5164412528221,51.5143369537834,51.5153221914707,51.5203629043574,51.5235187195593,51.5234323667606,51.5165055536017,51.5119177376357,51.5177342012543,51.520448150882,51.5161878226009,51.5140333730173,51.5176228396909,51.5162340836237,51.5104720704174,51.5195204087403,51.520096894334,51.5190219796145,51.515290900217,51.5251638661443,51.5103913232822,51.519676977934,51.5209506384479,51.5158108972732,51.5126594139033,51.5188226350625,51.5120094690712,51.5160151029699,51.516918288555,51.5165361339343,51.5209014703398,51.5168204785461,51.512923309269,51.5195889659832,51.5164426634542,51.5174617672583,51.5227449454764,51.5235141192644,51.5157174937128,51.5140683706182,51.5131535533762,51.5125758635155,51.5175604522308,51.5181897363149,51.5133444943164,51.5159673020184,51.5185732961439,51.5159533170205,51.5175046526201,51.5179689251848,51.5162150075749,51.5165790154106,51.5144374107812,51.5210035840473,51.5148727174143,51.5155258008771,51.5140008783895,51.5205993062128,51.5181519754709,51.515568054615,51.5186017772203,51.5165563423875,51.5155079910515,51.5139614045366,51.5113780394483,51.5211405404603,51.5169763958259,51.5186050250027,51.5165674678831,51.5171884831147,51.5221046531217,51.5168018685953,51.5167134586413,51.5146708053549,51.5150600355543,51.5146524388992,51.5200694911641,51.513526392032,51.5085233683885,51.5196839735776,51.5168523434647,51.5148607040141,51.5180973112281,51.5081939228335,51.513563708812,51.5143940582822,51.5118429999457,51.5199909731596,51.5178553205707,51.5139727328993,51.5118578042223,51.5193099189876,51.5155523627775,51.5106923380396,51.5214080124271,51.5202950362448,51.523434289577,51.5203373258299,51.5206214143861,51.515693581608,51.5181759413343,51.5465432909072,51.5429915312123,51.5439772939628,51.5402497045233,51.5407578391808,51.5437653865909,51.5407222223507,51.5426897964005,51.5464723024811,51.5454547350061,51.5434705221268,51.5489333157669,51.5440977634403,51.5453956972553,51.5491273720873,51.5449484583867,51.5485618856901,51.5401506226302,51.5504093493462,51.5443863574835,51.5494361254243,51.544961757805,51.5430443598931,51.5405475918066,51.5420828918495,51.5443088534271,51.5436745809239,51.5456517707203,51.5435120986239,51.5450068442743,51.5403219207914,51.545361402456,51.5438882077158,51.5468460718053,51.5414005790959,51.5502526323234,51.5462084179718,51.5434830147288,51.5371321121779,51.5410076622533,51.542568995402,51.5444430338586,51.5408825014283,51.546437260123,51.5430321450072,51.5429240355407,51.5432977375122,51.5480889241507,51.5453589887749,51.5504562254761,51.5403960540861,51.5454578683686,51.5403869689951,51.5453828977762,51.5449348658445,51.5404542786506,51.5400858925264,51.5435738396597,51.5467827391658,51.5431401675124,51.5457362867675,51.5457464096396,51.5441652533984,51.5418285342883,51.5409551143823,51.540220330589,51.54225126236,51.5485446836256,51.5487929810536,51.5451326292499,51.5442371416437,51.5500092165453,51.5463724560145,51.5344853071211,51.5459901557791,51.5440018296203,51.5410774484368,51.5465530220511,51.5484539203003,51.5460063981814,51.5426906650633,51.5440007984931,51.5424571138146,51.5403495671911,51.5452474483746,51.5451302013505,51.5414275046297,51.5408415942409,51.5403497689723,51.5466461911585,51.5485316928003,51.5431630298666,51.5461800528919,51.5459372413026,51.5419185559427,51.5447851034905,51.5422741454833,51.5414718711438,51.5415415907798,51.5404314114306,51.5484030819801,51.5378410255849,51.5437322862852,51.5459521541481,51.5410250049082,51.5429841497855,51.5456324644585,51.5444309633892,51.5411958655656,51.5490465759253,51.5434544488315,51.5430538794027,51.5463607668988,51.5451931580743,51.5446596222007,51.5437462674506,51.5429079598066,51.5428932183305,51.5480880701089,51.5509524155829,51.5459343109456,51.5360560249942,51.5395053305943,51.5435030317833,51.5474598188666,51.5466765494508,51.5442608761013,51.541126708246,51.541221750833,51.5468502275728,51.5383657250924,51.5421553542538,51.5524389599361,51.5525010570725,51.5396171249197,51.544527936321,51.540122652201,51.5429492254013,51.5428798983821,51.5451021008736,51.5477710781947,51.5440028618737,51.5515922798854,51.5404863727569,51.5428847022165,51.5441860128499],[-0.139081083826373,-0.136126963193438,-0.130286781846215,-0.139566977395327,-0.141312451483403,-0.134391128960724,-0.134088918742553,-0.131227885843011,-0.134405835641323,-0.139571005447001,-0.133600475140641,-0.128575532284425,-0.144522957487076,-0.131679898907284,-0.136420956850316,-0.130535437508487,-0.129554421364175,-0.126256013002381,-0.1272445726961,-0.13933317533775,-0.139392408589241,-0.132024460033818,-0.127869036181454,-0.122771618671955,-0.139202401869921,-0.136403364039719,-0.131823889724155,-0.130852028755542,-0.138558067595755,-0.13242977261055,-0.13811057799588,-0.132547713554942,-0.134532867182566,-0.136304148129085,-0.13275090767858,-0.131481236073637,-0.137441788261696,-0.129232965684311,-0.137580387921489,-0.135959890283452,-0.13710706038494,-0.145358144836184,-0.128871303005601,-0.132951830262255,-0.136479761458155,-0.129425857785793,-0.12951028912254,-0.125003623592013,-0.133392466737288,-0.125177549031662,-0.145363803440125,-0.133008251937988,-0.13583982229238,-0.137313493613422,-0.147242029236016,-0.13412946934764,-0.13411450213878,-0.136272434450015,-0.142715218408136,-0.136874417938208,-0.133407199060901,-0.139201093325445,-0.122116091733827,-0.134050778839373,-0.137723772874846,-0.135469710856906,-0.130067486847654,-0.140646940068982,-0.129818822278042,-0.137770374531678,-0.135708110225444,-0.134348900580046,-0.138163836138233,-0.138500738578992,-0.136402834898603,-0.134386625722871,-0.146873721269598,-0.139021912743931,-0.127477308322466,-0.127146003726236,-0.136489512975943,-0.141402265787854,-0.139477328604769,-0.12784760035355,-0.131260356340779,-0.133279816381767,-0.131949897659659,-0.138057193741325,-0.140478855813221,-0.133685775573261,-0.135578639556653,-0.13900531199238,-0.126993303389538,-0.134622162846832,-0.131136960702949,-0.142955463673614,-0.136359251884636,-0.132535013391387,-0.139068219576024,-0.137669918329062,-0.136657158635096,-0.13429605519814,-0.147891546048316,-0.141355345984999,-0.130526912672365,-0.134739621215658,-0.143124548495085,-0.136078660529028,-0.138336733350171,-0.126737245478623,-0.132977136249691,-0.132516527850509,-0.131846033500242,-0.133527252183691,-0.133833926046918,-0.136343464557106,-0.147337211832256,-0.131200409166614,-0.133074139392294,-0.135701986233333,-0.128821759366059,-0.135831629269558,-0.141999602339129,-0.134161925308369,-0.133792616283142,-0.13573938555306,-0.13713202065113,-0.13662838898718,-0.134087782395526,-0.131341476416383,-0.141913515058649,-0.136923503406913,-0.131377112794404,-0.137903596119986,-0.132520032777059,-0.130498555040134,-0.132831040542943,-0.129525244791024,-0.125779581153851,-0.127143164810669,-0.147317207321477,-0.134001417609766,-0.136305930950947,-0.131740167882274,-0.132511684130646,-0.134961233073019,-0.127932237879281,-0.125054433293784,-0.130736614396974,-0.142088380201024,-0.128530782486649,-0.120281481912312,-0.144618203224261,-0.131528162279508,-0.141411823639978,-0.134116356219278,-0.135053384399874,-0.13429640485326,-0.139007857045432,-0.13967773739673,-0.122137333687464,-0.144465367539401,-0.129220581512462,-0.132271081889338,-0.137382646391181,-0.128583215861998,-0.132045145946297,-0.133302400758423,-0.136143040240969,-0.147354517314643,-0.134040961401106,-0.175886965663582,-0.180826907329306,-0.173494195600773,-0.16122982128772,-0.17285578015115,-0.164241651790232,-0.171978242922786,-0.165502636873365,-0.169995890129931,-0.172279389450316,-0.167461525343827,-0.180640383254591,-0.15885399204428,-0.165523941057492,-0.166339055284649,-0.16383204937279,-0.16296291036537,-0.165703198724854,-0.171122407079474,-0.177638850060069,-0.165916318403264,-0.177794098322886,-0.17203872477441,-0.173020734076182,-0.170570803535949,-0.172859412169384,-0.17451399174983,-0.160438798091706,-0.177896449027013,-0.157490617883258,-0.177079303757307,-0.163395333100964,-0.169754372704121,-0.171071313045721,-0.160476584293596,-0.159824433105613,-0.172178172151336,-0.17732453242295,-0.149844779406475,-0.173559842021028,-0.177823609656999,-0.161737173729799,-0.184782760685823,-0.170995990569632,-0.178261874449763,-0.17462513944902,-0.174915968182308,-0.167723986065232,-0.165779577325293,-0.164677328382809,-0.172467897341668,-0.177047601304355,-0.167554116998707,-0.165228458478636,-0.165147831289665,-0.166488457256932,-0.163390458684201,-0.174505139290414,-0.171857156504564,-0.170795490191327,-0.167363182307687,-0.178108616434796,-0.164317117826316,-0.18274793328583,-0.175465496289523,-0.182057733039719,-0.185507952509682,-0.174411773149329,-0.180528680320523,-0.181353038182521,-0.17378856558599,-0.171011712196304,-0.161392793953663,-0.172501441733636,-0.1643954424733,-0.176917792062272,-0.170307333891648,-0.167314358929121,-0.177595283184995,-0.171425299430105,-0.178895369057367,-0.171002970232968,-0.168843887448508,-0.17796447243155,-0.177170829540377,-0.166298735544713,-0.171494884328148,-0.169713829508811,-0.169150135492051,-0.164839403550757,-0.171126738639033,-0.167364195643104,-0.173150256378293,-0.17334689740744,-0.17614343063766,-0.171105424330513,-0.180152394194589,-0.166526733840405,-0.178503615637809,-0.177180562257046,-0.163465292992142,-0.171730627412277,-0.166102522537986,-0.168566679717106,-0.179785630441665,-0.172523607086478,-0.168415463512769,-0.167176940318391,-0.16149291503636,-0.160251101055156,-0.174955520590462,-0.171155992621528,-0.160131064548813,-0.168808795416125,-0.177239831682422,-0.161798805234825,-0.175237466879856,-0.177498804462907,-0.174521435728686,-0.174278478588452,-0.173256710718439,-0.164035747740902,-0.17136114842115,-0.179676706361813,-0.165222843730724,-0.169860996125595,-0.168505616771765,-0.184530538923143,-0.167529130894837,-0.175299064994896,-0.171280034689713,-0.167384404499004,-0.16698053913536,-0.173721254521537,-0.170734450270129,-0.178803517225735,-0.178694158093772,-0.169513967801433,-0.171412729621914,-0.17600808390219,-0.174138218843669,-0.176856111277356,-0.171527890281352,-0.168565183662355,-0.165697595729829,-0.168214772411755],1,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.516634912556,51.5442411372904],[-0.134709116630256,-0.171007974399254],{"iconUrl":{"data":"http://simpleicon.com/wp-content/uploads/cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHAAAAB+CAYAAAD86pU7AAAC80lEQVR4nO3d3XKrMAxGUdE57//K9CrTHA8G/0iWZPa67KQB/EUiYAIiAAAAAAAAAAAACOYUOU+R03s9REQO7xWI7BPSIXLUAjucx3DLAMvB7hnkkcryDHG7AEcrZaYlEmDhbjDvBusphNr/zu7PCPBLz2B+D1zr/10NNgEqWPWtziLA2vuu8OOx0FKUr+QzvLbBPcDVG14uL/uHx7WFeg/e3fHdzHtqvl/D8nx4h2dpZYjuLRRzCNDAyu7i0kJ3bp9XLFvq8gDfFl5JO8ylAb49vA/NENkHJresAqm+/2lVoVmABPZMI0STFkp467APdKQ0C2KDKmw300rNKtD7Yp+3oIUmZxogVWiPCkzOPECq0BYVmNySAKlCO1RgADPHzMsCpAptUIEBhDwTc4Uq1EcFJsdFTc5muxIVmBwBJkeAyZnuA79vElD+DX9m9oP/Wl50Neg9P3U+RU4OIWw8ttBaxdTulXL3+v7Vw5PHquj9zTpBjRntUGa33kC/kRCHb9kBG70hchiRHAEmR4DJEWByBJhcNUDOnORABSZHgMH0Hn8TYEA9IRJgUK0hEmBgLSESYHANt5GeewOsUTusowKTqBUSASbXdE3MDqxudu6t6XTZJhu6bFvLZWmN39U2vCLA0fO6mo/hsXo2xSu+hWqcmG8ZB83H+7Su8+2XmB3C03KIHKtmaHqWUw2Q8K7dtLL3Prklm7IaPedOX3MYYSHCpDcz8snRQpMjwORuA6SNxvdYgYQY2/YtdPcP4PYBRmJxQp0AkyPAoLgqTWLu/1rXqfV1TafSPr9933VWO7Ml82QeIlbft7txU5lOyix6eCJ601IqGxqpCjOEV7q6o1WrlAHWLhrKGN6sNAG+MZwWoSd0Ce1ZyAAJrl24b6GE1ydUgITXL1SA6KcSIJXjJ1QFRjohkIVagFShj1AVyIegX6gA0U81QCpovTAVSPhj1AMkiLWWPLmlYSUIfZB7CyW8OeaDp3XtBwAAAAAAAAAASOoXY/KkyvIGqyIAAAAASUVORK5CYII=",[[51.5934340910359,-0.269761048903247],[51.4485340910359,0.0259189510967518]],0.2,null,null,null]},{"method":"addCircles","args":[[51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55],[-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0],250,null,null,{"interactive":true,"className":"","stroke":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false],"color":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"weight":0.5,"opacity":1,"fill":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"fillColor":["#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3"],"fillOpacity":0.9},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[51.5934340910359,-0.269761048903247],[51.4485340910359,0.0259189510967518]],0.8,null,null,null]},{"method":"addRectangles","args":[51.4485340910359,-0.269761048903242,51.5934340910359,0.025918951096758,null,null,{"interactive":true,"className":"","stroke":true,"color":"#333333","weight":2,"opacity":0.5,"fill":false,"fillColor":"#333333","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[51.4485340910359,51.5934340910359],"lng":[-0.269761048903247,0.025918951096758]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="other-parameter-estimation" class="section level3">
<h3 class="hasAnchor">
<a href="#other-parameter-estimation" class="anchor"></a>Other Parameter Estimation</h3>
<p>We can also plot the posterior 95% credible intervals of each sigma. The <code>"single"</code> model will produce intervals for each source, this requires updating (TODO).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_sigma.html">plot_sigma</a></span>(p, <span class="dt">K =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_segment).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Similarly the same can be done for the expected population size.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_expected_popsize.html">plot_expected_popsize</a></span>(p, <span class="dt">K =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>With <code><a href="../reference/plot_structure.html">plot_structure()</a></code> we are able to visualise the model’s allocation of positive sentinel sites to sources. Each vertical bar represents a sentinel site that captured at least one individual. The proportion of each colour on that bar translates to the probability that sentinel site is associated with a specific source.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_structure.html">plot_structure</a></span>(p, <span class="dt">divide_ind_on =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>When <code>K = 1</code> the allocation is trivial, there is only a single source for our observations to be allocated to. Shift to <code>K = 2</code> and we see a clear XX-XX split between sources. The case of <code>K = 3</code> is curious. We know for sure that there are two true sources, but the model is displaying its attempt to fit three by splitting a source in two. Let’s take a look at how this compares to the true allocation from the simulated data (NOTE: colour mismatches may have occurred).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mysim<span class="op">$</span>record<span class="op">$</span>true_qmatrix)</code></pre></div>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>It is also possible to map these structural plots using the <code><a href="../reference/overlay_piecharts.html">overlay_piecharts()</a></code> function. Pie charts ore overlain on the positive sentinel sites. The size of the chart represents the number of individuals caught at that location. The fill of the chart then represents the probability this site has been allocated to a particular source synonymously to the structural plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">piePlot &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_piecharts.html">overlay_piecharts</a></span>(plot5, <span class="dt">project =</span> p, <span class="dt">K =</span> <span class="dv">2</span>, <span class="dt">min_size =</span> <span class="dv">10</span>, <span class="dt">max_size =</span> <span class="dv">30</span>)
piePlot</code></pre></div>
<div id="htmlwidget-4677bf4f89dea187d044" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-4677bf4f89dea187d044">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.5156211249065,51.5138451316266,51.5187164291,51.5153321307779,51.5202799968935,51.5103787877307,51.5252524349357,51.5168121134841,51.5223233946736,51.5157125650859,51.5111647290378,51.5162236277258,51.5222716695808,51.5153668832059,51.5271893657842,51.5160408332312,51.5195817521623,51.5151527338868,51.5181437048756,51.5187813817059,51.5165329628457,51.5203212308108,51.5226907924937,51.5147574987848,51.5190671092273,51.5188225501797,51.5097705215272,51.5168042739205,51.5223021992039,51.5207449794004,51.5228267497905,51.5205962727457,51.5142416006765,51.519195973183,51.5137145971386,51.5175145928762,51.5152810045886,51.5165164902786,51.51352195701,51.5161067649318,51.5162897929537,51.5140671601156,51.5159165727414,51.519005268615,51.5193218360385,51.5173453335122,51.5156647787438,51.519881097311,51.5226230281003,51.515214134228,51.5179097407688,51.5165487367211,51.5175075219539,51.5231988689749,51.513149251163,51.5182445587536,51.5150479780041,51.5218427627421,51.5238973693262,51.506389051911,51.5115816948281,51.5102557648747,51.5143650955436,51.5138502835598,51.5168639087508,51.5182269345245,51.5125029558554,51.5062991874736,51.5140771603158,51.5178250772603,51.5164412528221,51.5143369537834,51.5153221914707,51.5203629043574,51.5235187195593,51.5234323667606,51.5165055536017,51.5119177376357,51.5177342012543,51.520448150882,51.5161878226009,51.5140333730173,51.5176228396909,51.5162340836237,51.5104720704174,51.5195204087403,51.520096894334,51.5190219796145,51.515290900217,51.5251638661443,51.5103913232822,51.519676977934,51.5209506384479,51.5158108972732,51.5126594139033,51.5188226350625,51.5120094690712,51.5160151029699,51.516918288555,51.5165361339343,51.5209014703398,51.5168204785461,51.512923309269,51.5195889659832,51.5164426634542,51.5174617672583,51.5227449454764,51.5235141192644,51.5157174937128,51.5140683706182,51.5131535533762,51.5125758635155,51.5175604522308,51.5181897363149,51.5133444943164,51.5159673020184,51.5185732961439,51.5159533170205,51.5175046526201,51.5179689251848,51.5162150075749,51.5165790154106,51.5144374107812,51.5210035840473,51.5148727174143,51.5155258008771,51.5140008783895,51.5205993062128,51.5181519754709,51.515568054615,51.5186017772203,51.5165563423875,51.5155079910515,51.5139614045366,51.5113780394483,51.5211405404603,51.5169763958259,51.5186050250027,51.5165674678831,51.5171884831147,51.5221046531217,51.5168018685953,51.5167134586413,51.5146708053549,51.5150600355543,51.5146524388992,51.5200694911641,51.513526392032,51.5085233683885,51.5196839735776,51.5168523434647,51.5148607040141,51.5180973112281,51.5081939228335,51.513563708812,51.5143940582822,51.5118429999457,51.5199909731596,51.5178553205707,51.5139727328993,51.5118578042223,51.5193099189876,51.5155523627775,51.5106923380396,51.5214080124271,51.5202950362448,51.523434289577,51.5203373258299,51.5206214143861,51.515693581608,51.5181759413343,51.5465432909072,51.5429915312123,51.5439772939628,51.5402497045233,51.5407578391808,51.5437653865909,51.5407222223507,51.5426897964005,51.5464723024811,51.5454547350061,51.5434705221268,51.5489333157669,51.5440977634403,51.5453956972553,51.5491273720873,51.5449484583867,51.5485618856901,51.5401506226302,51.5504093493462,51.5443863574835,51.5494361254243,51.544961757805,51.5430443598931,51.5405475918066,51.5420828918495,51.5443088534271,51.5436745809239,51.5456517707203,51.5435120986239,51.5450068442743,51.5403219207914,51.545361402456,51.5438882077158,51.5468460718053,51.5414005790959,51.5502526323234,51.5462084179718,51.5434830147288,51.5371321121779,51.5410076622533,51.542568995402,51.5444430338586,51.5408825014283,51.546437260123,51.5430321450072,51.5429240355407,51.5432977375122,51.5480889241507,51.5453589887749,51.5504562254761,51.5403960540861,51.5454578683686,51.5403869689951,51.5453828977762,51.5449348658445,51.5404542786506,51.5400858925264,51.5435738396597,51.5467827391658,51.5431401675124,51.5457362867675,51.5457464096396,51.5441652533984,51.5418285342883,51.5409551143823,51.540220330589,51.54225126236,51.5485446836256,51.5487929810536,51.5451326292499,51.5442371416437,51.5500092165453,51.5463724560145,51.5344853071211,51.5459901557791,51.5440018296203,51.5410774484368,51.5465530220511,51.5484539203003,51.5460063981814,51.5426906650633,51.5440007984931,51.5424571138146,51.5403495671911,51.5452474483746,51.5451302013505,51.5414275046297,51.5408415942409,51.5403497689723,51.5466461911585,51.5485316928003,51.5431630298666,51.5461800528919,51.5459372413026,51.5419185559427,51.5447851034905,51.5422741454833,51.5414718711438,51.5415415907798,51.5404314114306,51.5484030819801,51.5378410255849,51.5437322862852,51.5459521541481,51.5410250049082,51.5429841497855,51.5456324644585,51.5444309633892,51.5411958655656,51.5490465759253,51.5434544488315,51.5430538794027,51.5463607668988,51.5451931580743,51.5446596222007,51.5437462674506,51.5429079598066,51.5428932183305,51.5480880701089,51.5509524155829,51.5459343109456,51.5360560249942,51.5395053305943,51.5435030317833,51.5474598188666,51.5466765494508,51.5442608761013,51.541126708246,51.541221750833,51.5468502275728,51.5383657250924,51.5421553542538,51.5524389599361,51.5525010570725,51.5396171249197,51.544527936321,51.540122652201,51.5429492254013,51.5428798983821,51.5451021008736,51.5477710781947,51.5440028618737,51.5515922798854,51.5404863727569,51.5428847022165,51.5441860128499],[-0.139081083826373,-0.136126963193438,-0.130286781846215,-0.139566977395327,-0.141312451483403,-0.134391128960724,-0.134088918742553,-0.131227885843011,-0.134405835641323,-0.139571005447001,-0.133600475140641,-0.128575532284425,-0.144522957487076,-0.131679898907284,-0.136420956850316,-0.130535437508487,-0.129554421364175,-0.126256013002381,-0.1272445726961,-0.13933317533775,-0.139392408589241,-0.132024460033818,-0.127869036181454,-0.122771618671955,-0.139202401869921,-0.136403364039719,-0.131823889724155,-0.130852028755542,-0.138558067595755,-0.13242977261055,-0.13811057799588,-0.132547713554942,-0.134532867182566,-0.136304148129085,-0.13275090767858,-0.131481236073637,-0.137441788261696,-0.129232965684311,-0.137580387921489,-0.135959890283452,-0.13710706038494,-0.145358144836184,-0.128871303005601,-0.132951830262255,-0.136479761458155,-0.129425857785793,-0.12951028912254,-0.125003623592013,-0.133392466737288,-0.125177549031662,-0.145363803440125,-0.133008251937988,-0.13583982229238,-0.137313493613422,-0.147242029236016,-0.13412946934764,-0.13411450213878,-0.136272434450015,-0.142715218408136,-0.136874417938208,-0.133407199060901,-0.139201093325445,-0.122116091733827,-0.134050778839373,-0.137723772874846,-0.135469710856906,-0.130067486847654,-0.140646940068982,-0.129818822278042,-0.137770374531678,-0.135708110225444,-0.134348900580046,-0.138163836138233,-0.138500738578992,-0.136402834898603,-0.134386625722871,-0.146873721269598,-0.139021912743931,-0.127477308322466,-0.127146003726236,-0.136489512975943,-0.141402265787854,-0.139477328604769,-0.12784760035355,-0.131260356340779,-0.133279816381767,-0.131949897659659,-0.138057193741325,-0.140478855813221,-0.133685775573261,-0.135578639556653,-0.13900531199238,-0.126993303389538,-0.134622162846832,-0.131136960702949,-0.142955463673614,-0.136359251884636,-0.132535013391387,-0.139068219576024,-0.137669918329062,-0.136657158635096,-0.13429605519814,-0.147891546048316,-0.141355345984999,-0.130526912672365,-0.134739621215658,-0.143124548495085,-0.136078660529028,-0.138336733350171,-0.126737245478623,-0.132977136249691,-0.132516527850509,-0.131846033500242,-0.133527252183691,-0.133833926046918,-0.136343464557106,-0.147337211832256,-0.131200409166614,-0.133074139392294,-0.135701986233333,-0.128821759366059,-0.135831629269558,-0.141999602339129,-0.134161925308369,-0.133792616283142,-0.13573938555306,-0.13713202065113,-0.13662838898718,-0.134087782395526,-0.131341476416383,-0.141913515058649,-0.136923503406913,-0.131377112794404,-0.137903596119986,-0.132520032777059,-0.130498555040134,-0.132831040542943,-0.129525244791024,-0.125779581153851,-0.127143164810669,-0.147317207321477,-0.134001417609766,-0.136305930950947,-0.131740167882274,-0.132511684130646,-0.134961233073019,-0.127932237879281,-0.125054433293784,-0.130736614396974,-0.142088380201024,-0.128530782486649,-0.120281481912312,-0.144618203224261,-0.131528162279508,-0.141411823639978,-0.134116356219278,-0.135053384399874,-0.13429640485326,-0.139007857045432,-0.13967773739673,-0.122137333687464,-0.144465367539401,-0.129220581512462,-0.132271081889338,-0.137382646391181,-0.128583215861998,-0.132045145946297,-0.133302400758423,-0.136143040240969,-0.147354517314643,-0.134040961401106,-0.175886965663582,-0.180826907329306,-0.173494195600773,-0.16122982128772,-0.17285578015115,-0.164241651790232,-0.171978242922786,-0.165502636873365,-0.169995890129931,-0.172279389450316,-0.167461525343827,-0.180640383254591,-0.15885399204428,-0.165523941057492,-0.166339055284649,-0.16383204937279,-0.16296291036537,-0.165703198724854,-0.171122407079474,-0.177638850060069,-0.165916318403264,-0.177794098322886,-0.17203872477441,-0.173020734076182,-0.170570803535949,-0.172859412169384,-0.17451399174983,-0.160438798091706,-0.177896449027013,-0.157490617883258,-0.177079303757307,-0.163395333100964,-0.169754372704121,-0.171071313045721,-0.160476584293596,-0.159824433105613,-0.172178172151336,-0.17732453242295,-0.149844779406475,-0.173559842021028,-0.177823609656999,-0.161737173729799,-0.184782760685823,-0.170995990569632,-0.178261874449763,-0.17462513944902,-0.174915968182308,-0.167723986065232,-0.165779577325293,-0.164677328382809,-0.172467897341668,-0.177047601304355,-0.167554116998707,-0.165228458478636,-0.165147831289665,-0.166488457256932,-0.163390458684201,-0.174505139290414,-0.171857156504564,-0.170795490191327,-0.167363182307687,-0.178108616434796,-0.164317117826316,-0.18274793328583,-0.175465496289523,-0.182057733039719,-0.185507952509682,-0.174411773149329,-0.180528680320523,-0.181353038182521,-0.17378856558599,-0.171011712196304,-0.161392793953663,-0.172501441733636,-0.1643954424733,-0.176917792062272,-0.170307333891648,-0.167314358929121,-0.177595283184995,-0.171425299430105,-0.178895369057367,-0.171002970232968,-0.168843887448508,-0.17796447243155,-0.177170829540377,-0.166298735544713,-0.171494884328148,-0.169713829508811,-0.169150135492051,-0.164839403550757,-0.171126738639033,-0.167364195643104,-0.173150256378293,-0.17334689740744,-0.17614343063766,-0.171105424330513,-0.180152394194589,-0.166526733840405,-0.178503615637809,-0.177180562257046,-0.163465292992142,-0.171730627412277,-0.166102522537986,-0.168566679717106,-0.179785630441665,-0.172523607086478,-0.168415463512769,-0.167176940318391,-0.16149291503636,-0.160251101055156,-0.174955520590462,-0.171155992621528,-0.160131064548813,-0.168808795416125,-0.177239831682422,-0.161798805234825,-0.175237466879856,-0.177498804462907,-0.174521435728686,-0.174278478588452,-0.173256710718439,-0.164035747740902,-0.17136114842115,-0.179676706361813,-0.165222843730724,-0.169860996125595,-0.168505616771765,-0.184530538923143,-0.167529130894837,-0.175299064994896,-0.171280034689713,-0.167384404499004,-0.16698053913536,-0.173721254521537,-0.170734450270129,-0.178803517225735,-0.178694158093772,-0.169513967801433,-0.171412729621914,-0.17600808390219,-0.174138218843669,-0.176856111277356,-0.171527890281352,-0.168565183662355,-0.165697595729829,-0.168214772411755],1,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.516634912556,51.5442411372904],[-0.134709116630256,-0.171007974399254],{"iconUrl":{"data":"http://simpleicon.com/wp-content/uploads/cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHAAAAB+CAYAAAD86pU7AAAC80lEQVR4nO3d3XKrMAxGUdE57//K9CrTHA8G/0iWZPa67KQB/EUiYAIiAAAAAAAAAAAACOYUOU+R03s9REQO7xWI7BPSIXLUAjucx3DLAMvB7hnkkcryDHG7AEcrZaYlEmDhbjDvBusphNr/zu7PCPBLz2B+D1zr/10NNgEqWPWtziLA2vuu8OOx0FKUr+QzvLbBPcDVG14uL/uHx7WFeg/e3fHdzHtqvl/D8nx4h2dpZYjuLRRzCNDAyu7i0kJ3bp9XLFvq8gDfFl5JO8ylAb49vA/NENkHJresAqm+/2lVoVmABPZMI0STFkp467APdKQ0C2KDKmw300rNKtD7Yp+3oIUmZxogVWiPCkzOPECq0BYVmNySAKlCO1RgADPHzMsCpAptUIEBhDwTc4Uq1EcFJsdFTc5muxIVmBwBJkeAyZnuA79vElD+DX9m9oP/Wl50Neg9P3U+RU4OIWw8ttBaxdTulXL3+v7Vw5PHquj9zTpBjRntUGa33kC/kRCHb9kBG70hchiRHAEmR4DJEWByBJhcNUDOnORABSZHgMH0Hn8TYEA9IRJgUK0hEmBgLSESYHANt5GeewOsUTusowKTqBUSASbXdE3MDqxudu6t6XTZJhu6bFvLZWmN39U2vCLA0fO6mo/hsXo2xSu+hWqcmG8ZB83H+7Su8+2XmB3C03KIHKtmaHqWUw2Q8K7dtLL3Prklm7IaPedOX3MYYSHCpDcz8snRQpMjwORuA6SNxvdYgYQY2/YtdPcP4PYBRmJxQp0AkyPAoLgqTWLu/1rXqfV1TafSPr9933VWO7Ml82QeIlbft7txU5lOyix6eCJ601IqGxqpCjOEV7q6o1WrlAHWLhrKGN6sNAG+MZwWoSd0Ce1ZyAAJrl24b6GE1ydUgITXL1SA6KcSIJXjJ1QFRjohkIVagFShj1AVyIegX6gA0U81QCpovTAVSPhj1AMkiLWWPLmlYSUIfZB7CyW8OeaDp3XtBwAAAAAAAAAASOoXY/KkyvIGqyIAAAAASUVORK5CYII=",[[51.5934340910359,-0.269761048903247],[51.4485340910359,0.0259189510967518]],0.2,null,null,null]},{"method":"addCircles","args":[[51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55],[-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0],250,null,null,{"interactive":true,"className":"","stroke":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false],"color":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"weight":0.5,"opacity":1,"fill":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"fillColor":["#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3"],"fillOpacity":0.9},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[51.5934340910359,-0.269761048903247],[51.4485340910359,0.0259189510967518]],0.8,null,null,null]},{"method":"addRectangles","args":[51.4485340910359,-0.269761048903242,51.5934340910359,0.025918951096758,null,null,{"interactive":true,"className":"","stroke":true,"color":"#333333","weight":2,"opacity":0.5,"fill":false,"fillColor":"#333333","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMinicharts","args":[[{"dyn":{"width":[23.3333333333333]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.127272727272727,51.5136363636364)","lat":51.5136363636364,"lng":-0.127272727272727},"timeSteps":1},{"dyn":{"width":[14.4444444444444]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.127272727272727,51.5227272727273)","lat":51.5227272727273,"lng":-0.127272727272727},"timeSteps":1},{"dyn":{"width":[16.6666666666667]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.145454545454545,51.5136363636364)","lat":51.5136363636364,"lng":-0.145454545454545},"timeSteps":1},{"dyn":{"width":[18.8888888888889]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.145454545454545,51.5227272727273)","lat":51.5227272727273,"lng":-0.145454545454545},"timeSteps":1},{"dyn":{"width":[27.7777777777778]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.163636363636364,51.5409090909091)","lat":51.5409090909091,"lng":-0.163636363636364},"timeSteps":1},{"dyn":{"width":[21.1111111111111]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.163636363636364,51.55)","lat":51.55,"lng":-0.163636363636364},"timeSteps":1},{"dyn":{"width":[30]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.181818181818182,51.5409090909091)","lat":51.5409090909091,"lng":-0.181818181818182},"timeSteps":1},{"dyn":{"width":[14.4444444444444]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.181818181818182,51.55)","lat":51.55,"lng":-0.181818181818182},"timeSteps":1}],[[[0,1]],[[0,1]],[[0,1]],[[0,1]],[[1,0]],[[1,0]],[[1,0]],[[1,0]]],1,["#A6CEE3","#1F78B4"],["1"],null,{"showTitle":true,"showValues":true,"labels":["group1","group2"],"supValues":null,"supLabels":[],"html":null,"noPopup":false,"digits":null},null]},{"method":"addLegend","args":[{"colors":["#A6CEE3","#1F78B4"],"labels":["group1","group2"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":null,"extra":null,"layerId":"minichartsLegend","className":"info legend","group":null}]}],"limits":{"lat":[51.4485340910359,51.5934340910359],"lng":[-0.269761048903247,0.025918951096758]}},"evals":[],"jsHooks":[]}</script><p>The model-testing metric used consistently through the geographic profiling literature is the hitscore. This is calculated by computing the area searched before finding a source divided by the total search area (where a search is defined by starting at the top of the geoprofile and working your way down). Hence a lower hitscore indicates a better performing model. We use <code>get_hitscores</code> to produce these.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_hitscores.html">get_hitscores</a></span>(p, true_source<span class="op">$</span>longitude, true_source<span class="op">$</span>latitude)
hs</code></pre></div>
<pre><code>##    longitude latitude hs_ringsearch hs_geoprofile_K1 hs_geoprofile_K2
## 1 -0.1347091 51.51663          2.49             6.18             0.05
## 2 -0.1710080 51.54424          2.88             1.97             0.03
##   hs_geoprofile_K3 hs_geoprofile_K4
## 1             0.02             0.50
## 2             0.21             0.69</code></pre>
<p>Another common metric to use for this analysis is a gini coefficent from a Lorenz plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_lorenz.html">plot_lorenz</a></span>(hs)
plot2</code></pre></div>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>This <code><a href="../reference/plot_lorenz.html">plot_lorenz()</a></code> function returns a graph that describes the number of sources found as a function of area searched. The Gini co-efficent is then calculated as the area under these piecewise curves.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/gini.html">gini</a></span>(hs)</code></pre></div>
<pre><code>##    hs_ringsearch hs_geoprofile_K1 hs_geoprofile_K2 hs_geoprofile_K3 
##          0.96070          0.94940          0.99945          0.99875 
## hs_geoprofile_K4 
##          0.99155</code></pre>
<p>Both the <code><a href="../reference/gini.html">gini()</a></code> and <code><a href="../reference/get_hitscores.html">get_hitscores()</a></code> functions refer to a “ringsearch” strategy. This is used to compare the model to a naive search strategy that requires you to search radially outwards from each positive sentinel site until sources are found. This gives us a bottom line non-trivial search strategy to compare hitscores to.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#simulating-data">Simulating data</a></li>
      <li><a href="#creating-a-project">Creating a project</a></li>
      <li><a href="#simple-spatial-priors">Simple spatial priors</a></li>
      <li><a href="#parameter-sets">Parameter sets</a></li>
      <li><a href="#running-the-model">Running the model</a></li>
      <li><a href="#diagnosing-the-model">Diagnosing the Model</a></li>
      <li><a href="#results">Results</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Robert Verity.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
