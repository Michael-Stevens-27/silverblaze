<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial 1: Basic Implementation • silverblaze</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial 1: Basic Implementation">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">silverblaze</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/basic-implementation.html">Tutorial 1: Basic Implementation</a>
    </li>
    <li>
      <a href="../articles/complex-spatial-priors.html">Tutorial 2: Complex Spatial Priors</a>
    </li>
    <li>
      <a href="../articles/model-validation.html">Tutorial 3: Model Validation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Michael-Stevens-27/silverblaze">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="basic-implementation_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="basic-implementation_files/jquery-1.12.4/jquery.min.js"></script><link href="basic-implementation_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="basic-implementation_files/leaflet-1.3.1/leaflet.js"></script><link href="basic-implementation_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="basic-implementation_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="basic-implementation_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="basic-implementation_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="basic-implementation_files/leaflet-binding-2.0.2/leaflet.js"></script><script src="basic-implementation_files/leaflet-providers-1.1.17/leaflet-providers.js"></script><script src="basic-implementation_files/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script><link href="basic-implementation_files/minichart-0.2.2/minicharts.css" rel="stylesheet">
<script src="basic-implementation_files/minichart-0.2.2/leaflet.minicharts.min.js"></script><link href="basic-implementation_files/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial 1: Basic Implementation</h1>
                        <h4 class="author">Michael Stevens</h4>
            
            <h4 class="date">2018-11-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Michael-Stevens-27/silverblaze/blob/master/vignettes/basic-implementation.Rmd"><code>vignettes/basic-implementation.Rmd</code></a></small>
      <div class="hidden name"><code>basic-implementation.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The following tutorial will introduce the user to the general structure required to run silverblaze. The protocol of silverblaze is to create one fundamental object, referred to in these tutorials as <code>p</code>, that describes the entire project. The structure of <code>p</code> consists of:</p>
<ol style="list-style-type: decimal">
<li>The data used to run the model</li>
<li>The parameter settings for the model</li>
<li>The output of running the model</li>
</ol>
<p>Following this, the user will learn how to plot and diagnose the output of the model.</p>
</div>
<div id="simulating-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-data" class="anchor"></a>Simulating data</h2>
<p>Before any data simulation happens, we must first define the sentinel site locations for the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sentinal_lon &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.0</span>, <span class="dt">l =</span> <span class="dv">12</span>)
sentinal_lat &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">51.45</span>, <span class="fl">51.55</span>, <span class="dt">l =</span> <span class="dv">12</span>)
sentinal_grid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(sentinal_lon, sentinal_lat)
<span class="kw">names</span>(sentinal_grid) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>)</code></pre></div>
<p>Here we’ve chosen a lattice configuration but the user may define any list of longitude/latitude locations they would like. With these sentinel sites we can generate our data from a given model using <code><a href="../reference/sim_data.html">sim_data()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mysim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_data.html">sim_data</a></span>(sentinal_grid<span class="op">$</span>longitude,
                 sentinal_grid<span class="op">$</span>latitude,
                 <span class="dt">sentinel_radius =</span> <span class="fl">0.25</span>,
                 <span class="dt">K =</span> <span class="dv">5</span>,
                 <span class="dt">sigma_model =</span> <span class="st">"single"</span>,
                 <span class="dt">sigma_mean =</span> <span class="dv">1</span>,
                 <span class="dt">sigma_var =</span> <span class="fl">0.5</span>,
                 <span class="dt">expected_popsize =</span> <span class="dv">300</span>)</code></pre></div>
<p>These parameters describe the underlying behaviour of the data in question:</p>
<ul>
<li>
<code>sentinal_radius</code> describes the overall reach of our sentinel sites.</li>
<li>
<code>K</code> is the number of sources with which individuals are spatially based.</li>
<li>
<code>sigma_model</code> defines homogeneity or independence of dispersal across sources.</li>
<li>
<code>sigma_mean</code> and <code>sigma_var</code> govern the dispersal associated with each source. Set <code>sigma_var = 0</code> to set an explicit dispersal via <code>sigma_mean</code>.</li>
<li>
<code>expected_popsize</code> tells us how many individuals we expect to see over our search area. The true value is drawn from a Poisson distribution with this expectation.</li>
</ul>
<p>From the simulation we can extract two key objects: the true sources and a record of which individuals were captured and where.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">true_source &lt;-<span class="st"> </span>mysim<span class="op">$</span>record<span class="op">$</span>true_source
data_all &lt;-<span class="st"> </span>mysim<span class="op">$</span>record<span class="op">$</span>data_all</code></pre></div>
<p>We will require these objects for plotting later on.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mysim<span class="op">$</span>data)</code></pre></div>
<pre><code>##    longitude latitude counts
## 1 -0.2000000    51.45      0
## 2 -0.1818182    51.45      0
## 3 -0.1636364    51.45      0
## 4 -0.1454545    51.45      0
## 5 -0.1272727    51.45      0
## 6 -0.1090909    51.45      0</code></pre>
<p>Here we see the general structure of the data required to run the model. That is, a collection of sentinel sites and their respective number of counts. This <code>mysim$data</code> object is the only piece of information required for the user to run the model. All other output from <code>mysim$data</code> is merely a consequence of simulating the data in the first place.</p>
</div>
<div id="creating-a-project" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-project" class="anchor"></a>Creating a project</h2>
<p>We initialise a blank project <code>p</code> using the <code><a href="../reference/rgeoprofile_project.html">rgeoprofile_project()</a></code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rgeoprofile_project.html">rgeoprofile_project</a></span>()</code></pre></div>
<p>We then add in our simulated data using <code><a href="../reference/bind_data.html">bind_data()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_data.html">bind_data</a></span>(p, mysim<span class="op">$</span>data)</code></pre></div>
</div>
<div id="simple-spatial-priors" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-spatial-priors" class="anchor"></a>Simple spatial priors</h2>
<p>We wish to impose a spatial prior on our model. Here we implement some very simple priors, for example instructing the model to restrict the area of interest to to that which contains our sentinel sites. We can produce a uniform spatial prior with <code><a href="../reference/raster_grid.html">raster_grid()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">uniform_prior &lt;-<span class="st"> </span><span class="kw"><a href="../reference/raster_grid.html">raster_grid</a></span>(<span class="dt">range_lon =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.2</span>, <span class="dv">0</span>), <span class="dt">range_lat =</span> <span class="kw">c</span>(<span class="fl">51.45</span>, <span class="fl">51.55</span>),
                             <span class="dt">cells_lon =</span> <span class="dv">100</span>, <span class="dt">cells_lat =</span> <span class="dv">100</span>)</code></pre></div>
<div id="htmlwidget-5f82db6ecda9e46a8896" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-5f82db6ecda9e46a8896">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAABAElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZOjNnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIzAXsTALGT7m3PwAAAABJRU5ErkJggg==",[[51.55,-0.199999999999988],[51.45,5.10633119642717e-19]],0.2,null,null,null]}],"limits":{"lat":[51.45,51.55],"lng":[-0.199999999999988,5.10633119642717e-19]}},"evals":[],"jsHooks":[]}</script><p>It is also possible to import a shapefile that restricts our search area. The example here relates to a particular London borough.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rgeoprofile_shapefile.html">rgeoprofile_shapefile</a></span>(<span class="st">"London_north"</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: "/home/mstevens/R/x86_64-pc-linux-gnu-library/3.4/silverblaze/extdata/London_north", layer: "boroughs"
## with 8 features
## It has 7 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spatial_prior &lt;-<span class="st"> </span><span class="kw"><a href="../reference/raster_from_shapefile.html">raster_from_shapefile</a></span>(s, <span class="dt">cells_lon =</span> <span class="dv">100</span>, <span class="dt">cells_lat =</span> <span class="dv">100</span>)</code></pre></div>
<div id="htmlwidget-031f61a19c751ec76d33" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-031f61a19c751ec76d33">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHAAAAB+CAYAAAD86pU7AAAC80lEQVR4nO3d3XKrMAxGUdE57//K9CrTHA8G/0iWZPa67KQB/EUiYAIiAAAAAAAAAAAACOYUOU+R03s9REQO7xWI7BPSIXLUAjucx3DLAMvB7hnkkcryDHG7AEcrZaYlEmDhbjDvBusphNr/zu7PCPBLz2B+D1zr/10NNgEqWPWtziLA2vuu8OOx0FKUr+QzvLbBPcDVG14uL/uHx7WFeg/e3fHdzHtqvl/D8nx4h2dpZYjuLRRzCNDAyu7i0kJ3bp9XLFvq8gDfFl5JO8ylAb49vA/NENkHJresAqm+/2lVoVmABPZMI0STFkp467APdKQ0C2KDKmw300rNKtD7Yp+3oIUmZxogVWiPCkzOPECq0BYVmNySAKlCO1RgADPHzMsCpAptUIEBhDwTc4Uq1EcFJsdFTc5muxIVmBwBJkeAyZnuA79vElD+DX9m9oP/Wl50Neg9P3U+RU4OIWw8ttBaxdTulXL3+v7Vw5PHquj9zTpBjRntUGa33kC/kRCHb9kBG70hchiRHAEmR4DJEWByBJhcNUDOnORABSZHgMH0Hn8TYEA9IRJgUK0hEmBgLSESYHANt5GeewOsUTusowKTqBUSASbXdE3MDqxudu6t6XTZJhu6bFvLZWmN39U2vCLA0fO6mo/hsXo2xSu+hWqcmG8ZB83H+7Su8+2XmB3C03KIHKtmaHqWUw2Q8K7dtLL3Prklm7IaPedOX3MYYSHCpDcz8snRQpMjwORuA6SNxvdYgYQY2/YtdPcP4PYBRmJxQp0AkyPAoLgqTWLu/1rXqfV1TafSPr9933VWO7Ml82QeIlbft7txU5lOyix6eCJ601IqGxqpCjOEV7q6o1WrlAHWLhrKGN6sNAG+MZwWoSd0Ce1ZyAAJrl24b6GE1ydUgITXL1SA6KcSIJXjJ1QFRjohkIVagFShj1AVyIegX6gA0U81QCpovTAVSPhj1AMkiLWWPLmlYSUIfZB7CyW8OeaDp3XtBwAAAAAAAAAASOoXY/KkyvIGqyIAAAAASUVORK5CYII=",[[51.5934340910359,-0.269761048903247],[51.4485340910359,0.0259189510967518]],0.2,null,null,null]}],"limits":{"lat":[51.4485340910359,51.5934340910359],"lng":[-0.269761048903247,0.0259189510967518]}},"evals":[],"jsHooks":[]}</script><p>This shapefile is built into the package, any other shapefile should be loaded using the <code>readOGR</code> function from <a href="https://cran.r-project.org/web/packages/rgdal/index.html">rgdal</a>.</p>
</div>
<div id="parameter-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#parameter-sets" class="anchor"></a>Parameter sets</h2>
<p>Next we define the various priors on the vairables we wish to estimate when running the model. We define these parameters via <code><a href="../reference/new_set.html">new_set()</a></code>. Notice the project <code>p</code> is one of the functions arguments. This is such that the parameter set we define is added into our project.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/new_set.html">new_set</a></span>(<span class="dt">project =</span> p,
             <span class="dt">spatial_prior =</span> uniform_prior,
             <span class="dt">sentinel_radius =</span> <span class="fl">0.25</span>,
             <span class="dt">sigma_model =</span> <span class="st">"single"</span>,
             <span class="dt">sigma_prior_mean =</span> <span class="dv">1</span>,
             <span class="dt">sigma_prior_sd =</span> <span class="dv">1</span>,
             <span class="dt">expected_popsize_prior_mean =</span> <span class="dv">200</span>,
             <span class="dt">expected_popsize_prior_sd =</span> <span class="dv">30</span>,
             <span class="dt">name =</span> <span class="st">"Tutorial Parameters"</span>)
p</code></pre></div>
<pre><code>## DATA:
##    sentinel sites = 144 (27 positive, 117 negative)
##    total observations = 45
## 
## PARAMETER SETS:
##  * SET1: Tutorial Parameters
## 
## ACTIVE SET: SET1
##    sentinel radius = 0.25
##    spatial prior:
##       longitude range = [-0.2, 0]
##       latitude range = [51.45, 51.55]
##       cells = 100, 100 (lon, lat)
##    sigma prior:
##       model = single
##       prior mean = 1
##       prior SD = 1
##    expected population size prior:
##       prior mean = 200
##       prior SD = 30</code></pre>
<p>The project <code>p</code> is now taking shape as we have defined the data and parameters for the model. Each time the <code><a href="../reference/new_set.html">new_set()</a></code> function is run it will add a new set of parameters to <code>p$parameters_sets</code> and will regard this new set as the <code>active_set</code>. To delete an old parameter set, we use <code><a href="../reference/delete_set.html">delete_set()</a></code>. The <code>"output"</code> object within <code>p</code> is empty right now, but will be populated once the model has run.</p>
</div>
<div id="running-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#running-the-model" class="anchor"></a>Running the model</h2>
<p>We are now ready to run the MCMC algorithm on our data. The arguments in <code><a href="../reference/run_mcmc.html">run_mcmc()</a></code> are similar to many other MCMC implementations. The algorithm will start in the burn-in phase, checking for convergence at each <code>convergence_test</code> iterations and move into the sample phase once the conditions for convergence have been met or the number of burn-in iterations has been reached. The argument <code>K</code> governs how many sources the model should search for. Although we simulated the data, and know the true underlying number of sources, this will rarely be the case with a real-world data set. Hence <code>K</code> can take a single value or a sequence of values. We choose <code>1:4</code> as our data was generated with two sources. The <code>pb_markdown = TRUE</code> argument ensures a neater version of the console output is printed below, this should be removed when run by you.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_mcmc.html">run_mcmc</a></span>(<span class="dt">project =</span> p,
              <span class="dt">K =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,
              <span class="dt">burnin =</span> <span class="fl">1e4</span>,
              <span class="dt">samples =</span> <span class="fl">5e4</span>,
              <span class="dt">converge_test =</span> <span class="fl">1e2</span>,
              <span class="dt">auto_converge =</span> <span class="ot">TRUE</span>,
              <span class="dt">pb_markdown =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Running MCMC for K = 1
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 200 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 1.97405 seconds
## 
## Running MCMC for K = 2
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 200 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 5.25431 seconds
## 
## Running MCMC for K = 3
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 800 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 9.88252 seconds
## 
## Running MCMC for K = 4
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 100 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 12.3735 seconds
## 
## Running MCMC for K = 5
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 100 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 16.327 seconds
## 
## Running MCMC for K = 6
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 100 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 22.6531 seconds
## 
## Running MCMC for K = 7
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 100 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 24.9996 seconds
## 
## Running MCMC for K = 8
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 800 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 32.1449 seconds
## 
## Running MCMC for K = 9
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 100 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 35.0953 seconds
## 
## Running MCMC for K = 10
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 100 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 42.1869 seconds
## 
## Processing results</code></pre>
<pre><code>## Total run-time: 3.79 minutes</code></pre>
<p>An immediate indication that the MCMC is acting sensibly is that the model <code>converged within X iterations</code> for every <code>K</code> value, so the choice of burn-in sufficed. Before plotting any geoprofiles let’s makes sure the MCMC is indeed mixing well.</p>
</div>
<div id="diagnosing-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#diagnosing-the-model" class="anchor"></a>Diagnosing the Model</h2>
<p>Firstly we question the MCMC’s ability by producing diagnostic plots of the log-likelihood. This can be done for each value of <code>K</code> to ensure the algorithm is behaving properly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_loglike_dignostic.html">plot_loglike_dignostic</a></span>(p, <span class="dt">K =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Another useful metric for assessing the MCMC is its effective sampling size (ESS). If we have 10,000 sampling iterations but an ESS of 80 then we really only have 80 samples from the posterior, and so we should run it out for longer.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_ESS.html">get_ESS</a></span>(p, <span class="dt">K =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>##    rung1 
## 3791.728</code></pre>
</div>
<div id="results" class="section level2">
<h2 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h2>
<div id="mapping" class="section level3">
<h3 class="hasAnchor">
<a href="#mapping" class="anchor"></a>Mapping</h3>
<p>Now the model has run, we can start to visualise different aspects of the project. Plotting objects in silverblaze follow a similar structure to <a href="https://rstudio.github.io/leaflet/">Leaflet</a> and <a href="https://ggplot2.tidyverse.org/">ggplot2</a>. We start with a base layer</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_map.html">plot_map</a></span>()</code></pre></div>
<p>and overlay different parts of our project using the set of overlay functions. Lets start with the underlying locations of individuals and their sources.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_points.html">overlay_points</a></span>(plot1, data_all<span class="op">$</span>longitude, data_all<span class="op">$</span>latitude)
plot2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_sources.html">overlay_sources</a></span>(plot2, true_source<span class="op">$</span>longitude, true_source<span class="op">$</span>latitude)
plot2</code></pre></div>
<div id="htmlwidget-3af69db8696970040c2b" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-3af69db8696970040c2b">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.475657166802,51.4892860986829,51.4937626285096,51.4845292192994,51.5037521270628,51.490365482375,51.4885981229574,51.4752965668253,51.4968497761704,51.4885846085728,51.4829092888067,51.4753989319836,51.4837997796679,51.4837790643691,51.4847785928241,51.4915023477354,51.481952141315,51.4723672221794,51.4943230038678,51.49055505435,51.4764211549298,51.4885983632195,51.4810512675809,51.4972265377584,51.4863639399258,51.4834214126152,51.4829106290823,51.4898651015412,51.4743586808154,51.4804527514301,51.4745142580426,51.4886401926805,51.4973918429952,51.4906410068206,51.5006744335485,51.4780329616524,51.484308814675,51.4909495712091,51.4967664568914,51.4806177279458,51.4894367990236,51.4759308231483,51.4674028850344,51.4826817628227,51.4818976175328,51.4761590127167,51.4758541309937,51.479603508158,51.4811353621695,51.4784746852942,51.4842436165095,51.4800217692882,51.4947956707369,51.4833778137656,51.4905274782399,51.474826018534,51.4867039718684,51.4879755420929,51.4725044468583,51.4744758827984,51.4722832762244,51.4649352509064,51.4767406515633,51.4678995085162,51.4711821966162,51.4765751588726,51.4776979464238,51.4743906969705,51.461312231407,51.4701605850129,51.4810458661548,51.4747303370311,51.4615296707829,51.477386311345,51.4738276271271,51.4639723445902,51.4757367770707,51.4723520746418,51.4732454731219,51.4884715009048,51.4708348632106,51.4743477882691,51.4755110511587,51.4719786170362,51.4818075374067,51.482271468115,51.4771704246745,51.4846824193269,51.4799311090883,51.4623412765551,51.4610265650533,51.4699234210303,51.4659527428508,51.4698357293795,51.476700915634,51.4693350664428,51.4751777882317,51.4756962634335,51.4735928607585,51.4595511400851,51.4847391306883,51.4698561532253,51.4801834885476,51.4751511962195,51.4784849526841,51.4725163200986,51.4683097256827,51.468329377184,51.4823202774471,51.4695067862449,51.4929285583074,51.4755933615385,51.4688889282806,51.4755229479843,51.4771414244885,51.4724171077431,51.4713248970644,51.4686645484489,51.4690948202617,51.4880482472405,51.5165750765041,51.5148081486299,51.5174664311855,51.5190031966473,51.5296104180216,51.5187201757112,51.5260163605119,51.5231067783161,51.5200527020693,51.5233346626486,51.5341858151374,51.5234129367447,51.5271651366006,51.5092445843132,51.5147025764166,51.5324658949106,51.5175550074735,51.5186879556723,51.5171607754361,51.521249917387,51.5151110388685,51.5140457247054,51.5305942588121,51.5291207720972,51.5281138594208,51.5265380685631,51.5186652352359,51.5299532686092,51.5162984069185,51.5239859688854,51.5196086417543,51.5158393764126,51.5107691291579,51.5305296939084,51.5059734768603,51.5137914353371,51.5222800368415,51.5253567953018,51.5131114159316,51.5177057022503,51.5242264909429,51.5310516418315,51.5259922530899,51.5223021109729,51.5229936314898,51.5336920693812,51.5296239753785,51.5354066513192,51.524892430577,51.5015845059076,51.5163618771454,51.511621285116,51.4805988731535,51.4683510898335,51.489685488169,51.4882651586374,51.4757624131876,51.4694541276048,51.4754547814126,51.4861335070741,51.4800055159741,51.4761771095186,51.4819624618259,51.4669384047324,51.4757821567315,51.4614949164104,51.4822387313762,51.476937782379,51.4849040186214,51.47450578067,51.4733452511012,51.4626428879762,51.4745245799957,51.47853928891,51.4875620752243,51.4704335697153,51.48343786523,51.4880580966261,51.4850071624798,51.4805804459676,51.4785670130878,51.4850352083503,51.4772123081493,51.4721176831124,51.4783764479252,51.4717516208311,51.489008880932,51.4681575550478,51.487472206758,51.4971965767801,51.4832341131019,51.4715232750545,51.476870846487,51.4708707724837,51.4827764578925,51.478218423171,51.475134478375,51.4785249724279,51.4700329820592,51.4817525484946,51.479088184847,51.4826969971113,51.4779670451501,51.4799603887521,51.5095061236054,51.519864904916,51.5144915692594,51.5260009408898,51.4960984336111,51.5027612400444,51.5025344046168,51.5125203605238,51.5012075073764,51.5155761632272,51.51062764152,51.4891411574137,51.5076825793514,51.50400887716,51.5076310047785,51.509197982426,51.5063131898557,51.5122580755953,51.50725544694,51.5067741532725,51.5146055489676,51.5118470815445,51.4997647992186,51.5264817084668,51.4929077866652,51.5075106437209,51.5065406766492,51.5122940170452,51.5133748966345,51.5059670734996,51.497163396063,51.5089683537508,51.5084929953052,51.5016786273944,51.5002109397002,51.4964670637369,51.501414590875,51.5065513889811,51.505006379207,51.5215431848239,51.5143129659364,51.4981278939154,51.5127175003045],[-0.117367493563965,-0.123738731492183,-0.114068955138457,-0.137829709382589,-0.143279501738717,-0.133392031446455,-0.130090339562636,-0.139760832788702,-0.136908215332321,-0.107041963266337,-0.136616187439761,-0.124856650061291,-0.138371267517126,-0.147306463386693,-0.125433843223903,-0.133238564815395,-0.145023526568833,-0.142334118185371,-0.127192864928465,-0.122196071609076,-0.130727446722967,-0.145696498485726,-0.122689060548269,-0.137441999797041,-0.126487173902948,-0.118762612885876,-0.137154864075206,-0.13841813497333,-0.121120872189079,-0.121391122466853,-0.112707875719019,-0.125570231197494,-0.140205549333489,-0.1265667421457,-0.123197819938151,-0.13392308942122,-0.124657034840786,-0.123721439708447,-0.131592131750961,-0.127608670155514,-0.130645047563348,-0.144260118232396,-0.128645777537137,-0.146848840244806,-0.129145987991352,-0.140201000199601,-0.139847267984266,-0.127449386957533,-0.127622321961537,-0.131192633487607,-0.146718835501901,-0.13045980781899,-0.124215310955233,-0.137922811733852,-0.154164620412701,-0.18649388433442,-0.185523757573431,-0.159496124343804,-0.169425429081706,-0.167871082974163,-0.145013898222135,-0.164440187256201,-0.164306941197442,-0.17746265376629,-0.15543894070457,-0.185681488772726,-0.152711731809676,-0.168850259654161,-0.159332347102654,-0.181283061583449,-0.170872032435328,-0.181430100828749,-0.188552730842445,-0.174084537049645,-0.169243997489487,-0.169806976164718,-0.167487696329384,-0.161982696640959,-0.167176691012484,-0.173297150310915,-0.161388925772587,-0.160883418078646,-0.169373778404437,-0.17475179190168,-0.1687575495514,-0.177167899238824,-0.173510805187034,-0.170682514959995,-0.141497718269085,-0.163019753109462,-0.174657939364513,-0.179486796089077,-0.155095543645714,-0.192305667193249,-0.178069007531386,-0.165255512307485,-0.166404213295736,-0.176908431222678,-0.177943289658607,-0.166272412881015,-0.140751882573492,-0.155586060570203,-0.175241445619545,-0.175089399685033,-0.183093128491481,-0.170790389838821,-0.164679562660596,-0.161180219420257,-0.18462787890372,-0.145779153610946,-0.193000031538618,-0.199679167515175,-0.17959328886842,-0.175639422913727,-0.189351496442962,-0.184965109605166,-0.157162183561641,-0.172356161695452,-0.177230519433175,-0.160262204239635,-0.0648282883851651,-0.0672127219959665,-0.0878359660099551,-0.0615510245378141,-0.0607922083809607,-0.0699972336379647,-0.086123634027547,-0.0686292580645635,-0.0681061624306647,-0.0628039128755597,-0.0804216680040696,-0.0593774525913483,-0.0741458824119954,-0.0535689152304853,-0.0751333511425739,-0.0517783626763037,-0.0680807657938926,-0.056464143071204,-0.0595787563947797,-0.0824342655481813,-0.0712338262287437,-0.0468884568768912,-0.065041009352719,-0.0568282085910109,-0.058743736123429,-0.0755412046239142,-0.052082937248289,-0.0512089973784003,-0.0705068332115821,-0.0499156627323373,-0.0827997226980483,-0.0774652601956077,-0.067875579623309,-0.0682393022581124,-0.0904266987632444,-0.0526738909349396,-0.0946686080602984,-0.0726914149428544,-0.0650280386037865,-0.0559731116483551,-0.0709228603434778,-0.079879176459354,-0.0674104925145159,-0.0580731301438953,-0.048005323383452,-0.0578997391775544,-0.0670703750366698,-0.0607602040886655,-0.0636200551111864,-0.0636370928882856,-0.0646647016958571,-0.0721110154591082,-0.0099912898651116,-0.00806021472911023,-0.0228496165050466,-0.0283535409341511,-0.00916547647005332,-0.0125635359759695,-0.016381086667515,-0.00760859750013503,-0.000839065150719168,-0.0278350008334369,0.00209039482542473,-0.00720187621963668,0.00180390750139203,-0.0180766529491858,-0.00444500091279253,-0.0105081527688957,-0.0131920242846577,0.0125404536103916,-0.0152833663494694,-0.0211425251328916,-0.0232709283577461,-0.0394959374963093,-0.00810363416588652,0.002209276499048,-0.00231931563406596,-0.00770533916880199,0.00138625818671895,-0.00491675837165564,-0.0207480210091027,0.000529969961572082,-0.0169152764726977,0.000280819541950894,-0.000593029775897619,0.00228202804684628,0.00173064253263168,0.00172839799501581,-0.0173445376392507,-0.0155593508200199,-0.00872419324679069,-0.00738466208205043,0.00276834017324891,-0.0151684437548805,-0.00658414954026096,-0.00521742520918834,-0.0130360584532111,-0.00644541147100298,-0.0236104613482441,-0.0250230600238022,-0.0160963510301832,-0.00396493401004247,-0.0182014893539135,-0.0334362194614984,-0.0388405286059319,-0.0496100905408623,-0.0101035814340922,-0.0171456295097446,-0.0491900063822667,-0.0326046680520007,-0.0209611432925296,-0.049936096428677,-0.0263320294076989,-0.0440661743376771,-0.0388831939215639,-0.0238719245537624,-0.0226517717908019,-0.0419815602377568,-0.0249233943840195,-0.0440611729120323,-0.0287476017872327,-0.0347010235391352,-0.0309406980189024,-0.0273142324297628,-0.0392291833121837,-0.0176972567006052,-0.0349287648423722,-0.0277478262675571,-0.0300702394978254,-0.0590985415215266,-0.0521815191102676,-0.0169638994991893,-0.024595048580136,-0.0323680098404807,-0.0138859488298678,-0.0331583308424317,-0.0271100055831317,-0.0385156376290404,-0.0419475351212251,-0.0363612034001041,-0.024035630958855,-0.041188908850587,-0.0227172229451906,-0.00499468402933658,-0.0334098280459465,-0.046840636262092,-0.0330814850984984],1,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.4863651670283,51.4740290413145,51.5228264596313,51.4767996435054,51.5082655508304],[-0.134709116630256,-0.171007974399254,-0.0667301748879254,-0.0115177254192531,-0.0326127622742206],{"iconUrl":{"data":"http://simpleicon.com/wp-content/uploads/cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[51.4595511400851,51.5354066513192],"lng":[-0.199679167515175,0.0125404536103916]}},"evals":[],"jsHooks":[]}</script><p>This isn’t too interesting yet, so let’s add to this the spatial prior and the sentinel site locations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_spatial_prior.html">overlay_spatial_prior</a></span>(plot2, p, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">opacity =</span> <span class="fl">0.2</span>)
plot2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_sentinels.html">overlay_sentinels</a></span>(plot2, p, <span class="dt">fill_opacity =</span> <span class="fl">0.9</span>,
                            <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">fill_colour =</span> <span class="kw">c</span>(<span class="kw">grey</span>(<span class="fl">0.7</span>), <span class="st">"red"</span>),
                            <span class="dt">border =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>), <span class="dt">border_colour =</span> <span class="st">"black"</span>, <span class="dt">border_weight =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## getting sentinel radius from active parameter set:</code></pre>
<pre><code>##   sentinal radius = 0.25km</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot2</code></pre></div>
<p></p>
<div id="htmlwidget-144fc3861928e8bed05c" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-144fc3861928e8bed05c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.475657166802,51.4892860986829,51.4937626285096,51.4845292192994,51.5037521270628,51.490365482375,51.4885981229574,51.4752965668253,51.4968497761704,51.4885846085728,51.4829092888067,51.4753989319836,51.4837997796679,51.4837790643691,51.4847785928241,51.4915023477354,51.481952141315,51.4723672221794,51.4943230038678,51.49055505435,51.4764211549298,51.4885983632195,51.4810512675809,51.4972265377584,51.4863639399258,51.4834214126152,51.4829106290823,51.4898651015412,51.4743586808154,51.4804527514301,51.4745142580426,51.4886401926805,51.4973918429952,51.4906410068206,51.5006744335485,51.4780329616524,51.484308814675,51.4909495712091,51.4967664568914,51.4806177279458,51.4894367990236,51.4759308231483,51.4674028850344,51.4826817628227,51.4818976175328,51.4761590127167,51.4758541309937,51.479603508158,51.4811353621695,51.4784746852942,51.4842436165095,51.4800217692882,51.4947956707369,51.4833778137656,51.4905274782399,51.474826018534,51.4867039718684,51.4879755420929,51.4725044468583,51.4744758827984,51.4722832762244,51.4649352509064,51.4767406515633,51.4678995085162,51.4711821966162,51.4765751588726,51.4776979464238,51.4743906969705,51.461312231407,51.4701605850129,51.4810458661548,51.4747303370311,51.4615296707829,51.477386311345,51.4738276271271,51.4639723445902,51.4757367770707,51.4723520746418,51.4732454731219,51.4884715009048,51.4708348632106,51.4743477882691,51.4755110511587,51.4719786170362,51.4818075374067,51.482271468115,51.4771704246745,51.4846824193269,51.4799311090883,51.4623412765551,51.4610265650533,51.4699234210303,51.4659527428508,51.4698357293795,51.476700915634,51.4693350664428,51.4751777882317,51.4756962634335,51.4735928607585,51.4595511400851,51.4847391306883,51.4698561532253,51.4801834885476,51.4751511962195,51.4784849526841,51.4725163200986,51.4683097256827,51.468329377184,51.4823202774471,51.4695067862449,51.4929285583074,51.4755933615385,51.4688889282806,51.4755229479843,51.4771414244885,51.4724171077431,51.4713248970644,51.4686645484489,51.4690948202617,51.4880482472405,51.5165750765041,51.5148081486299,51.5174664311855,51.5190031966473,51.5296104180216,51.5187201757112,51.5260163605119,51.5231067783161,51.5200527020693,51.5233346626486,51.5341858151374,51.5234129367447,51.5271651366006,51.5092445843132,51.5147025764166,51.5324658949106,51.5175550074735,51.5186879556723,51.5171607754361,51.521249917387,51.5151110388685,51.5140457247054,51.5305942588121,51.5291207720972,51.5281138594208,51.5265380685631,51.5186652352359,51.5299532686092,51.5162984069185,51.5239859688854,51.5196086417543,51.5158393764126,51.5107691291579,51.5305296939084,51.5059734768603,51.5137914353371,51.5222800368415,51.5253567953018,51.5131114159316,51.5177057022503,51.5242264909429,51.5310516418315,51.5259922530899,51.5223021109729,51.5229936314898,51.5336920693812,51.5296239753785,51.5354066513192,51.524892430577,51.5015845059076,51.5163618771454,51.511621285116,51.4805988731535,51.4683510898335,51.489685488169,51.4882651586374,51.4757624131876,51.4694541276048,51.4754547814126,51.4861335070741,51.4800055159741,51.4761771095186,51.4819624618259,51.4669384047324,51.4757821567315,51.4614949164104,51.4822387313762,51.476937782379,51.4849040186214,51.47450578067,51.4733452511012,51.4626428879762,51.4745245799957,51.47853928891,51.4875620752243,51.4704335697153,51.48343786523,51.4880580966261,51.4850071624798,51.4805804459676,51.4785670130878,51.4850352083503,51.4772123081493,51.4721176831124,51.4783764479252,51.4717516208311,51.489008880932,51.4681575550478,51.487472206758,51.4971965767801,51.4832341131019,51.4715232750545,51.476870846487,51.4708707724837,51.4827764578925,51.478218423171,51.475134478375,51.4785249724279,51.4700329820592,51.4817525484946,51.479088184847,51.4826969971113,51.4779670451501,51.4799603887521,51.5095061236054,51.519864904916,51.5144915692594,51.5260009408898,51.4960984336111,51.5027612400444,51.5025344046168,51.5125203605238,51.5012075073764,51.5155761632272,51.51062764152,51.4891411574137,51.5076825793514,51.50400887716,51.5076310047785,51.509197982426,51.5063131898557,51.5122580755953,51.50725544694,51.5067741532725,51.5146055489676,51.5118470815445,51.4997647992186,51.5264817084668,51.4929077866652,51.5075106437209,51.5065406766492,51.5122940170452,51.5133748966345,51.5059670734996,51.497163396063,51.5089683537508,51.5084929953052,51.5016786273944,51.5002109397002,51.4964670637369,51.501414590875,51.5065513889811,51.505006379207,51.5215431848239,51.5143129659364,51.4981278939154,51.5127175003045],[-0.117367493563965,-0.123738731492183,-0.114068955138457,-0.137829709382589,-0.143279501738717,-0.133392031446455,-0.130090339562636,-0.139760832788702,-0.136908215332321,-0.107041963266337,-0.136616187439761,-0.124856650061291,-0.138371267517126,-0.147306463386693,-0.125433843223903,-0.133238564815395,-0.145023526568833,-0.142334118185371,-0.127192864928465,-0.122196071609076,-0.130727446722967,-0.145696498485726,-0.122689060548269,-0.137441999797041,-0.126487173902948,-0.118762612885876,-0.137154864075206,-0.13841813497333,-0.121120872189079,-0.121391122466853,-0.112707875719019,-0.125570231197494,-0.140205549333489,-0.1265667421457,-0.123197819938151,-0.13392308942122,-0.124657034840786,-0.123721439708447,-0.131592131750961,-0.127608670155514,-0.130645047563348,-0.144260118232396,-0.128645777537137,-0.146848840244806,-0.129145987991352,-0.140201000199601,-0.139847267984266,-0.127449386957533,-0.127622321961537,-0.131192633487607,-0.146718835501901,-0.13045980781899,-0.124215310955233,-0.137922811733852,-0.154164620412701,-0.18649388433442,-0.185523757573431,-0.159496124343804,-0.169425429081706,-0.167871082974163,-0.145013898222135,-0.164440187256201,-0.164306941197442,-0.17746265376629,-0.15543894070457,-0.185681488772726,-0.152711731809676,-0.168850259654161,-0.159332347102654,-0.181283061583449,-0.170872032435328,-0.181430100828749,-0.188552730842445,-0.174084537049645,-0.169243997489487,-0.169806976164718,-0.167487696329384,-0.161982696640959,-0.167176691012484,-0.173297150310915,-0.161388925772587,-0.160883418078646,-0.169373778404437,-0.17475179190168,-0.1687575495514,-0.177167899238824,-0.173510805187034,-0.170682514959995,-0.141497718269085,-0.163019753109462,-0.174657939364513,-0.179486796089077,-0.155095543645714,-0.192305667193249,-0.178069007531386,-0.165255512307485,-0.166404213295736,-0.176908431222678,-0.177943289658607,-0.166272412881015,-0.140751882573492,-0.155586060570203,-0.175241445619545,-0.175089399685033,-0.183093128491481,-0.170790389838821,-0.164679562660596,-0.161180219420257,-0.18462787890372,-0.145779153610946,-0.193000031538618,-0.199679167515175,-0.17959328886842,-0.175639422913727,-0.189351496442962,-0.184965109605166,-0.157162183561641,-0.172356161695452,-0.177230519433175,-0.160262204239635,-0.0648282883851651,-0.0672127219959665,-0.0878359660099551,-0.0615510245378141,-0.0607922083809607,-0.0699972336379647,-0.086123634027547,-0.0686292580645635,-0.0681061624306647,-0.0628039128755597,-0.0804216680040696,-0.0593774525913483,-0.0741458824119954,-0.0535689152304853,-0.0751333511425739,-0.0517783626763037,-0.0680807657938926,-0.056464143071204,-0.0595787563947797,-0.0824342655481813,-0.0712338262287437,-0.0468884568768912,-0.065041009352719,-0.0568282085910109,-0.058743736123429,-0.0755412046239142,-0.052082937248289,-0.0512089973784003,-0.0705068332115821,-0.0499156627323373,-0.0827997226980483,-0.0774652601956077,-0.067875579623309,-0.0682393022581124,-0.0904266987632444,-0.0526738909349396,-0.0946686080602984,-0.0726914149428544,-0.0650280386037865,-0.0559731116483551,-0.0709228603434778,-0.079879176459354,-0.0674104925145159,-0.0580731301438953,-0.048005323383452,-0.0578997391775544,-0.0670703750366698,-0.0607602040886655,-0.0636200551111864,-0.0636370928882856,-0.0646647016958571,-0.0721110154591082,-0.0099912898651116,-0.00806021472911023,-0.0228496165050466,-0.0283535409341511,-0.00916547647005332,-0.0125635359759695,-0.016381086667515,-0.00760859750013503,-0.000839065150719168,-0.0278350008334369,0.00209039482542473,-0.00720187621963668,0.00180390750139203,-0.0180766529491858,-0.00444500091279253,-0.0105081527688957,-0.0131920242846577,0.0125404536103916,-0.0152833663494694,-0.0211425251328916,-0.0232709283577461,-0.0394959374963093,-0.00810363416588652,0.002209276499048,-0.00231931563406596,-0.00770533916880199,0.00138625818671895,-0.00491675837165564,-0.0207480210091027,0.000529969961572082,-0.0169152764726977,0.000280819541950894,-0.000593029775897619,0.00228202804684628,0.00173064253263168,0.00172839799501581,-0.0173445376392507,-0.0155593508200199,-0.00872419324679069,-0.00738466208205043,0.00276834017324891,-0.0151684437548805,-0.00658414954026096,-0.00521742520918834,-0.0130360584532111,-0.00644541147100298,-0.0236104613482441,-0.0250230600238022,-0.0160963510301832,-0.00396493401004247,-0.0182014893539135,-0.0334362194614984,-0.0388405286059319,-0.0496100905408623,-0.0101035814340922,-0.0171456295097446,-0.0491900063822667,-0.0326046680520007,-0.0209611432925296,-0.049936096428677,-0.0263320294076989,-0.0440661743376771,-0.0388831939215639,-0.0238719245537624,-0.0226517717908019,-0.0419815602377568,-0.0249233943840195,-0.0440611729120323,-0.0287476017872327,-0.0347010235391352,-0.0309406980189024,-0.0273142324297628,-0.0392291833121837,-0.0176972567006052,-0.0349287648423722,-0.0277478262675571,-0.0300702394978254,-0.0590985415215266,-0.0521815191102676,-0.0169638994991893,-0.024595048580136,-0.0323680098404807,-0.0138859488298678,-0.0331583308424317,-0.0271100055831317,-0.0385156376290404,-0.0419475351212251,-0.0363612034001041,-0.024035630958855,-0.041188908850587,-0.0227172229451906,-0.00499468402933658,-0.0334098280459465,-0.046840636262092,-0.0330814850984984],1,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.4863651670283,51.4740290413145,51.5228264596313,51.4767996435054,51.5082655508304],[-0.134709116630256,-0.171007974399254,-0.0667301748879254,-0.0115177254192531,-0.0326127622742206],{"iconUrl":{"data":"http://simpleicon.com/wp-content/uploads/cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAABAElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZOjNnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIzAXsTALGT7m3PwAAAABJRU5ErkJggg==",[[51.55,-0.199999999999988],[51.45,5.10633119642717e-19]],0.2,null,null,null]},{"method":"addCircles","args":[[51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55],[-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0],250,null,null,{"interactive":true,"className":"","stroke":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,true,true,true,true,false,false,false,false,false,false,true,true,true,true,true,false,false,false,false,false,false,true,true,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,true,false,false,false,false,true,false,false,false,false,false,true,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,true,true,true,true,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"color":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"weight":0.5,"opacity":1,"fill":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"fillColor":["#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3"],"fillOpacity":0.9},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"limits":{"lat":[51.45,51.55],"lng":[-0.2,0.0125404536103916]}},"evals":[],"jsHooks":[]}</script> Finally, we add in the geoprofile produced by running the MCMC.
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_geoprofile.html">overlay_geoprofile</a></span>(plot2, p, <span class="dt">threshold =</span> <span class="fl">0.1</span>, <span class="dt">opacity =</span> <span class="fl">0.8</span>, <span class="dt">K =</span> <span class="dv">5</span>)
plot2</code></pre></div>
<div id="htmlwidget-6659e0634bdf8da107f7" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6659e0634bdf8da107f7">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.475657166802,51.4892860986829,51.4937626285096,51.4845292192994,51.5037521270628,51.490365482375,51.4885981229574,51.4752965668253,51.4968497761704,51.4885846085728,51.4829092888067,51.4753989319836,51.4837997796679,51.4837790643691,51.4847785928241,51.4915023477354,51.481952141315,51.4723672221794,51.4943230038678,51.49055505435,51.4764211549298,51.4885983632195,51.4810512675809,51.4972265377584,51.4863639399258,51.4834214126152,51.4829106290823,51.4898651015412,51.4743586808154,51.4804527514301,51.4745142580426,51.4886401926805,51.4973918429952,51.4906410068206,51.5006744335485,51.4780329616524,51.484308814675,51.4909495712091,51.4967664568914,51.4806177279458,51.4894367990236,51.4759308231483,51.4674028850344,51.4826817628227,51.4818976175328,51.4761590127167,51.4758541309937,51.479603508158,51.4811353621695,51.4784746852942,51.4842436165095,51.4800217692882,51.4947956707369,51.4833778137656,51.4905274782399,51.474826018534,51.4867039718684,51.4879755420929,51.4725044468583,51.4744758827984,51.4722832762244,51.4649352509064,51.4767406515633,51.4678995085162,51.4711821966162,51.4765751588726,51.4776979464238,51.4743906969705,51.461312231407,51.4701605850129,51.4810458661548,51.4747303370311,51.4615296707829,51.477386311345,51.4738276271271,51.4639723445902,51.4757367770707,51.4723520746418,51.4732454731219,51.4884715009048,51.4708348632106,51.4743477882691,51.4755110511587,51.4719786170362,51.4818075374067,51.482271468115,51.4771704246745,51.4846824193269,51.4799311090883,51.4623412765551,51.4610265650533,51.4699234210303,51.4659527428508,51.4698357293795,51.476700915634,51.4693350664428,51.4751777882317,51.4756962634335,51.4735928607585,51.4595511400851,51.4847391306883,51.4698561532253,51.4801834885476,51.4751511962195,51.4784849526841,51.4725163200986,51.4683097256827,51.468329377184,51.4823202774471,51.4695067862449,51.4929285583074,51.4755933615385,51.4688889282806,51.4755229479843,51.4771414244885,51.4724171077431,51.4713248970644,51.4686645484489,51.4690948202617,51.4880482472405,51.5165750765041,51.5148081486299,51.5174664311855,51.5190031966473,51.5296104180216,51.5187201757112,51.5260163605119,51.5231067783161,51.5200527020693,51.5233346626486,51.5341858151374,51.5234129367447,51.5271651366006,51.5092445843132,51.5147025764166,51.5324658949106,51.5175550074735,51.5186879556723,51.5171607754361,51.521249917387,51.5151110388685,51.5140457247054,51.5305942588121,51.5291207720972,51.5281138594208,51.5265380685631,51.5186652352359,51.5299532686092,51.5162984069185,51.5239859688854,51.5196086417543,51.5158393764126,51.5107691291579,51.5305296939084,51.5059734768603,51.5137914353371,51.5222800368415,51.5253567953018,51.5131114159316,51.5177057022503,51.5242264909429,51.5310516418315,51.5259922530899,51.5223021109729,51.5229936314898,51.5336920693812,51.5296239753785,51.5354066513192,51.524892430577,51.5015845059076,51.5163618771454,51.511621285116,51.4805988731535,51.4683510898335,51.489685488169,51.4882651586374,51.4757624131876,51.4694541276048,51.4754547814126,51.4861335070741,51.4800055159741,51.4761771095186,51.4819624618259,51.4669384047324,51.4757821567315,51.4614949164104,51.4822387313762,51.476937782379,51.4849040186214,51.47450578067,51.4733452511012,51.4626428879762,51.4745245799957,51.47853928891,51.4875620752243,51.4704335697153,51.48343786523,51.4880580966261,51.4850071624798,51.4805804459676,51.4785670130878,51.4850352083503,51.4772123081493,51.4721176831124,51.4783764479252,51.4717516208311,51.489008880932,51.4681575550478,51.487472206758,51.4971965767801,51.4832341131019,51.4715232750545,51.476870846487,51.4708707724837,51.4827764578925,51.478218423171,51.475134478375,51.4785249724279,51.4700329820592,51.4817525484946,51.479088184847,51.4826969971113,51.4779670451501,51.4799603887521,51.5095061236054,51.519864904916,51.5144915692594,51.5260009408898,51.4960984336111,51.5027612400444,51.5025344046168,51.5125203605238,51.5012075073764,51.5155761632272,51.51062764152,51.4891411574137,51.5076825793514,51.50400887716,51.5076310047785,51.509197982426,51.5063131898557,51.5122580755953,51.50725544694,51.5067741532725,51.5146055489676,51.5118470815445,51.4997647992186,51.5264817084668,51.4929077866652,51.5075106437209,51.5065406766492,51.5122940170452,51.5133748966345,51.5059670734996,51.497163396063,51.5089683537508,51.5084929953052,51.5016786273944,51.5002109397002,51.4964670637369,51.501414590875,51.5065513889811,51.505006379207,51.5215431848239,51.5143129659364,51.4981278939154,51.5127175003045],[-0.117367493563965,-0.123738731492183,-0.114068955138457,-0.137829709382589,-0.143279501738717,-0.133392031446455,-0.130090339562636,-0.139760832788702,-0.136908215332321,-0.107041963266337,-0.136616187439761,-0.124856650061291,-0.138371267517126,-0.147306463386693,-0.125433843223903,-0.133238564815395,-0.145023526568833,-0.142334118185371,-0.127192864928465,-0.122196071609076,-0.130727446722967,-0.145696498485726,-0.122689060548269,-0.137441999797041,-0.126487173902948,-0.118762612885876,-0.137154864075206,-0.13841813497333,-0.121120872189079,-0.121391122466853,-0.112707875719019,-0.125570231197494,-0.140205549333489,-0.1265667421457,-0.123197819938151,-0.13392308942122,-0.124657034840786,-0.123721439708447,-0.131592131750961,-0.127608670155514,-0.130645047563348,-0.144260118232396,-0.128645777537137,-0.146848840244806,-0.129145987991352,-0.140201000199601,-0.139847267984266,-0.127449386957533,-0.127622321961537,-0.131192633487607,-0.146718835501901,-0.13045980781899,-0.124215310955233,-0.137922811733852,-0.154164620412701,-0.18649388433442,-0.185523757573431,-0.159496124343804,-0.169425429081706,-0.167871082974163,-0.145013898222135,-0.164440187256201,-0.164306941197442,-0.17746265376629,-0.15543894070457,-0.185681488772726,-0.152711731809676,-0.168850259654161,-0.159332347102654,-0.181283061583449,-0.170872032435328,-0.181430100828749,-0.188552730842445,-0.174084537049645,-0.169243997489487,-0.169806976164718,-0.167487696329384,-0.161982696640959,-0.167176691012484,-0.173297150310915,-0.161388925772587,-0.160883418078646,-0.169373778404437,-0.17475179190168,-0.1687575495514,-0.177167899238824,-0.173510805187034,-0.170682514959995,-0.141497718269085,-0.163019753109462,-0.174657939364513,-0.179486796089077,-0.155095543645714,-0.192305667193249,-0.178069007531386,-0.165255512307485,-0.166404213295736,-0.176908431222678,-0.177943289658607,-0.166272412881015,-0.140751882573492,-0.155586060570203,-0.175241445619545,-0.175089399685033,-0.183093128491481,-0.170790389838821,-0.164679562660596,-0.161180219420257,-0.18462787890372,-0.145779153610946,-0.193000031538618,-0.199679167515175,-0.17959328886842,-0.175639422913727,-0.189351496442962,-0.184965109605166,-0.157162183561641,-0.172356161695452,-0.177230519433175,-0.160262204239635,-0.0648282883851651,-0.0672127219959665,-0.0878359660099551,-0.0615510245378141,-0.0607922083809607,-0.0699972336379647,-0.086123634027547,-0.0686292580645635,-0.0681061624306647,-0.0628039128755597,-0.0804216680040696,-0.0593774525913483,-0.0741458824119954,-0.0535689152304853,-0.0751333511425739,-0.0517783626763037,-0.0680807657938926,-0.056464143071204,-0.0595787563947797,-0.0824342655481813,-0.0712338262287437,-0.0468884568768912,-0.065041009352719,-0.0568282085910109,-0.058743736123429,-0.0755412046239142,-0.052082937248289,-0.0512089973784003,-0.0705068332115821,-0.0499156627323373,-0.0827997226980483,-0.0774652601956077,-0.067875579623309,-0.0682393022581124,-0.0904266987632444,-0.0526738909349396,-0.0946686080602984,-0.0726914149428544,-0.0650280386037865,-0.0559731116483551,-0.0709228603434778,-0.079879176459354,-0.0674104925145159,-0.0580731301438953,-0.048005323383452,-0.0578997391775544,-0.0670703750366698,-0.0607602040886655,-0.0636200551111864,-0.0636370928882856,-0.0646647016958571,-0.0721110154591082,-0.0099912898651116,-0.00806021472911023,-0.0228496165050466,-0.0283535409341511,-0.00916547647005332,-0.0125635359759695,-0.016381086667515,-0.00760859750013503,-0.000839065150719168,-0.0278350008334369,0.00209039482542473,-0.00720187621963668,0.00180390750139203,-0.0180766529491858,-0.00444500091279253,-0.0105081527688957,-0.0131920242846577,0.0125404536103916,-0.0152833663494694,-0.0211425251328916,-0.0232709283577461,-0.0394959374963093,-0.00810363416588652,0.002209276499048,-0.00231931563406596,-0.00770533916880199,0.00138625818671895,-0.00491675837165564,-0.0207480210091027,0.000529969961572082,-0.0169152764726977,0.000280819541950894,-0.000593029775897619,0.00228202804684628,0.00173064253263168,0.00172839799501581,-0.0173445376392507,-0.0155593508200199,-0.00872419324679069,-0.00738466208205043,0.00276834017324891,-0.0151684437548805,-0.00658414954026096,-0.00521742520918834,-0.0130360584532111,-0.00644541147100298,-0.0236104613482441,-0.0250230600238022,-0.0160963510301832,-0.00396493401004247,-0.0182014893539135,-0.0334362194614984,-0.0388405286059319,-0.0496100905408623,-0.0101035814340922,-0.0171456295097446,-0.0491900063822667,-0.0326046680520007,-0.0209611432925296,-0.049936096428677,-0.0263320294076989,-0.0440661743376771,-0.0388831939215639,-0.0238719245537624,-0.0226517717908019,-0.0419815602377568,-0.0249233943840195,-0.0440611729120323,-0.0287476017872327,-0.0347010235391352,-0.0309406980189024,-0.0273142324297628,-0.0392291833121837,-0.0176972567006052,-0.0349287648423722,-0.0277478262675571,-0.0300702394978254,-0.0590985415215266,-0.0521815191102676,-0.0169638994991893,-0.024595048580136,-0.0323680098404807,-0.0138859488298678,-0.0331583308424317,-0.0271100055831317,-0.0385156376290404,-0.0419475351212251,-0.0363612034001041,-0.024035630958855,-0.041188908850587,-0.0227172229451906,-0.00499468402933658,-0.0334098280459465,-0.046840636262092,-0.0330814850984984],1,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.4863651670283,51.4740290413145,51.5228264596313,51.4767996435054,51.5082655508304],[-0.134709116630256,-0.171007974399254,-0.0667301748879254,-0.0115177254192531,-0.0326127622742206],{"iconUrl":{"data":"http://simpleicon.com/wp-content/uploads/cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAABAElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZOjNnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIzAXsTALGT7m3PwAAAABJRU5ErkJggg==",[[51.55,-0.199999999999988],[51.45,5.10633119642717e-19]],0.2,null,null,null]},{"method":"addCircles","args":[[51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55],[-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0],250,null,null,{"interactive":true,"className":"","stroke":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,true,true,true,true,false,false,false,false,false,false,true,true,true,true,true,false,false,false,false,false,false,true,true,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,true,false,false,false,false,true,false,false,false,false,false,true,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,true,true,true,true,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"color":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"weight":0.5,"opacity":1,"fill":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"fillColor":["#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3"],"fillOpacity":0.9},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[51.55,-0.199999999999988],[51.45,5.10633119642717e-19]],0.8,null,null,null]},{"method":"addRectangles","args":[51.45,-0.2,51.55,0,null,null,{"interactive":true,"className":"","stroke":true,"color":"#333333","weight":2,"opacity":0.5,"fill":false,"fillColor":"#333333","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[51.45,51.55],"lng":[-0.2,0.0125404536103916]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="other-parameter-estimation" class="section level3">
<h3 class="hasAnchor">
<a href="#other-parameter-estimation" class="anchor"></a>Other Parameter Estimation</h3>
<p>We can also plot the posterior 95% credible intervals of each sigma. The <code>"single"</code> model will produce intervals for each source, this requires updating (TODO).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_sigma.html">plot_sigma</a></span>(p, <span class="dt">K =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_segment).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Similarly the same can be done for the expected population size.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_expected_popsize.html">plot_expected_popsize</a></span>(p, <span class="dt">K =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>With <code><a href="../reference/plot_structure.html">plot_structure()</a></code> we are able to visualise the model’s allocation of positive sentinel sites to sources. Each vertical bar represents a sentinel site that captured at least one individual. The proportion of each colour on that bar translates to the probability that sentinel site is associated with a specific source.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_structure.html">plot_structure</a></span>(p, <span class="dt">divide_ind_on =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>When <code>K = 1</code> the allocation is trivial, there is only a single source for our observations to be allocated to. Shift to <code>K = 2</code> and we see a clear XX-XX split between sources. The case of <code>K = 3</code> is curious. We know for sure that there are two true sources, but the model is displaying its attempt to fit three by splitting a source in two. Let’s take a look at how this compares to the true allocation from the simulated data (NOTE: colour mismatches may have occurred).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mysim<span class="op">$</span>record<span class="op">$</span>true_qmatrix)</code></pre></div>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>It is also possible to map these structural plots using the <code><a href="../reference/overlay_piecharts.html">overlay_piecharts()</a></code> function. Pie charts ore overlain on the positive sentinel sites. The size of the chart represents the number of individuals caught at that location. The fill of the chart then represents the probability this site has been allocated to a particular source synonymously to the structural plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">piePlot &lt;-<span class="st"> </span><span class="kw"><a href="../reference/overlay_piecharts.html">overlay_piecharts</a></span>(plot2, <span class="dt">project =</span> p, <span class="dt">K =</span> <span class="dv">2</span>, <span class="dt">min_size =</span> <span class="dv">10</span>, <span class="dt">max_size =</span> <span class="dv">30</span>)
piePlot</code></pre></div>
<div id="htmlwidget-772069a48a20eba1a994" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-772069a48a20eba1a994">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[51.475657166802,51.4892860986829,51.4937626285096,51.4845292192994,51.5037521270628,51.490365482375,51.4885981229574,51.4752965668253,51.4968497761704,51.4885846085728,51.4829092888067,51.4753989319836,51.4837997796679,51.4837790643691,51.4847785928241,51.4915023477354,51.481952141315,51.4723672221794,51.4943230038678,51.49055505435,51.4764211549298,51.4885983632195,51.4810512675809,51.4972265377584,51.4863639399258,51.4834214126152,51.4829106290823,51.4898651015412,51.4743586808154,51.4804527514301,51.4745142580426,51.4886401926805,51.4973918429952,51.4906410068206,51.5006744335485,51.4780329616524,51.484308814675,51.4909495712091,51.4967664568914,51.4806177279458,51.4894367990236,51.4759308231483,51.4674028850344,51.4826817628227,51.4818976175328,51.4761590127167,51.4758541309937,51.479603508158,51.4811353621695,51.4784746852942,51.4842436165095,51.4800217692882,51.4947956707369,51.4833778137656,51.4905274782399,51.474826018534,51.4867039718684,51.4879755420929,51.4725044468583,51.4744758827984,51.4722832762244,51.4649352509064,51.4767406515633,51.4678995085162,51.4711821966162,51.4765751588726,51.4776979464238,51.4743906969705,51.461312231407,51.4701605850129,51.4810458661548,51.4747303370311,51.4615296707829,51.477386311345,51.4738276271271,51.4639723445902,51.4757367770707,51.4723520746418,51.4732454731219,51.4884715009048,51.4708348632106,51.4743477882691,51.4755110511587,51.4719786170362,51.4818075374067,51.482271468115,51.4771704246745,51.4846824193269,51.4799311090883,51.4623412765551,51.4610265650533,51.4699234210303,51.4659527428508,51.4698357293795,51.476700915634,51.4693350664428,51.4751777882317,51.4756962634335,51.4735928607585,51.4595511400851,51.4847391306883,51.4698561532253,51.4801834885476,51.4751511962195,51.4784849526841,51.4725163200986,51.4683097256827,51.468329377184,51.4823202774471,51.4695067862449,51.4929285583074,51.4755933615385,51.4688889282806,51.4755229479843,51.4771414244885,51.4724171077431,51.4713248970644,51.4686645484489,51.4690948202617,51.4880482472405,51.5165750765041,51.5148081486299,51.5174664311855,51.5190031966473,51.5296104180216,51.5187201757112,51.5260163605119,51.5231067783161,51.5200527020693,51.5233346626486,51.5341858151374,51.5234129367447,51.5271651366006,51.5092445843132,51.5147025764166,51.5324658949106,51.5175550074735,51.5186879556723,51.5171607754361,51.521249917387,51.5151110388685,51.5140457247054,51.5305942588121,51.5291207720972,51.5281138594208,51.5265380685631,51.5186652352359,51.5299532686092,51.5162984069185,51.5239859688854,51.5196086417543,51.5158393764126,51.5107691291579,51.5305296939084,51.5059734768603,51.5137914353371,51.5222800368415,51.5253567953018,51.5131114159316,51.5177057022503,51.5242264909429,51.5310516418315,51.5259922530899,51.5223021109729,51.5229936314898,51.5336920693812,51.5296239753785,51.5354066513192,51.524892430577,51.5015845059076,51.5163618771454,51.511621285116,51.4805988731535,51.4683510898335,51.489685488169,51.4882651586374,51.4757624131876,51.4694541276048,51.4754547814126,51.4861335070741,51.4800055159741,51.4761771095186,51.4819624618259,51.4669384047324,51.4757821567315,51.4614949164104,51.4822387313762,51.476937782379,51.4849040186214,51.47450578067,51.4733452511012,51.4626428879762,51.4745245799957,51.47853928891,51.4875620752243,51.4704335697153,51.48343786523,51.4880580966261,51.4850071624798,51.4805804459676,51.4785670130878,51.4850352083503,51.4772123081493,51.4721176831124,51.4783764479252,51.4717516208311,51.489008880932,51.4681575550478,51.487472206758,51.4971965767801,51.4832341131019,51.4715232750545,51.476870846487,51.4708707724837,51.4827764578925,51.478218423171,51.475134478375,51.4785249724279,51.4700329820592,51.4817525484946,51.479088184847,51.4826969971113,51.4779670451501,51.4799603887521,51.5095061236054,51.519864904916,51.5144915692594,51.5260009408898,51.4960984336111,51.5027612400444,51.5025344046168,51.5125203605238,51.5012075073764,51.5155761632272,51.51062764152,51.4891411574137,51.5076825793514,51.50400887716,51.5076310047785,51.509197982426,51.5063131898557,51.5122580755953,51.50725544694,51.5067741532725,51.5146055489676,51.5118470815445,51.4997647992186,51.5264817084668,51.4929077866652,51.5075106437209,51.5065406766492,51.5122940170452,51.5133748966345,51.5059670734996,51.497163396063,51.5089683537508,51.5084929953052,51.5016786273944,51.5002109397002,51.4964670637369,51.501414590875,51.5065513889811,51.505006379207,51.5215431848239,51.5143129659364,51.4981278939154,51.5127175003045],[-0.117367493563965,-0.123738731492183,-0.114068955138457,-0.137829709382589,-0.143279501738717,-0.133392031446455,-0.130090339562636,-0.139760832788702,-0.136908215332321,-0.107041963266337,-0.136616187439761,-0.124856650061291,-0.138371267517126,-0.147306463386693,-0.125433843223903,-0.133238564815395,-0.145023526568833,-0.142334118185371,-0.127192864928465,-0.122196071609076,-0.130727446722967,-0.145696498485726,-0.122689060548269,-0.137441999797041,-0.126487173902948,-0.118762612885876,-0.137154864075206,-0.13841813497333,-0.121120872189079,-0.121391122466853,-0.112707875719019,-0.125570231197494,-0.140205549333489,-0.1265667421457,-0.123197819938151,-0.13392308942122,-0.124657034840786,-0.123721439708447,-0.131592131750961,-0.127608670155514,-0.130645047563348,-0.144260118232396,-0.128645777537137,-0.146848840244806,-0.129145987991352,-0.140201000199601,-0.139847267984266,-0.127449386957533,-0.127622321961537,-0.131192633487607,-0.146718835501901,-0.13045980781899,-0.124215310955233,-0.137922811733852,-0.154164620412701,-0.18649388433442,-0.185523757573431,-0.159496124343804,-0.169425429081706,-0.167871082974163,-0.145013898222135,-0.164440187256201,-0.164306941197442,-0.17746265376629,-0.15543894070457,-0.185681488772726,-0.152711731809676,-0.168850259654161,-0.159332347102654,-0.181283061583449,-0.170872032435328,-0.181430100828749,-0.188552730842445,-0.174084537049645,-0.169243997489487,-0.169806976164718,-0.167487696329384,-0.161982696640959,-0.167176691012484,-0.173297150310915,-0.161388925772587,-0.160883418078646,-0.169373778404437,-0.17475179190168,-0.1687575495514,-0.177167899238824,-0.173510805187034,-0.170682514959995,-0.141497718269085,-0.163019753109462,-0.174657939364513,-0.179486796089077,-0.155095543645714,-0.192305667193249,-0.178069007531386,-0.165255512307485,-0.166404213295736,-0.176908431222678,-0.177943289658607,-0.166272412881015,-0.140751882573492,-0.155586060570203,-0.175241445619545,-0.175089399685033,-0.183093128491481,-0.170790389838821,-0.164679562660596,-0.161180219420257,-0.18462787890372,-0.145779153610946,-0.193000031538618,-0.199679167515175,-0.17959328886842,-0.175639422913727,-0.189351496442962,-0.184965109605166,-0.157162183561641,-0.172356161695452,-0.177230519433175,-0.160262204239635,-0.0648282883851651,-0.0672127219959665,-0.0878359660099551,-0.0615510245378141,-0.0607922083809607,-0.0699972336379647,-0.086123634027547,-0.0686292580645635,-0.0681061624306647,-0.0628039128755597,-0.0804216680040696,-0.0593774525913483,-0.0741458824119954,-0.0535689152304853,-0.0751333511425739,-0.0517783626763037,-0.0680807657938926,-0.056464143071204,-0.0595787563947797,-0.0824342655481813,-0.0712338262287437,-0.0468884568768912,-0.065041009352719,-0.0568282085910109,-0.058743736123429,-0.0755412046239142,-0.052082937248289,-0.0512089973784003,-0.0705068332115821,-0.0499156627323373,-0.0827997226980483,-0.0774652601956077,-0.067875579623309,-0.0682393022581124,-0.0904266987632444,-0.0526738909349396,-0.0946686080602984,-0.0726914149428544,-0.0650280386037865,-0.0559731116483551,-0.0709228603434778,-0.079879176459354,-0.0674104925145159,-0.0580731301438953,-0.048005323383452,-0.0578997391775544,-0.0670703750366698,-0.0607602040886655,-0.0636200551111864,-0.0636370928882856,-0.0646647016958571,-0.0721110154591082,-0.0099912898651116,-0.00806021472911023,-0.0228496165050466,-0.0283535409341511,-0.00916547647005332,-0.0125635359759695,-0.016381086667515,-0.00760859750013503,-0.000839065150719168,-0.0278350008334369,0.00209039482542473,-0.00720187621963668,0.00180390750139203,-0.0180766529491858,-0.00444500091279253,-0.0105081527688957,-0.0131920242846577,0.0125404536103916,-0.0152833663494694,-0.0211425251328916,-0.0232709283577461,-0.0394959374963093,-0.00810363416588652,0.002209276499048,-0.00231931563406596,-0.00770533916880199,0.00138625818671895,-0.00491675837165564,-0.0207480210091027,0.000529969961572082,-0.0169152764726977,0.000280819541950894,-0.000593029775897619,0.00228202804684628,0.00173064253263168,0.00172839799501581,-0.0173445376392507,-0.0155593508200199,-0.00872419324679069,-0.00738466208205043,0.00276834017324891,-0.0151684437548805,-0.00658414954026096,-0.00521742520918834,-0.0130360584532111,-0.00644541147100298,-0.0236104613482441,-0.0250230600238022,-0.0160963510301832,-0.00396493401004247,-0.0182014893539135,-0.0334362194614984,-0.0388405286059319,-0.0496100905408623,-0.0101035814340922,-0.0171456295097446,-0.0491900063822667,-0.0326046680520007,-0.0209611432925296,-0.049936096428677,-0.0263320294076989,-0.0440661743376771,-0.0388831939215639,-0.0238719245537624,-0.0226517717908019,-0.0419815602377568,-0.0249233943840195,-0.0440611729120323,-0.0287476017872327,-0.0347010235391352,-0.0309406980189024,-0.0273142324297628,-0.0392291833121837,-0.0176972567006052,-0.0349287648423722,-0.0277478262675571,-0.0300702394978254,-0.0590985415215266,-0.0521815191102676,-0.0169638994991893,-0.024595048580136,-0.0323680098404807,-0.0138859488298678,-0.0331583308424317,-0.0271100055831317,-0.0385156376290404,-0.0419475351212251,-0.0363612034001041,-0.024035630958855,-0.041188908850587,-0.0227172229451906,-0.00499468402933658,-0.0334098280459465,-0.046840636262092,-0.0330814850984984],1,null,null,{"interactive":true,"className":"","stroke":false,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[51.4863651670283,51.4740290413145,51.5228264596313,51.4767996435054,51.5082655508304],[-0.134709116630256,-0.171007974399254,-0.0667301748879254,-0.0115177254192531,-0.0326127622742206],{"iconUrl":{"data":"http://simpleicon.com/wp-content/uploads/cross.png","index":0},"iconWidth":20,"iconHeight":20,"iconAnchorX":10,"iconAnchorY":10},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAABAElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZOjNnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIzAXsTALGT7m3PwAAAABJRU5ErkJggg==",[[51.55,-0.199999999999988],[51.45,5.10633119642717e-19]],0.2,null,null,null]},{"method":"addCircles","args":[[51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.45,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4590909090909,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4681818181818,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4772727272727,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4863636363636,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.4954545454545,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5045454545455,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5136363636364,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5227272727273,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5318181818182,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.5409090909091,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55,51.55],[-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0,-0.2,-0.181818181818182,-0.163636363636364,-0.145454545454545,-0.127272727272727,-0.109090909090909,-0.0909090909090909,-0.0727272727272727,-0.0545454545454545,-0.0363636363636363,-0.0181818181818182,0],250,null,null,{"interactive":true,"className":"","stroke":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,true,true,true,true,false,false,false,false,false,false,true,true,true,true,true,false,false,false,false,false,false,true,true,false,false,false,true,true,false,false,false,false,false,true,true,false,false,false,false,true,false,false,false,false,true,false,false,false,false,false,true,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,true,true,true,true,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"color":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"weight":0.5,"opacity":1,"fill":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"fillColor":["#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","red","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3","#B3B3B3"],"fillOpacity":0.9},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addRasterImage","args":["data:image/png;base64,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",[[51.55,-0.199999999999988],[51.45,5.10633119642717e-19]],0.8,null,null,null]},{"method":"addRectangles","args":[51.45,-0.2,51.55,0,null,null,{"interactive":true,"className":"","stroke":true,"color":"#333333","weight":2,"opacity":0.5,"fill":false,"fillColor":"#333333","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMinicharts","args":[[{"dyn":{"width":[30]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0181818181818182,51.4772727272727)","lat":51.4772727272727,"lng":-0.0181818181818182},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0181818181818182,51.4863636363636)","lat":51.4863636363636,"lng":-0.0181818181818182},"timeSteps":1},{"dyn":{"width":[18]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0181818181818182,51.5136363636364)","lat":51.5136363636364,"lng":-0.0181818181818182},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0363636363636363,51.4954545454545)","lat":51.4954545454545,"lng":-0.0363636363636363},"timeSteps":1},{"dyn":{"width":[26]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0363636363636363,51.5136363636364)","lat":51.5136363636364,"lng":-0.0363636363636363},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0545454545454545,51.5136363636364)","lat":51.5136363636364,"lng":-0.0545454545454545},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0545454545454545,51.5227272727273)","lat":51.5227272727273,"lng":-0.0545454545454545},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0545454545454545,51.5318181818182)","lat":51.5318181818182,"lng":-0.0545454545454545},"timeSteps":1},{"dyn":{"width":[22]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0727272727272727,51.5136363636364)","lat":51.5136363636364,"lng":-0.0727272727272727},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0727272727272727,51.5227272727273)","lat":51.5227272727273,"lng":-0.0727272727272727},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.0909090909090909,51.5045454545455)","lat":51.5045454545455,"lng":-0.0909090909090909},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.127272727272727,51.4681818181818)","lat":51.4681818181818,"lng":-0.127272727272727},"timeSteps":1},{"dyn":{"width":[18]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.127272727272727,51.4863636363636)","lat":51.4863636363636,"lng":-0.127272727272727},"timeSteps":1},{"dyn":{"width":[18]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.127272727272727,51.4954545454545)","lat":51.4954545454545,"lng":-0.127272727272727},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.145454545454545,51.4681818181818)","lat":51.4681818181818,"lng":-0.145454545454545},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.145454545454545,51.4772727272727)","lat":51.4772727272727,"lng":-0.145454545454545},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.145454545454545,51.4863636363636)","lat":51.4863636363636,"lng":-0.145454545454545},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.145454545454545,51.5045454545455)","lat":51.5045454545455,"lng":-0.145454545454545},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.163636363636364,51.4590909090909)","lat":51.4590909090909,"lng":-0.163636363636364},"timeSteps":1},{"dyn":{"width":[22]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.163636363636364,51.4681818181818)","lat":51.4681818181818,"lng":-0.163636363636364},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.163636363636364,51.4772727272727)","lat":51.4772727272727,"lng":-0.163636363636364},"timeSteps":1},{"dyn":{"width":[18]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.181818181818182,51.4681818181818)","lat":51.4681818181818,"lng":-0.181818181818182},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.181818181818182,51.4772727272727)","lat":51.4772727272727,"lng":-0.181818181818182},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (-0.2,51.4772727272727)","lat":51.4772727272727,"lng":-0.2},"timeSteps":1},{"dyn":{"width":[14]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (0,51.4681818181818)","lat":51.4681818181818,"lng":0},"timeSteps":1},{"dyn":{"width":[22]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (0,51.4772727272727)","lat":51.4772727272727,"lng":0},"timeSteps":1},{"dyn":{"width":[18]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":20,"fillColor":"#1f77b4","layerId":"_minichart (0,51.4863636363636)","lat":51.4863636363636,"lng":0},"timeSteps":1}],[[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[1,0]],[[0.999,0.001]],[[0.999,0.001]],[[1,0]],[[0.99,0.01]],[[0.994,0.006]],[[0.79,0.21]],[[0.002,0.998]],[[0.005,0.995]],[[0.009,0.991]],[[0,1]],[[0,1]],[[0,1]],[[0.001,0.999]],[[0,1]],[[0,1]],[[0,1]],[[0,1]],[[0,1]],[[0,1]],[[1,0]],[[1,0]],[[1,0]]],1,["#A6CEE3","#1F78B4"],["1"],null,{"showTitle":true,"showValues":true,"labels":["group1","group2"],"supValues":null,"supLabels":[],"html":null,"noPopup":false,"digits":null},null]},{"method":"addLegend","args":[{"colors":["#A6CEE3","#1F78B4"],"labels":["group1","group2"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":null,"extra":null,"layerId":"minichartsLegend","className":"info legend","group":null}]}],"limits":{"lat":[51.45,51.55],"lng":[-0.2,0.0125404536103916]}},"evals":[],"jsHooks":[]}</script><p>The model-testing metric used consistently through the geographic profiling literature is the hitscore. This is calculated by computing the area searched before finding a source divided by the total search area (where a search is defined by starting at the top of the geoprofile and working your way down). Hence a lower hitscore indicates a better performing model. We use <code>get_hitscores</code> to produce these.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_hitscores.html">get_hitscores</a></span>(p, true_source<span class="op">$</span>longitude, true_source<span class="op">$</span>latitude)
hs</code></pre></div>
<pre><code>##     longitude latitude hs_ringsearch hs_geoprofile_K1 hs_geoprofile_K2
## 1 -0.13470912 51.48637         14.60            29.76             9.64
## 2 -0.17100797 51.47403         17.58            73.99             5.02
## 3 -0.06673017 51.52283          8.14            29.52            52.48
## 4 -0.01151773 51.47680         12.98            49.36            33.27
## 5 -0.03261276 51.50827         18.67            31.24             6.36
##   hs_geoprofile_K3 hs_geoprofile_K4 hs_geoprofile_K5 hs_geoprofile_K6
## 1            16.91             1.20             0.45             2.04
## 2             9.21             2.14             2.49             3.36
## 3             9.96            19.02             5.00             5.45
## 4             1.13             0.59             0.34             0.17
## 5            11.75            19.14             1.73             1.63
##   hs_geoprofile_K7 hs_geoprofile_K8 hs_geoprofile_K9 hs_geoprofile_K10
## 1             3.89             4.39             5.50              6.21
## 2             3.99             4.81             5.33              5.95
## 3             6.96             6.17             6.53              6.45
## 4             0.19             0.19             0.18              0.21
## 5             2.27             1.57             2.32              1.78</code></pre>
<p>Another common metric to use for this analysis is a gini coefficent from a Lorenz plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_lorenz.html">plot_lorenz</a></span>(hs)
plot3</code></pre></div>
<p><img src="basic-implementation_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>This <code><a href="../reference/plot_lorenz.html">plot_lorenz()</a></code> function returns a graph that describes the number of sources found as a function of area searched. The Gini co-efficent is then calculated as the area under these piecewise curves.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/gini.html">gini</a></span>(hs)</code></pre></div>
<pre><code>##     hs_ringsearch  hs_geoprofile_K1  hs_geoprofile_K2  hs_geoprofile_K3 
##           0.74946           0.29250           0.67788           0.83798 
##  hs_geoprofile_K4  hs_geoprofile_K5  hs_geoprofile_K6  hs_geoprofile_K7 
##           0.86992           0.96996           0.96030           0.94472 
##  hs_geoprofile_K8  hs_geoprofile_K9 hs_geoprofile_K10 
##           0.94382           0.93362           0.93050</code></pre>
<p>Both the <code><a href="../reference/gini.html">gini()</a></code> and <code><a href="../reference/get_hitscores.html">get_hitscores()</a></code> functions refer to a “ringsearch” strategy. This is used to compare the model to a naive search strategy that requires you to search radially outwards from each positive sentinel site until sources are found. This gives us a bottom line non-trivial search strategy to compare hitscores to.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#simulating-data">Simulating data</a></li>
      <li><a href="#creating-a-project">Creating a project</a></li>
      <li><a href="#simple-spatial-priors">Simple spatial priors</a></li>
      <li><a href="#parameter-sets">Parameter sets</a></li>
      <li><a href="#running-the-model">Running the model</a></li>
      <li><a href="#diagnosing-the-model">Diagnosing the Model</a></li>
      <li><a href="#results">Results</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Robert Verity.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
